# æ¨¡çµ„ 11ï¼šGDB é™¤éŒ¯å™¨

> ä½¿ç”¨ GDB é€²è¡Œé ç«¯ ARM ç¨‹å¼é™¤éŒ¯ï¼Œå¿«é€Ÿæ‰¾å‡ºä¸¦ä¿®å¾©ç¨‹å¼éŒ¯èª¤

**å°æ‡‰å°ˆæ¡ˆæª”æ¡ˆ**:
- [`test_gdb.gdb`](/home/sbplab/jiawei/qemu/CMSIS_LM3S/test_gdb.gdb) - åŸºæœ¬æ¸¬è©¦è…³æœ¬
- [`test_detailed_gdb.gdb`](/home/sbplab/jiawei/qemu/CMSIS_LM3S/test_detailed_gdb.gdb) - è©³ç´°æ¸¬è©¦è…³æœ¬

**é–±è®€æ™‚é–“**: ç´„ 50 åˆ†é˜
**é›£åº¦**: â­â­â­â˜†â˜† (ä¸­é«˜é›£åº¦)

---

## ğŸ“Œ å­¸ç¿’ç›®æ¨™

å®Œæˆæœ¬æ¨¡çµ„å¾Œï¼Œä½ å°‡èƒ½å¤ ï¼š
- âœ… ç†è§£ GDB é ç«¯é™¤éŒ¯çš„åŸç†èˆ‡æ¶æ§‹
- âœ… è¨­å®šå„ç¨®é¡å‹çš„ä¸­æ–·é» (breakpoint, watchpoint, catchpoint)
- âœ… ä½¿ç”¨ GDB å–®æ­¥åŸ·è¡Œèˆ‡è¿½è¹¤ç¨‹å¼æµç¨‹
- âœ… æª¢è¦–èˆ‡ä¿®æ”¹æš«å­˜å™¨ã€è¨˜æ†¶é«”å…§å®¹
- âœ… åˆ†æå‘¼å«å †ç–Š (call stack) èˆ‡å‡½å¼åƒæ•¸
- âœ… æ’°å¯« GDB è‡ªå‹•åŒ–è…³æœ¬
- âœ… è¨ºæ–·å¸¸è¦‹çš„åµŒå…¥å¼ç³»çµ± Bug
- âœ… ä½¿ç”¨ GDB é€²è¡Œæ•ˆèƒ½åˆ†æ

---

## é–‹å§‹ä¹‹å‰ï¼šç‚ºä»€éº¼éœ€è¦ GDBï¼Ÿ

æƒ³åƒä½ æ­£åœ¨é–‹ç™¼ä¸€å€‹**è¡€æ°§ç›£æ¸¬æ‰‹ç’°çš„éŸŒé«”**ï¼š

### æ²’æœ‰ GDB çš„ç—›è‹¦é™¤éŒ¯éç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å‚³çµ±é™¤éŒ¯æ–¹å¼ï¼šprintf å¤§æ³•ï¼ˆLED é–ƒçˆå¤§æ³•ï¼‰          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                      â”‚
â”‚ Bug: è¡€æ°§æ•¸å€¼æœ‰æ™‚æœƒçªç„¶è®Šæˆ 0                       â”‚
â”‚                                                      â”‚
â”‚ Day 1:                                               â”‚
â”‚   ä½ : åœ¨ 10 å€‹åœ°æ–¹æ’å…¥ printf("Debug 1")            â”‚
â”‚   ç·¨è­¯ â†’ ç‡’éŒ„ â†’ åŸ·è¡Œ â†’ è§€å¯Ÿ                         â”‚
â”‚   çµæœ: åœ¨ç¬¬ 5 å€‹ printf ä¹‹å¾Œå°±æ²’è¼¸å‡ºäº†...          â”‚
â”‚                                                      â”‚
â”‚ Day 2:                                               â”‚
â”‚   ä½ : åœ¨ç¬¬ 5 å€‹ printf å‰å¾Œå†æ’å…¥ 10 å€‹ printf      â”‚
â”‚   ç·¨è­¯ â†’ ç‡’éŒ„ â†’ åŸ·è¡Œ â†’ è§€å¯Ÿ                         â”‚
â”‚   çµæœ: ç¨‹å¼è¡Œç‚ºæ”¹è®Šäº†ï¼Bug æ¶ˆå¤±äº†ï¼Ÿ(Heisenbug!)   â”‚
â”‚         (æ’å…¥ printf æ”¹è®Šäº†æ™‚åºï¼ŒBug ä¸å†å‡ºç¾)     â”‚
â”‚                                                      â”‚
â”‚ Day 3:                                               â”‚
â”‚   ä½ : æ”¹ç”¨ LED é–ƒçˆï¼ˆGPIO toggleï¼‰é™¤éŒ¯              â”‚
â”‚   å•é¡Œ: LED é–ƒå¤ªå¿«çœ‹ä¸æ¸…ï¼Œåªå¥½æ’å…¥ delay            â”‚
â”‚   çµæœ: åˆæ”¹è®Šäº†ç¨‹å¼æ™‚åº... Bug è¡Œç‚ºåˆä¸åŒäº†ï¼     â”‚
â”‚                                                      â”‚
â”‚ Day 7:                                               â”‚
â”‚   ä½ : å·²ç¶“æ’å…¥ 100 å€‹ printfï¼Œç¨‹å¼ç¢¼äº‚æˆä¸€åœ˜        â”‚
â”‚   Bug é‚„æ˜¯æ²’æ‰¾åˆ°ï¼Œæº–å‚™æ”¾æ£„...                       â”‚
â”‚                                                      â”‚
â”‚ æ™‚é–“æµªè²»: 7 å¤© (168 å°æ™‚)                           â”‚
â”‚ å£“åŠ›ç­‰ç´š: â˜…â˜…â˜…â˜…â˜… çˆ†è¡¨ï¼                            â”‚
â”‚ æˆåŠŸç‡: 20% (é‹æ°£å¥½æ‰æ‰¾åˆ°)                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ä½¿ç”¨ GDB çš„é«˜æ•ˆé™¤éŒ¯æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ä½¿ç”¨ GDB çš„é™¤éŒ¯æµç¨‹                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                      â”‚
â”‚ Bug: è¡€æ°§æ•¸å€¼æœ‰æ™‚æœƒçªç„¶è®Šæˆ 0                       â”‚
â”‚                                                      â”‚
â”‚ Day 1 ä¸Šåˆ:                                          â”‚
â”‚   ä½ : å•Ÿå‹• GDB é€£æ¥åˆ° QEMU/å¯¦é«”æ¿                   â”‚
â”‚   (gdb) break read_blood_oxygen   â† è¨­ä¸­æ–·é»        â”‚
â”‚   (gdb) continue                   â† åŸ·è¡Œåˆ°ä¸­æ–·é»   â”‚
â”‚                                                      â”‚
â”‚   Breakpoint hit!                                    â”‚
â”‚   (gdb) print sensor_value         â† æŸ¥çœ‹è®Šæ•¸       â”‚
â”‚   $1 = 0       â† å•Šå“ˆï¼å•é¡Œåœ¨é€™è£¡ï¼                 â”‚
â”‚                                                      â”‚
â”‚   (gdb) backtrace                  â† æŸ¥çœ‹å‘¼å«å †ç–Š   â”‚
â”‚   #0 read_blood_oxygen()                            â”‚
â”‚   #1 process_adc_data()            â† å¾é€™è£¡å‘¼å«çš„   â”‚
â”‚   #2 main_loop()                                    â”‚
â”‚                                                      â”‚
â”‚   (gdb) frame 1                    â† åˆ‡åˆ°ä¸Šå±¤å‡½å¼   â”‚
â”‚   (gdb) print adc_buffer           â† æŸ¥çœ‹ ADC ç·©è¡  â”‚
â”‚   $2 = {0, 0, 0, ...}              â† å…¨æ˜¯ 0ï¼       â”‚
â”‚                                                      â”‚
â”‚ Day 1 ä¸‹åˆ:                                          â”‚
â”‚   ä½ : åœ¨ ADC åˆå§‹åŒ–å‡½å¼è¨­ä¸­æ–·é»                      â”‚
â”‚   (gdb) break init_adc                              â”‚
â”‚   ç™¼ç¾: ADC æ™‚è„ˆæ²’æœ‰å•Ÿç”¨ï¼                           â”‚
â”‚   ä¿®å¾©: åŠ ä¸Š RCC->APB2ENR |= RCC_APB2ENR_ADC1EN;    â”‚
â”‚                                                      â”‚
â”‚   é‡æ–°ç·¨è­¯ â†’ æ¸¬è©¦ â†’ Bug ä¿®å¾©ï¼âœ“                     â”‚
â”‚                                                      â”‚
â”‚ æ™‚é–“èŠ±è²»: 4 å°æ™‚ (åŠå¤©)                              â”‚
â”‚ å£“åŠ›ç­‰ç´š: â˜…â˜…â˜†â˜†â˜† ä½ï¼æœ‰å·¥å…·å°±æ˜¯çˆ½ï¼                â”‚
â”‚ æˆåŠŸç‡: 95% (å¹¾ä¹ä¸€å®šæ‰¾å¾—åˆ°)                        â”‚
â”‚                                                      â”‚
â”‚ çœä¸‹: 6.5 å¤©ï¼å¯ä»¥æ—©é»ä¸‹ç­å›å®¶äº†ï¼                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### çœŸå¯¦æ¡ˆä¾‹ï¼šç«æ˜Ÿæ¢æ¸¬è»Šçš„é ç«¯é™¤éŒ¯

> **NASA çš„çœŸå¯¦æ•…äº‹**: 2004 å¹´ç«æ˜Ÿæ¢æ¸¬è»Š Spirit é™è½å¾Œçªç„¶åœæ­¢é€šè¨Š
>
> **å•é¡Œ**: æ¢æ¸¬è»Šé‡è¤‡é‡æ–°é–‹æ©Ÿï¼Œç„¡æ³•åŸ·è¡Œä»»å‹™
>
> **é™¤éŒ¯æ–¹å¼**:
> - NASA å·¥ç¨‹å¸«åœ¨åœ°çƒä¸Šçš„å¯¦é©—å®¤é‡ç¾å•é¡Œ
> - ä½¿ç”¨ GDB é ç«¯é™¤éŒ¯æ¨¡æ“¬å™¨
> - ç™¼ç¾: Flash è¨˜æ†¶é«”æ»¿äº†ï¼Œæª”æ¡ˆç³»çµ±å´©æ½°
> - è§£æ±º: å‚³é€æŒ‡ä»¤åˆªé™¤ä¸å¿…è¦çš„æª”æ¡ˆ
>
> **çµæœ**: æˆåŠŸä¿®å¾©ï¼æ¢æ¸¬è»Šç¹¼çºŒé‹ä½œäº† 6 å¹´ï¼ˆåŸè¨ˆåŠƒåªæœ‰ 90 å¤©ï¼‰
>
> **å•Ÿç¤º**: é ç«¯é™¤éŒ¯èƒ½åŠ›å°æ–¼ç„¡æ³•ç‰©ç†æ¥è§¸çš„ç³»çµ±è‡³é—œé‡è¦ï¼

**é€™å°±æ˜¯ç‚ºä»€éº¼æˆ‘å€‘éœ€è¦ GDBï¼**

---

## 1. GDB æ˜¯ä»€éº¼ï¼Ÿ

### åç¨±ç”±ä¾†

**GDB** = **G**NU **D**e**B**ugger

> ç™¼éŸ³: "Gee-Dee-Bee"

### æ ¸å¿ƒæ¦‚å¿µ

GDB æ˜¯ä¸€å€‹**åŠŸèƒ½å¼·å¤§çš„åŸå§‹ç¢¼ç´šé™¤éŒ¯å™¨**ï¼Œå¯ä»¥ï¼š

1. **è¨­å®šä¸­æ–·é»** - åœ¨ç‰¹å®šç¨‹å¼ç¢¼è¡Œæš«åœåŸ·è¡Œ
2. **å–®æ­¥åŸ·è¡Œ** - é€è¡ŒåŸ·è¡Œç¨‹å¼ç¢¼
3. **æª¢æŸ¥è®Šæ•¸** - æŸ¥çœ‹è®Šæ•¸çš„å€¼
4. **ä¿®æ”¹è¨˜æ†¶é«”** - åœ¨åŸ·è¡Œæ™‚æ”¹è®Šè®Šæ•¸å€¼
5. **åˆ†æå‘¼å«å †ç–Š** - äº†è§£å‡½å¼å‘¼å«é—œä¿‚
6. **é ç«¯é™¤éŒ¯** - é™¤éŒ¯åœ¨å…¶ä»–è£ç½®ä¸ŠåŸ·è¡Œçš„ç¨‹å¼

### ç”Ÿæ´»é¡æ¯”ï¼šXå…‰æ©Ÿ + æ™‚å…‰æ©Ÿ

æƒ³åƒç¨‹å¼åŸ·è¡Œå°±åƒ**äººé«”è¡€æ¶²å¾ªç’°**ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ²’æœ‰ GDB (åªèƒ½çŒœæ¸¬)                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ é†«ç”Ÿ: ä½ å“ªè£¡ä¸èˆ’æœï¼Ÿ                      â”‚
â”‚ ç—…äºº: è‚šå­ç—›...                          â”‚
â”‚ é†«ç”Ÿ: (åªèƒ½é ç¶“é©—çŒœæ¸¬)                    â”‚
â”‚       å¯èƒ½æ˜¯ç›²è…¸ç‚ï¼Ÿé‚„æ˜¯èƒƒæ½°ç˜ï¼Ÿ          â”‚
â”‚       åƒé€™å€‹è—¥è©¦è©¦çœ‹...                   â”‚
â”‚                                          â”‚
â”‚ è¨ºæ–·æº–ç¢ºç‡: 30%                          â”‚
â”‚ æ²»ç™‚æ™‚é–“: 2 é€±                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ä½¿ç”¨ GDB (ç²¾ç¢ºè¨ºæ–·)                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ é†«ç”Ÿ: ç”¨ X å…‰/è¶…éŸ³æ³¢æª¢æŸ¥                 â”‚
â”‚       â†’ çœ‹åˆ°ç›²è…¸ç™¼ç‚ âœ“                   â”‚
â”‚                                          â”‚
â”‚ é†«ç”Ÿ: ç”¨å…§è¦–é¡è§€å¯Ÿ                        â”‚
â”‚       â†’ çœ‹åˆ°æ½°ç˜ä½ç½® âœ“                   â”‚
â”‚                                          â”‚
â”‚ é†«ç”Ÿ: æŠ½è¡€æª¢æŸ¥                            â”‚
â”‚       â†’ ç™¼ç¾ç™½è¡€çƒéé«˜ âœ“                 â”‚
â”‚                                          â”‚
â”‚ è¨ºæ–·æº–ç¢ºç‡: 99%                          â”‚
â”‚ æ²»ç™‚æ™‚é–“: 3 å¤©                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**GDB å°±åƒã€Œç¨‹å¼çš„ X å…‰æ©Ÿã€**ï¼š
- âœ… çœ‹åˆ°ç¨‹å¼å…§éƒ¨çš„ç‹€æ…‹ï¼ˆè®Šæ•¸å€¼ï¼‰
- âœ… è¿½è¹¤ç¨‹å¼çš„åŸ·è¡Œæµç¨‹ï¼ˆå‘¼å«å †ç–Šï¼‰
- âœ… æš«åœæ™‚é–“è§€å¯Ÿï¼ˆä¸­æ–·é»ï¼‰
- âœ… æ™‚å…‰å€’æµé‡æ–°åŸ·è¡Œï¼ˆrestartï¼‰

### GDB çš„å·¥ä½œæ¨¡å¼

GDB æœ‰å…©ç¨®ä¸»è¦å·¥ä½œæ¨¡å¼ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. æœ¬åœ°é™¤éŒ¯ (Native Debugging)                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ç”¨é€”: é™¤éŒ¯åœ¨åŒä¸€å°é›»è…¦ä¸ŠåŸ·è¡Œçš„ç¨‹å¼                    â”‚
â”‚                                                       â”‚
â”‚ ç¯„ä¾‹: gdb ./my_program                               â”‚
â”‚                                                       â”‚
â”‚ é©åˆ: Linux/macOS æ‡‰ç”¨ç¨‹å¼é–‹ç™¼                       â”‚
â”‚                                                       â”‚
â”‚ é™åˆ¶: ç¨‹å¼å’Œ GDB å¿…é ˆåœ¨åŒä¸€å°é›»è…¦                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. é ç«¯é™¤éŒ¯ (Remote Debugging) â† æˆ‘å€‘ä½¿ç”¨é€™å€‹        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ç”¨é€”: é™¤éŒ¯åœ¨å…¶ä»–è£ç½®/æ¨¡æ“¬å™¨ä¸ŠåŸ·è¡Œçš„ç¨‹å¼              â”‚
â”‚                                                       â”‚
â”‚ ç¯„ä¾‹:                                                â”‚
â”‚   è£ç½®ç«¯: qemu-system-arm -s -S ...                 â”‚
â”‚   é™¤éŒ¯ç«¯: gdb-multiarch program.axf                  â”‚
â”‚            (gdb) target remote localhost:1234        â”‚
â”‚                                                       â”‚
â”‚ é©åˆ: åµŒå…¥å¼ç³»çµ±é–‹ç™¼ã€QEMU æ¨¡æ“¬å™¨é™¤éŒ¯                â”‚
â”‚                                                       â”‚
â”‚ å„ªé»:                                                â”‚
â”‚   â€¢ å¯é™¤éŒ¯ä¸åŒ CPU æ¶æ§‹ (ARM, RISC-V...)            â”‚
â”‚   â€¢ å¯é™¤éŒ¯é ç«¯å¯¦é«”ç¡¬é«”                               â”‚
â”‚   â€¢ QEMU æ¨¡æ“¬å™¨å…§å»º GDB server æ”¯æ´                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æˆ‘å€‘ä½¿ç”¨ GDB é ç«¯é™¤éŒ¯**ï¼Œå› ç‚ºæˆ‘å€‘è¦åœ¨ x86_64 é›»è…¦ä¸Šé™¤éŒ¯ ARM ç¨‹å¼ï¼

---

## 2. GDB é ç«¯é™¤éŒ¯æ¶æ§‹æ·±åº¦è§£æ

### æ•´é«”æ¶æ§‹åœ–

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ä½ çš„é›»è…¦ (Host Machine - Linux x86_64)                            â”‚
â”‚                                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ çµ‚ç«¯ 1: QEMU GDB Server (è¢«é™¤éŒ¯çš„ç¨‹å¼)                      â”‚ â”‚
â”‚  â”‚                                                              â”‚ â”‚
â”‚  â”‚  $ qemu-system-arm \                                        â”‚ â”‚
â”‚  â”‚      -M lm3s6965evb \                                       â”‚ â”‚
â”‚  â”‚      -kernel uart_hello_world.bin \                         â”‚ â”‚
â”‚  â”‚      -s \         â† å•Ÿå‹• GDB server (ç›£è½ TCP port 1234)   â”‚ â”‚
â”‚  â”‚      -S           â† å•Ÿå‹•æ™‚æš«åœï¼Œç­‰å¾… GDB é€£æ¥               â”‚ â”‚
â”‚  â”‚                                                              â”‚ â”‚
â”‚  â”‚  [ç¨‹å¼æš«åœåœ¨ç¬¬ä¸€æ¢æŒ‡ä»¤ï¼Œç­‰å¾…é™¤éŒ¯å™¨é€£æ¥...]                  â”‚ â”‚
â”‚  â”‚                                                              â”‚ â”‚
â”‚  â”‚  å…§éƒ¨é‹ä½œ:                                                   â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚  â”‚  â”‚ GDB Remote Serial Protocol (RSP) Server               â”‚ â”‚ â”‚
â”‚  â”‚  â”‚                                                        â”‚ â”‚ â”‚
â”‚  â”‚  â”‚ ç›£è½: TCP 127.0.0.1:1234                              â”‚ â”‚ â”‚
â”‚  â”‚  â”‚                                                        â”‚ â”‚ â”‚
â”‚  â”‚  â”‚ åŠŸèƒ½:                                                  â”‚ â”‚ â”‚
â”‚  â”‚  â”‚   â€¢ æ¥æ”¶ GDB å‘½ä»¤ (å¦‚: "åœ¨ 0x100 è¨­ä¸­æ–·é»")            â”‚ â”‚ â”‚
â”‚  â”‚  â”‚   â€¢ æ§åˆ¶ QEMU åŸ·è¡Œ (æš«åœ/ç¹¼çºŒ/å–®æ­¥)                   â”‚ â”‚ â”‚
â”‚  â”‚  â”‚   â€¢ è®€å–è¨˜æ†¶é«”å…§å®¹                                     â”‚ â”‚ â”‚
â”‚  â”‚  â”‚   â€¢ å¯«å…¥è¨˜æ†¶é«”å…§å®¹                                     â”‚ â”‚ â”‚
â”‚  â”‚  â”‚   â€¢ è®€å–æš«å­˜å™¨å€¼                                       â”‚ â”‚ â”‚
â”‚  â”‚  â”‚   â€¢ å›å‚³åŸ·è¡Œç‹€æ…‹çµ¦ GDB Client                         â”‚ â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                         â”‚                                          â”‚
â”‚                         â”‚ TCP/IP (GDB Remote Serial Protocol)     â”‚
â”‚                         â”‚ Port 1234                                â”‚
â”‚                         â”‚                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ çµ‚ç«¯ 2: GDB Client (é™¤éŒ¯å™¨æ§åˆ¶ç«¯)                           â”‚ â”‚
â”‚  â”‚                                                              â”‚ â”‚
â”‚  â”‚  $ gdb-multiarch uart_hello_world.axf                       â”‚ â”‚
â”‚  â”‚  GNU gdb (GDB) 12.1                                         â”‚ â”‚
â”‚  â”‚  Reading symbols from uart_hello_world.axf...              â”‚ â”‚
â”‚  â”‚                                                              â”‚ â”‚
â”‚  â”‚  (gdb) target remote localhost:1234   â† é€£æ¥åˆ° QEMU        â”‚ â”‚
â”‚  â”‚  Remote debugging using localhost:1234                      â”‚ â”‚
â”‚  â”‚  0x00000000 in ?? ()                   â† é€£æ¥æˆåŠŸï¼         â”‚ â”‚
â”‚  â”‚                                                              â”‚ â”‚
â”‚  â”‚  (gdb) break main                      â† è¨­å®šä¸­æ–·é»         â”‚ â”‚
â”‚  â”‚  Breakpoint 1 at 0x130: file main.c, line 45.              â”‚ â”‚
â”‚  â”‚                                                              â”‚ â”‚
â”‚  â”‚  (gdb) continue                        â† é–‹å§‹åŸ·è¡Œ           â”‚ â”‚
â”‚  â”‚  Continuing.                                                â”‚ â”‚
â”‚  â”‚  Breakpoint 1, main () at main.c:45    â† åœåœ¨ä¸­æ–·é»         â”‚ â”‚
â”‚  â”‚  45        int counter = 0;                                 â”‚ â”‚
â”‚  â”‚                                                              â”‚ â”‚
â”‚  â”‚  (gdb) print counter                   â† æŸ¥çœ‹è®Šæ•¸           â”‚ â”‚
â”‚  â”‚  $1 = 0                                                     â”‚ â”‚
â”‚  â”‚                                                              â”‚ â”‚
â”‚  â”‚  å…§éƒ¨é‹ä½œ:                                                   â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚  â”‚  â”‚ GDB Client å…ƒä»¶                                        â”‚ â”‚ â”‚
â”‚  â”‚  â”‚                                                        â”‚ â”‚ â”‚
â”‚  â”‚  â”‚ 1. ç¬¦è™Ÿè¡¨è§£æå™¨ (Symbol Table Parser)                 â”‚ â”‚ â”‚
â”‚  â”‚  â”‚    â€¢ è®€å– .axf æª”æ¡ˆçš„é™¤éŒ¯ç¬¦è™Ÿ (DWARF format)         â”‚ â”‚ â”‚
â”‚  â”‚  â”‚    â€¢ çŸ¥é“ main å‡½å¼åœ¨ä½å€ 0x130                       â”‚ â”‚ â”‚
â”‚  â”‚  â”‚    â€¢ çŸ¥é“ counter è®Šæ•¸åœ¨å †ç–Š sp+8                     â”‚ â”‚ â”‚
â”‚  â”‚  â”‚    â€¢ çŸ¥é“æ¯è¡Œç¨‹å¼ç¢¼å°æ‡‰çš„æ©Ÿå™¨ç¢¼ä½å€                   â”‚ â”‚ â”‚
â”‚  â”‚  â”‚                                                        â”‚ â”‚ â”‚
â”‚  â”‚  â”‚ 2. åŸå§‹ç¢¼é¡¯ç¤ºå¼•æ“                                      â”‚ â”‚ â”‚
â”‚  â”‚  â”‚    â€¢ æ ¹æ“š PC å€¼æ‰¾åˆ°å°æ‡‰çš„ C ç¨‹å¼ç¢¼                    â”‚ â”‚ â”‚
â”‚  â”‚  â”‚    â€¢ é¡¯ç¤ºç•¶å‰åŸ·è¡Œåˆ°å“ªä¸€è¡Œ                             â”‚ â”‚ â”‚
â”‚  â”‚  â”‚                                                        â”‚ â”‚ â”‚
â”‚  â”‚  â”‚ 3. RSP å”å®šè™•ç†å™¨                                      â”‚ â”‚ â”‚
â”‚  â”‚  â”‚    ä½¿ç”¨è€…å‘½ä»¤ â†’ RSP å°åŒ… â†’ å‚³é€åˆ° Server             â”‚ â”‚ â”‚
â”‚  â”‚  â”‚    ç¯„ä¾‹:                                               â”‚ â”‚ â”‚
â”‚  â”‚  â”‚      ä½¿ç”¨è€…: (gdb) break main                         â”‚ â”‚ â”‚
â”‚  â”‚  â”‚      GDB:  æŸ¥ç¬¦è™Ÿè¡¨ â†’ main åœ¨ 0x130                   â”‚ â”‚ â”‚
â”‚  â”‚  â”‚      RSP:  "$Z0,130,2#xx"  (åœ¨ 0x130 è¨­è»Ÿé«”ä¸­æ–·é»)   â”‚ â”‚ â”‚
â”‚  â”‚  â”‚      å›æ‡‰:  "OK"                                       â”‚ â”‚ â”‚
â”‚  â”‚  â”‚                                                        â”‚ â”‚ â”‚
â”‚  â”‚  â”‚      ä½¿ç”¨è€…: (gdb) print counter                      â”‚ â”‚ â”‚
â”‚  â”‚  â”‚      GDB:  æŸ¥ç¬¦è™Ÿè¡¨ â†’ counter åœ¨ [sp+8]               â”‚ â”‚ â”‚
â”‚  â”‚  â”‚      RSP:  "m20000ff8,4"  (è®€å– 0x20000ff8 é–‹å§‹ 4 bytes)â”‚â”‚â”‚
â”‚  â”‚  â”‚      å›æ‡‰:  "00000000"    (å€¼æ˜¯ 0)                    â”‚ â”‚ â”‚
â”‚  â”‚  â”‚      é¡¯ç¤º:  $1 = 0                                     â”‚ â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                    â”‚
â”‚  é€šè¨Šå”å®šç¯„ä¾‹ (GDB Remote Serial Protocol):                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ GDB Client â†’ Server                                        â”‚  â”‚
â”‚  â”‚   $c#63            (continue ç¹¼çºŒåŸ·è¡Œ)                     â”‚  â”‚
â”‚  â”‚   $Z0,130,2#xx     (åœ¨ 0x130 è¨­ä¸­æ–·é»)                    â”‚  â”‚
â”‚  â”‚   $m20000000,40#xx (è®€å– 0x20000000 é–‹å§‹ 64 bytes)        â”‚  â”‚
â”‚  â”‚   $M20000000,4:41424344#xx (å¯«å…¥ "ABCD" åˆ° 0x20000000)    â”‚  â”‚
â”‚  â”‚   $g#67            (è®€å–æ‰€æœ‰æš«å­˜å™¨)                        â”‚  â”‚
â”‚  â”‚                                                            â”‚  â”‚
â”‚  â”‚ Server â†’ GDB Client                                        â”‚  â”‚
â”‚  â”‚   $S05#xx          (Signal 5: SIGTRAP, åœåœ¨ä¸­æ–·é»)        â”‚  â”‚
â”‚  â”‚   $OK#xx           (å‘½ä»¤æˆåŠŸ)                              â”‚  â”‚
â”‚  â”‚   $00010203...#xx  (è¨˜æ†¶é«”/æš«å­˜å™¨å…§å®¹)                    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ç‚ºä»€éº¼éœ€è¦ .axf æª”æ¡ˆï¼Ÿ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ .bin æª”æ¡ˆ (ç´”äºŒé€²ä½)                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ å…§å®¹: åªæœ‰æ©Ÿå™¨ç¢¼                                             â”‚
â”‚                                                              â”‚
â”‚ 0x100: B5 08 20 41 F7 FF FF FE BD 08 ...                   â”‚
â”‚                                                              â”‚
â”‚ GDB çœ‹åˆ°é€™å€‹æœƒèªª: "æˆ‘ä¸çŸ¥é“é€™æ˜¯ä»€éº¼ï¼"                      â”‚
â”‚   â€¢ ä¸çŸ¥é“ 0x130 å°æ‡‰å“ªå€‹å‡½å¼                               â”‚
â”‚   â€¢ ä¸çŸ¥é“è®Šæ•¸çš„åç¨±å’Œä½ç½®                                   â”‚
â”‚   â€¢ ä¸èƒ½é¡¯ç¤º C åŸå§‹ç¢¼                                       â”‚
â”‚                                                              â”‚
â”‚ åªèƒ½ç”¨æ–¼: QEMU åŸ·è¡Œ (ä¸éœ€è¦ç¬¦è™Ÿ)                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ .axf / .elf æª”æ¡ˆ (Executable and Linkable Format)          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ å…§å®¹: æ©Ÿå™¨ç¢¼ + é™¤éŒ¯ç¬¦è™Ÿ (DWARF format)                     â”‚
â”‚                                                              â”‚
â”‚ 1. ç¨‹å¼ç¢¼æ®µ (.text):                                        â”‚
â”‚    0x100: B5 08 20 41 F7 FF FF FE BD 08 ...                â”‚
â”‚                                                              â”‚
â”‚ 2. é™¤éŒ¯ç¬¦è™Ÿè¡¨ (.debug_info, .debug_line...):               â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚    â”‚ ç¬¦è™Ÿåç¨±         é¡å‹        ä½å€        åŸå§‹ç¢¼    â”‚   â”‚
â”‚    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚    â”‚ main            å‡½å¼        0x130       main.c:45 â”‚   â”‚
â”‚    â”‚ print_uart0     å‡½å¼        0x1A0       uart.c:20 â”‚   â”‚
â”‚    â”‚ counter         intè®Šæ•¸     sp+8        main.c:46 â”‚   â”‚
â”‚    â”‚ message         char*       0x20000100  main.c:47 â”‚   â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                              â”‚
â”‚ 3. è¡Œè™Ÿè³‡è¨Š (.debug_line):                                  â”‚
â”‚    main.c:45 â†’ 0x130                                        â”‚
â”‚    main.c:46 â†’ 0x134                                        â”‚
â”‚    main.c:47 â†’ 0x138                                        â”‚
â”‚                                                              â”‚
â”‚ GDB çœ‹åˆ°é€™å€‹æœƒèªª: "æˆ‘å…¨éƒ½çŸ¥é“ï¼"                            â”‚
â”‚   â€¢ çŸ¥é“ 0x130 æ˜¯ main å‡½å¼                                 â”‚
â”‚   â€¢ çŸ¥é“ counter è®Šæ•¸åœ¨å“ªè£¡                                 â”‚
â”‚   â€¢ å¯ä»¥é¡¯ç¤ºå°æ‡‰çš„ C åŸå§‹ç¢¼                                 â”‚
â”‚                                                              â”‚
â”‚ ç”¨æ–¼: GDB é™¤éŒ¯ (å¿…é ˆæœ‰ç¬¦è™Ÿ)                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**é¡æ¯”ï¼šåœ°åœ–**

```
.bin æª”æ¡ˆ = æ²’æœ‰æ¨™ç¤ºçš„è¡›æ˜Ÿç…§ç‰‡
  â€¢ åªçœ‹åˆ°å»ºç¯‰ç‰©ï¼Œä¸çŸ¥é“åç¨±
  â€¢ ä¸çŸ¥é“é€™æ˜¯å­¸æ ¡é‚„æ˜¯é†«é™¢
  â€¢ ç„¡æ³•å°èˆª

.axf æª”æ¡ˆ = Google Maps
  â€¢ æ¯å€‹å»ºç¯‰éƒ½æœ‰æ¨™ç¤º
  â€¢ çŸ¥é“è¡—é“åç¨±
  â€¢ å¯ä»¥å°èˆªåˆ°ç›®çš„åœ°
  â€¢ GDB çš„ã€Œç›®çš„åœ°ã€å°±æ˜¯ Bug çš„ä½ç½®ï¼
```

---

## 3. GDB é ç«¯é™¤éŒ¯å®Œæ•´æµç¨‹

### æ­¥é©Ÿ 1: å•Ÿå‹• QEMU GDB Server

#### æ–¹å¼ A: Docker æ–¹å¼ (æ¨è–¦ï¼Œç’°å¢ƒä¸€è‡´)

```bash
# å•Ÿå‹• QEMU GDB Server (åœ¨èƒŒæ™¯åŸ·è¡Œ)
docker run --rm -d \
    -v /home/sbplab/jiawei/qemu/CMSIS_LM3S:/work:ro \
    -p 1234:1234 \
    --name qemu_gdb_server \
    cmsis-lm3s-qemu:latest \
    bash -c "cd /work/examples/uart_hello_world/gcc && \
             exec qemu-system-arm -M lm3s6965evb -nographic \
                  -kernel uart_hello_world.bin -s -S"
```

**åƒæ•¸è©³è§£**:

```bash
docker run --rm -d \
  â”‚       â”‚    â””â”€ -d: Detached mode (èƒŒæ™¯åŸ·è¡Œ)
  â”‚       â””â”€ --rm: å®¹å™¨åœæ­¢å¾Œè‡ªå‹•åˆªé™¤
  â””â”€ å•Ÿå‹• Docker å®¹å™¨

-v /home/sbplab/jiawei/qemu/CMSIS_LM3S:/work:ro \
  â”‚  â””â”€ Host è·¯å¾‘                 â””â”€ Container è·¯å¾‘ â””â”€ Read-only
  â””â”€ æ›è¼‰å°ˆæ¡ˆç›®éŒ„ (å”¯è®€)

-p 1234:1234 \
  â”‚  â””â”€ Host port  â””â”€ Container port
  â””â”€ ç«¯å£æ˜ å°„ (GDB å”å®šä½¿ç”¨ 1234)

--name qemu_gdb_server \
  â””â”€ å®¹å™¨åç¨± (æ–¹ä¾¿å¾ŒçºŒç®¡ç†)

cmsis-lm3s-qemu:latest \
  â””â”€ Docker image åç¨±

bash -c "..." \
  â””â”€ åœ¨å®¹å™¨å…§åŸ·è¡Œçš„å‘½ä»¤

cd /work/examples/uart_hello_world/gcc && \
  â””â”€ åˆ‡æ›åˆ°ç¯„ä¾‹ç›®éŒ„

exec qemu-system-arm -M lm3s6965evb -nographic \
     -kernel uart_hello_world.bin -s -S
  â”‚                                 â”‚  â””â”€ -S: å•Ÿå‹•æ™‚æš«åœ
  â”‚                                 â””â”€ -s: å•Ÿå‹• GDB server (ç­‰æ–¼ -gdb tcp::1234)
  â””â”€ exec: æ›¿æ› shell process (å®¹å™¨ä¸æœƒæœ‰å¤šé¤˜çš„ bash process)
```

**é©—è­‰ QEMU æ˜¯å¦å•Ÿå‹•æˆåŠŸ**:

```bash
# æª¢æŸ¥å®¹å™¨æ˜¯å¦åœ¨åŸ·è¡Œ
docker ps | grep qemu_gdb_server

# æ‡‰è©²çœ‹åˆ°:
# CONTAINER ID   IMAGE                    ...   PORTS                    NAMES
# abc123def456   cmsis-lm3s-qemu:latest   ...   0.0.0.0:1234->1234/tcp   qemu_gdb_server

# æª¢æŸ¥ port 1234 æ˜¯å¦è¢«ç›£è½
netstat -tuln | grep 1234

# æ‡‰è©²çœ‹åˆ°:
# tcp        0      0 0.0.0.0:1234            0.0.0.0:*               LISTEN
```

#### æ–¹å¼ B: æœ¬åœ°æ–¹å¼ (ç›´æ¥åŸ·è¡Œ)

```bash
# ç›´æ¥åœ¨çµ‚ç«¯åŸ·è¡Œ (ä¸ä½¿ç”¨ Docker)
qemu-system-arm \
    -M lm3s6965evb \
    -nographic \
    -kernel uart_hello_world.bin \
    -s \    # GDB server on port 1234
    -S      # å•Ÿå‹•æ™‚æš«åœ

# æœƒçœ‹åˆ°:
# (ç„¡è¼¸å‡ºï¼Œç¨‹å¼æš«åœç­‰å¾… GDB é€£æ¥)
```

---

### æ­¥é©Ÿ 2: å•Ÿå‹• GDB Client

#### æ–¹å¼ A: Docker æ–¹å¼

```bash
# å•Ÿå‹• GDB Client (äº’å‹•æ¨¡å¼)
docker run --rm -it \
    -v /home/sbplab/jiawei/qemu/CMSIS_LM3S:/work:ro \
    --network host \
    cmsis-lm3s-gdb:latest \
    bash -c "cd /work/examples/uart_hello_world/gcc && \
             gdb-multiarch uart_hello_world.axf"
```

**åƒæ•¸è©³è§£**:

```bash
-it \
  â”‚â””â”€ -t: åˆ†é… pseudo-TTY (çµ‚ç«¯)
  â””â”€ -i: Interactive (ä¿æŒ STDIN é–‹å•Ÿ)
  åˆèµ·ä¾†: è®“ä½ å¯ä»¥åœ¨å®¹å™¨å…§äº’å‹•è¼¸å…¥å‘½ä»¤

--network host \
  â””â”€ ä½¿ç”¨ Host çš„ç¶²è·¯ (å¯ä»¥é€£æ¥åˆ° Host çš„ localhost:1234)
     å¦‚æœä¸åŠ é€™å€‹ï¼Œå®¹å™¨å…§çš„ localhost æœƒæ˜¯å®¹å™¨è‡ªå·±çš„ç¶²è·¯

gdb-multiarch uart_hello_world.axf
  â”‚             â””â”€ .axf æª”æ¡ˆ (åŒ…å«é™¤éŒ¯ç¬¦è™Ÿ)
  â””â”€ å¤šæ¶æ§‹ GDB (å¯ä»¥é™¤éŒ¯ ARM, RISC-V, MIPS...)
```

#### æ–¹å¼ B: æœ¬åœ°æ–¹å¼

```bash
cd /home/sbplab/jiawei/qemu/CMSIS_LM3S/examples/uart_hello_world/gcc

# ä½¿ç”¨ gdb-multiarch (æ”¯æ´å¤šç¨® CPU æ¶æ§‹)
gdb-multiarch uart_hello_world.axf

# æˆ–ä½¿ç”¨ ARM å°ˆç”¨çš„ GDB (å¦‚æœæœ‰å®‰è£)
arm-none-eabi-gdb uart_hello_world.axf
```

**GDB å•Ÿå‹•å¾Œæœƒçœ‹åˆ°**:

```
GNU gdb (GDB) 12.1
Copyright (C) 2022 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>
...
Reading symbols from uart_hello_world.axf...
(gdb) _
```

---

### æ­¥é©Ÿ 3: é€£æ¥åˆ° QEMU GDB Server

åœ¨ GDB prompt è¼¸å…¥:

```gdb
(gdb) target remote localhost:1234
```

**æˆåŠŸé€£æ¥æœƒçœ‹åˆ°**:

```
Remote debugging using localhost:1234
0x00000000 in ?? ()
```

**è§£è®€**:

```
Remote debugging using localhost:1234
  â””â”€ GDB æˆåŠŸé€£æ¥åˆ° localhost:1234 çš„ GDB server

0x00000000 in ?? ()
  â”‚          â””â”€ ?? è¡¨ç¤º GDB ä¸çŸ¥é“é€™å€‹ä½å€å°æ‡‰ä»€éº¼å‡½å¼
  â”‚             (å› ç‚ºé€™æ˜¯ä¸­æ–·å‘é‡è¡¨çš„ä½ç½®ï¼Œä¸æ˜¯ C ç¨‹å¼ç¢¼)
  â””â”€ ç›®å‰ Program Counter (PC) åœ¨ä½å€ 0x0
```

æ­¤æ™‚ç¨‹å¼åœåœ¨ **ç¬¬ä¸€æ¢æŒ‡ä»¤**ï¼ˆReset_Handler çš„å…¥å£ï¼‰ã€‚

---

### æ­¥é©Ÿ 4: è¨­å®šä¸­æ–·é»

```gdb
(gdb) break main
Breakpoint 1 at 0x130: file uart_hello_world.c, line 45.
```

**è§£è®€**:

```
Breakpoint 1
  â””â”€ ä¸­æ–·é»ç·¨è™Ÿ (ç¬¬ä¸€å€‹ä¸­æ–·é»)

at 0x130
  â””â”€ main å‡½å¼åœ¨è¨˜æ†¶é«”ä½å€ 0x130

file uart_hello_world.c, line 45
  â””â”€ åŸå§‹ç¢¼æª”æ¡ˆå’Œè¡Œè™Ÿ
```

**å…¶ä»–ä¸­æ–·é»è¨­å®šæ–¹å¼**:

```gdb
# åœ¨å‡½å¼åç¨±è¨­ä¸­æ–·é»
(gdb) break print_uart0
Breakpoint 2 at 0x1a0: file uart.c, line 20.

# åœ¨ç‰¹å®šæª”æ¡ˆçš„ç‰¹å®šè¡Œè¨­ä¸­æ–·é»
(gdb) break main.c:50
Breakpoint 3 at 0x138: file main.c, line 50.

# åœ¨è¨˜æ†¶é«”ä½å€è¨­ä¸­æ–·é»
(gdb) break *0x200
Breakpoint 4 at 0x200

# æ¢ä»¶ä¸­æ–·é» (åªåœ¨æ¢ä»¶æ»¿è¶³æ™‚ä¸­æ–·)
(gdb) break main.c:55 if counter > 10
Breakpoint 5 at 0x140: file main.c, line 55.

# æŸ¥çœ‹æ‰€æœ‰ä¸­æ–·é»
(gdb) info breakpoints
Num     Type           Disp Enb Address    What
1       breakpoint     keep y   0x00000130 in main at main.c:45
2       breakpoint     keep y   0x000001a0 in print_uart0 at uart.c:20
3       breakpoint     keep y   0x00000138 in main at main.c:50
```

---

### æ­¥é©Ÿ 5: é–‹å§‹åŸ·è¡Œ

```gdb
(gdb) continue
Continuing.

Breakpoint 1, main () at uart_hello_world.c:45
45          int counter = 0;
(gdb) _
```

**ç™¼ç”Ÿäº†ä»€éº¼ï¼Ÿ**

1. `continue` å‘½ä»¤è®“ç¨‹å¼é–‹å§‹åŸ·è¡Œ
2. ç¨‹å¼å¾ 0x0 é–‹å§‹åŸ·è¡Œ Reset_Handler
3. Reset_Handler åˆå§‹åŒ–è¨˜æ†¶é«”å¾Œè·³åˆ° main
4. åŸ·è¡Œåˆ° main å‡½å¼çš„ç¬¬ä¸€è¡Œï¼ˆ0x130ï¼‰
5. è§¸ç™¼ä¸­æ–·é»ï¼Œç¨‹å¼æš«åœ
6. GDB é¡¯ç¤ºç•¶å‰åŸ·è¡Œåˆ°çš„ç¨‹å¼ç¢¼è¡Œ

---

### æ­¥é©Ÿ 6: å–®æ­¥åŸ·è¡Œ

```gdb
(gdb) next
46          char *message = "Hello, UART World!";

(gdb) next
47          while(1) {

(gdb) print counter
$1 = 0

(gdb) print message
$2 = 0x20000100 "Hello, UART World!"

(gdb) next
48              print_uart0(message);

(gdb) step      â† step æœƒé€²å…¥å‡½å¼å…§éƒ¨
print_uart0 (s=0x20000100 "Hello, UART World!") at uart.c:20
20          while(*s != '\0') {
```

**next vs step çš„å·®ç•°**:

```
ç¨‹å¼ç¢¼:
45    int counter = 0;
46    char *message = "Hello";
47    print_uart0(message);   â† ç•¶å‰ä½ç½®
48    counter++;

ä½¿ç”¨ next:
  â†’ åŸ·è¡Œ print_uart0(message)
  â†’ ç›´æ¥è·³åˆ°ä¸‹ä¸€è¡Œ (48)
  â†’ ä¸é€²å…¥ print_uart0 å‡½å¼å…§éƒ¨

ä½¿ç”¨ step:
  â†’ åŸ·è¡Œ print_uart0(message)
  â†’ é€²å…¥ print_uart0 å‡½å¼å…§éƒ¨
  â†’ åœåœ¨ print_uart0 çš„ç¬¬ä¸€è¡Œ
```

---

### æ­¥é©Ÿ 7: æª¢æŸ¥è®Šæ•¸èˆ‡è¨˜æ†¶é«”

```gdb
# æª¢æŸ¥è®Šæ•¸å€¼
(gdb) print counter
$3 = 0

# ä»¥åå…­é€²ä½é¡¯ç¤º
(gdb) print/x counter
$4 = 0x0

# æª¢æŸ¥æŒ‡æ¨™æŒ‡å‘çš„å…§å®¹
(gdb) print *message
$5 = 72 'H'

# ä»¥å­—ä¸²æ ¼å¼é¡¯ç¤º
(gdb) x/s message
0x20000100:     "Hello, UART World!"

# æŸ¥çœ‹è¨˜æ†¶é«”å…§å®¹ (10 å€‹ bytes)
(gdb) x/10xb message
0x20000100:     0x48    0x65    0x6c    0x6c    0x6f    0x2c    0x20    0x55
0x20000108:     0x41    0x52

# æŸ¥çœ‹è¨˜æ†¶é«”å…§å®¹ (10 å€‹ words)
(gdb) x/10xw 0x20000000
0x20000000:     0x20010000      0x00000131      0x00000171      0x00000171
0x20000010:     0x00000171      0x00000171      0x00000171      0x00000000
```

---

### æ­¥é©Ÿ 8: æª¢æŸ¥æš«å­˜å™¨

```gdb
(gdb) info registers
r0             0x20000100       536871168
r1             0x20000100       536871168
r2             0x0              0
r3             0x0              0
r4             0x0              0
r5             0x0              0
r6             0x0              0
r7             0x20001438       536877112
r8             0x0              0
r9             0x0              0
r10            0x0              0
r11            0x0              0
r12            0x0              0
sp             0x20001438       0x20001438 <pulStack+800>
lr             0x171            369
pc             0x1a4            0x1a4 <print_uart0+4>
```

**é‡è¦æš«å­˜å™¨è§£é‡‹**:

```
r0-r12: é€šç”¨æš«å­˜å™¨
  â€¢ r0-r3: é€šå¸¸ç”¨æ–¼å‡½å¼åƒæ•¸å’Œè¿”å›å€¼
  â€¢ r4-r11: ä¿å­˜æš«å­˜å™¨ (callee-saved)
  â€¢ r12: Scratch register

sp (r13): Stack Pointer (å †ç–ŠæŒ‡æ¨™)
  â€¢ æŒ‡å‘ç›®å‰å †ç–Šçš„é ‚ç«¯
  â€¢ 0x20001438 è¡¨ç¤ºå †ç–Šåœ¨ SRAM ä¸­

lr (r14): Link Register (éˆçµæš«å­˜å™¨)
  â€¢ å„²å­˜å‡½å¼çš„è¿”å›ä½å€
  â€¢ 0x171 è¡¨ç¤ºç•¶ print_uart0 è¿”å›æ™‚æœƒè·³åˆ° 0x171

pc (r15): Program Counter (ç¨‹å¼è¨ˆæ•¸å™¨)
  â€¢ æŒ‡å‘ç›®å‰åŸ·è¡Œçš„æŒ‡ä»¤ä½å€
  â€¢ 0x1a4 è¡¨ç¤ºæ­£åœ¨åŸ·è¡Œ print_uart0+4 çš„æŒ‡ä»¤
```

---

### æ­¥é©Ÿ 9: æŸ¥çœ‹å‘¼å«å †ç–Š

```gdb
(gdb) backtrace
#0  print_uart0 (s=0x20000100 "Hello, UART World!") at uart.c:20
#1  0x00000148 in main () at uart_hello_world.c:48
```

**è§£è®€**:

```
#0  print_uart0 (s=0x20000100 "Hello, UART World!") at uart.c:20
  â”‚  â””â”€ å‡½å¼åç¨±  â””â”€ åƒæ•¸              â””â”€ åŸå§‹ç¢¼ä½ç½®
  â””â”€ Frame 0 (æœ€å…§å±¤ï¼Œç›®å‰åŸ·è¡Œçš„å‡½å¼)

#1  0x00000148 in main () at uart_hello_world.c:48
  â”‚  â””â”€ è¿”å›ä½å€     â””â”€ å‘¼å«è€…å‡½å¼  â””â”€ å‘¼å«ä½ç½®
  â””â”€ Frame 1 (å¤–å±¤ï¼Œå‘¼å« print_uart0 çš„å‡½å¼)
```

**åˆ‡æ› Frame**:

```gdb
# åˆ‡æ›åˆ° Frame 1 (main å‡½å¼)
(gdb) frame 1
#1  0x00000148 in main () at uart_hello_world.c:48
48              print_uart0(message);

# æŸ¥çœ‹ main å‡½å¼çš„å€åŸŸè®Šæ•¸
(gdb) info locals
counter = 0
message = 0x20000100 "Hello, UART World!"

# åˆ‡å› Frame 0 (print_uart0 å‡½å¼)
(gdb) frame 0
#0  print_uart0 (s=0x20000100 "Hello, UART World!") at uart.c:20
20          while(*s != '\0') {
```

---

### æ­¥é©Ÿ 10: ä¿®æ”¹è®Šæ•¸å€¼

GDB ä¸åªèƒ½æŸ¥çœ‹ï¼Œé‚„èƒ½**ä¿®æ”¹**è®Šæ•¸ï¼

```gdb
# æŸ¥çœ‹ counter çš„å€¼
(gdb) print counter
$6 = 0

# ä¿®æ”¹ counter çš„å€¼
(gdb) set variable counter = 100

# é©—è­‰ä¿®æ”¹æˆåŠŸ
(gdb) print counter
$7 = 100

# ä¿®æ”¹è¨˜æ†¶é«”å…§å®¹
(gdb) set {int}0x20000000 = 0x12345678

# é©—è­‰
(gdb) x/x 0x20000000
0x20000000:     0x12345678
```

**æ‡‰ç”¨å ´æ™¯**:

```
å ´æ™¯ 1: æ¸¬è©¦éŒ¯èª¤è™•ç†
  (gdb) set variable error_code = -1
  â†’ å¼·åˆ¶è§¸ç™¼éŒ¯èª¤è·¯å¾‘ï¼Œæ¸¬è©¦éŒ¯èª¤è™•ç†æ˜¯å¦æ­£ç¢º

å ´æ™¯ 2: è·³éé•·æ™‚é–“ç­‰å¾…
  (gdb) set variable timeout = 0
  â†’ è·³é delayï¼ŒåŠ é€Ÿé™¤éŒ¯

å ´æ™¯ 3: æ³¨å…¥æ¸¬è©¦è³‡æ–™
  (gdb) set variable adc_value = 4095
  â†’ æ¨¡æ“¬ ADC æœ€å¤§å€¼ï¼Œæ¸¬è©¦é‚Šç•Œæ¢ä»¶
```

---

## 4. GDB å‘½ä»¤å®Œå…¨æŒ‡å—

### ç¨‹å¼æ§åˆ¶å‘½ä»¤

```gdb
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å‘½ä»¤            ç¸®å¯«    èªªæ˜                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ continue        c       ç¹¼çºŒåŸ·è¡Œåˆ°ä¸‹ä¸€å€‹ä¸­æ–·é»               â”‚
â”‚                                                              â”‚
â”‚ next            n       å–®æ­¥åŸ·è¡Œ (ä¸é€²å…¥å‡½å¼)                â”‚
â”‚                         ç¯„ä¾‹: åŸ·è¡Œ func() æœƒè·³éå‡½å¼å…§éƒ¨    â”‚
â”‚                                                              â”‚
â”‚ step            s       å–®æ­¥åŸ·è¡Œ (é€²å…¥å‡½å¼)                  â”‚
â”‚                         ç¯„ä¾‹: åŸ·è¡Œ func() æœƒé€²å…¥å‡½å¼å…§éƒ¨    â”‚
â”‚                                                              â”‚
â”‚ finish                  åŸ·è¡Œåˆ°ç•¶å‰å‡½å¼è¿”å›                   â”‚
â”‚                         ç”¨é€”: å¿«é€Ÿè·³å‡ºç›®å‰å‡½å¼               â”‚
â”‚                                                              â”‚
â”‚ until <line>    u       åŸ·è¡Œåˆ°æŒ‡å®šè¡Œ                         â”‚
â”‚                         ç¯„ä¾‹: until 50 (åŸ·è¡Œåˆ°ç¬¬ 50 è¡Œ)     â”‚
â”‚                                                              â”‚
â”‚ stepi           si      å–®æ­¥åŸ·è¡Œä¸€æ¢æ©Ÿå™¨æŒ‡ä»¤                 â”‚
â”‚                         ç”¨é€”: ä½éšé™¤éŒ¯ã€è§€å¯Ÿçµ„åˆèªè¨€         â”‚
â”‚                                                              â”‚
â”‚ nexti           ni      å–®æ­¥åŸ·è¡Œä¸€æ¢æ©Ÿå™¨æŒ‡ä»¤ (ä¸é€²å…¥)        â”‚
â”‚                                                              â”‚
â”‚ jump <location>         å¼·åˆ¶è·³åˆ°æŒ‡å®šä½ç½®                     â”‚
â”‚                         è­¦å‘Š: å¯èƒ½ç ´å£ç¨‹å¼ç‹€æ…‹ï¼             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ç¯„ä¾‹**:

```gdb
# å ´æ™¯: æƒ³è·³éä¸€å€‹é•·æ™‚é–“çš„è¿´åœˆ
45    for(int i = 0; i < 1000000; i++) {
46        process(i);
47    }
48    printf("Done");

# å‚³çµ±æ–¹å¼: è¦åŸ·è¡Œ 1000000 æ¬¡ next... (å¤ªæ…¢ï¼)
# GDB æ–¹å¼:
(gdb) break 45      # åœåœ¨è¿´åœˆå‰
(gdb) continue
(gdb) break 48      # åœ¨è¿´åœˆå¾Œè¨­ä¸­æ–·é»
(gdb) continue      # ç›´æ¥è·³åˆ°è¿´åœˆå¾Œ
# æˆ–
(gdb) until 48      # ç›´æ¥åŸ·è¡Œåˆ°ç¬¬ 48 è¡Œ
```

---

### ä¸­æ–·é»ç®¡ç†å‘½ä»¤

```gdb
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å‘½ä»¤                        èªªæ˜                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ break <location>            è¨­å®šä¸­æ–·é»                       â”‚
â”‚   break main                  åœ¨ main å‡½å¼                  â”‚
â”‚   break main.c:50             åœ¨ main.c ç¬¬ 50 è¡Œ            â”‚
â”‚   break *0x130                åœ¨è¨˜æ†¶é«”ä½å€ 0x130            â”‚
â”‚   break main if x > 10        æ¢ä»¶ä¸­æ–·é»                    â”‚
â”‚                                                              â”‚
â”‚ tbreak <location>           è‡¨æ™‚ä¸­æ–·é» (è§¸ç™¼ä¸€æ¬¡å¾Œè‡ªå‹•åˆªé™¤) â”‚
â”‚   tbreak main                                               â”‚
â”‚                                                              â”‚
â”‚ watch <expression>          è¨­å®šç›£è¦–é» (è®Šæ•¸æ”¹è®Šæ™‚ä¸­æ–·)     â”‚
â”‚   watch counter               ç•¶ counter æ”¹è®Šæ™‚ä¸­æ–·         â”‚
â”‚   watch *0x20000000           ç•¶è©²è¨˜æ†¶é«”æ”¹è®Šæ™‚ä¸­æ–·          â”‚
â”‚                                                              â”‚
â”‚ rwatch <expression>         è¨­å®šè®€å–ç›£è¦–é» (è®€å–æ™‚ä¸­æ–·)     â”‚
â”‚   rwatch counter              ç•¶è®€å– counter æ™‚ä¸­æ–·         â”‚
â”‚                                                              â”‚
â”‚ awatch <expression>         è¨­å®šå­˜å–ç›£è¦–é» (è®€å¯«éƒ½ä¸­æ–·)     â”‚
â”‚   awatch buffer[10]                                         â”‚
â”‚                                                              â”‚
â”‚ catchpoint                  æ•ç²ç‰¹å®šäº‹ä»¶                     â”‚
â”‚   catch throw                 C++ ä¾‹å¤–æ‹‹å‡ºæ™‚                â”‚
â”‚   catch syscall               ç³»çµ±å‘¼å«æ™‚                    â”‚
â”‚                                                              â”‚
â”‚ info breakpoints            åˆ—å‡ºæ‰€æœ‰ä¸­æ–·é»                   â”‚
â”‚ info watchpoints            åˆ—å‡ºæ‰€æœ‰ç›£è¦–é»                   â”‚
â”‚                                                              â”‚
â”‚ delete <num>                åˆªé™¤ä¸­æ–·é»                       â”‚
â”‚   delete 1                    åˆªé™¤ä¸­æ–·é» 1                  â”‚
â”‚   delete                      åˆªé™¤æ‰€æœ‰ä¸­æ–·é»                â”‚
â”‚                                                              â”‚
â”‚ disable <num>               åœç”¨ä¸­æ–·é» (ä¸åˆªé™¤)             â”‚
â”‚   disable 1                                                 â”‚
â”‚                                                              â”‚
â”‚ enable <num>                å•Ÿç”¨ä¸­æ–·é»                       â”‚
â”‚   enable 1                                                  â”‚
â”‚                                                              â”‚
â”‚ clear <location>            åˆªé™¤ç‰¹å®šä½ç½®çš„ä¸­æ–·é»             â”‚
â”‚   clear main.c:50                                           â”‚
â”‚                                                              â”‚
â”‚ condition <num> <expr>      ç‚ºä¸­æ–·é»æ·»åŠ æ¢ä»¶                 â”‚
â”‚   condition 1 x > 100         åªåœ¨ x > 100 æ™‚è§¸ç™¼           â”‚
â”‚                                                              â”‚
â”‚ ignore <num> <count>        å¿½ç•¥ä¸­æ–·é» N æ¬¡                  â”‚
â”‚   ignore 1 10                 å¿½ç•¥ä¸­æ–·é» 1 å‰ 10 æ¬¡         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ç›£è¦–é» (Watchpoint) çš„å¨åŠ›**:

```c
// å•é¡Œ: buffer è¢«è«åå…¶å¦™è¦†å¯«ï¼Œä½†ä¸çŸ¥é“åœ¨å“ªè£¡
int buffer[100];

void func1() {
    // ...å¯èƒ½æ”¹äº† buffer?
}

void func2() {
    // ...å¯èƒ½æ”¹äº† buffer?
}

void func3() {
    // ...å¯èƒ½æ”¹äº† buffer?
}

// å‚³çµ±é™¤éŒ¯: åœ¨æ¯å€‹å‡½å¼æ’å…¥ printf æª¢æŸ¥ buffer... (è¶…ç´¯ï¼)

// GDB æ–¹å¼:
(gdb) watch buffer[50]
Hardware watchpoint 2: buffer[50]
(gdb) continue

Hardware watchpoint 2: buffer[50]

Old value = 0
New value = 999
func2 () at test.c:25
25        buffer[50] = 999;    â† æ‰¾åˆ°å…‡æ‰‹ï¼
```

---

### æŸ¥çœ‹è³‡è¨Šå‘½ä»¤

```gdb
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å‘½ä»¤                        èªªæ˜                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ info registers              é¡¯ç¤ºæ‰€æœ‰æš«å­˜å™¨                   â”‚
â”‚ info registers r0 r1        é¡¯ç¤ºç‰¹å®šæš«å­˜å™¨                   â”‚
â”‚                                                              â”‚
â”‚ print <expr>                é¡¯ç¤ºè¡¨é”å¼çš„å€¼                   â”‚
â”‚   print counter               é¡¯ç¤ºè®Šæ•¸                      â”‚
â”‚   print/x counter             ä»¥åå…­é€²ä½é¡¯ç¤º                â”‚
â”‚   print/d counter             ä»¥åé€²ä½é¡¯ç¤º                  â”‚
â”‚   print/t counter             ä»¥äºŒé€²ä½é¡¯ç¤º                  â”‚
â”‚   print/c counter             ä»¥å­—å…ƒé¡¯ç¤º                    â”‚
â”‚   print/f counter             ä»¥æµ®é»æ•¸é¡¯ç¤º                  â”‚
â”‚   print $r0                   é¡¯ç¤ºæš«å­˜å™¨ r0                 â”‚
â”‚   print sizeof(buffer)        é¡¯ç¤ºå¤§å°                      â”‚
â”‚   print *ptr                  é¡¯ç¤ºæŒ‡æ¨™å…§å®¹                  â”‚
â”‚                                                              â”‚
â”‚ x (examine)                 æª¢æŸ¥è¨˜æ†¶é«”                       â”‚
â”‚   x/nfu <address>                                           â”‚
â”‚     n: æ•¸é‡                                                  â”‚
â”‚     f: æ ¼å¼ (x=hex, d=decimal, s=string, i=instruction)    â”‚
â”‚     u: å–®ä½ (b=byte, h=halfword, w=word)                   â”‚
â”‚                                                              â”‚
â”‚   ç¯„ä¾‹:                                                      â”‚
â”‚   x/16xb 0x20000000          æŸ¥çœ‹ 16 å€‹ bytes (hex)         â”‚
â”‚   x/4xw $sp                  æŸ¥çœ‹å †ç–Š (4 å€‹ words)          â”‚
â”‚   x/10i $pc                  æŸ¥çœ‹ 10 æ¢æŒ‡ä»¤                 â”‚
â”‚   x/s 0x20000100             æŸ¥çœ‹å­—ä¸²                       â”‚
â”‚                                                              â”‚
â”‚ info locals                 é¡¯ç¤ºå€åŸŸè®Šæ•¸                     â”‚
â”‚ info args                   é¡¯ç¤ºå‡½å¼åƒæ•¸                     â”‚
â”‚ info variables             é¡¯ç¤ºå…¨åŸŸè®Šæ•¸                     â”‚
â”‚ info functions             é¡¯ç¤ºæ‰€æœ‰å‡½å¼                     â”‚
â”‚                                                              â”‚
â”‚ backtrace (bt)              é¡¯ç¤ºå‘¼å«å †ç–Š                     â”‚
â”‚   bt                          å®Œæ•´å †ç–Š                      â”‚
â”‚   bt 5                        åªé¡¯ç¤º 5 å±¤                   â”‚
â”‚   bt full                     é¡¯ç¤ºæ¯å±¤çš„å€åŸŸè®Šæ•¸            â”‚
â”‚                                                              â”‚
â”‚ frame <num>                 åˆ‡æ›å †ç–Šæ¡†                       â”‚
â”‚   frame 0                     åˆ‡åˆ°æœ€å…§å±¤                    â”‚
â”‚   frame 1                     åˆ‡åˆ°ä¸Šä¸€å±¤                    â”‚
â”‚                                                              â”‚
â”‚ list                        é¡¯ç¤ºåŸå§‹ç¢¼                       â”‚
â”‚   list                        é¡¯ç¤ºç•¶å‰ä½ç½®é™„è¿‘çš„ç¨‹å¼ç¢¼      â”‚
â”‚   list 50                     é¡¯ç¤ºç¬¬ 50 è¡Œé™„è¿‘              â”‚
â”‚   list main                   é¡¯ç¤º main å‡½å¼                â”‚
â”‚                                                              â”‚
â”‚ disassemble                 åçµ„è­¯                           â”‚
â”‚   disassemble main            åçµ„è­¯ main å‡½å¼              â”‚
â”‚   disassemble $pc             åçµ„è­¯ç•¶å‰ä½ç½®                â”‚
â”‚   disassemble 0x130,0x150     åçµ„è­¯ä½å€ç¯„åœ                â”‚
â”‚                                                              â”‚
â”‚ info files                  é¡¯ç¤ºè¼‰å…¥çš„æª”æ¡ˆè³‡è¨Š               â”‚
â”‚ info target                 é¡¯ç¤ºç›®æ¨™ç³»çµ±è³‡è¨Š                 â”‚
â”‚ info threads                é¡¯ç¤ºæ‰€æœ‰åŸ·è¡Œç·’ (RTOS)           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**print çš„é€²éšç”¨æ³•**:

```gdb
# è¨ˆç®—è¡¨é”å¼
(gdb) print 5 + 3
$1 = 8

(gdb) print sizeof(int)
$2 = 4

# å‘¼å«å‡½å¼
(gdb) print strlen("Hello")
$3 = 5

# å‹åˆ¥è½‰æ›
(gdb) print (char*)0x20000100
$4 = 0x20000100 "Hello World"

# é™£åˆ—æŸ¥çœ‹
(gdb) print buffer[0]@10    # é¡¯ç¤º buffer[0] é–‹å§‹çš„ 10 å€‹å…ƒç´ 
$5 = {0, 1, 2, 3, 4, 5, 6, 7, 8, 9}

# çµæ§‹é«”æˆå“¡
(gdb) print fir_instance.numTaps
$6 = 29

(gdb) print *fir_instance.pCoeffs@29    # é¡¯ç¤ºä¿‚æ•¸é™£åˆ—
```

---

### ä¿®æ”¹ç¨‹å¼ç‹€æ…‹å‘½ä»¤

```gdb
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å‘½ä»¤                        èªªæ˜                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ set variable <var> = <value>  ä¿®æ”¹è®Šæ•¸å€¼                    â”‚
â”‚   set variable counter = 100                                â”‚
â”‚   set variable ptr = 0x20000000                             â”‚
â”‚                                                              â”‚
â”‚ set {type}<address> = <value>  ç›´æ¥å¯«å…¥è¨˜æ†¶é«”               â”‚
â”‚   set {int}0x20000000 = 0x1234                              â”‚
â”‚   set {char}0x20000100 = 'A'                                â”‚
â”‚                                                              â”‚
â”‚ set $r0 = 100               ä¿®æ”¹æš«å­˜å™¨                       â”‚
â”‚ set $pc = 0x200             ä¿®æ”¹ PC (å±éšªï¼)                â”‚
â”‚                                                              â”‚
â”‚ return [value]              å¼·åˆ¶å‡½å¼è¿”å›                     â”‚
â”‚   return 0                    å¾ç•¶å‰å‡½å¼è¿”å› 0              â”‚
â”‚                                                              â”‚
â”‚ call <function>             å‘¼å«å‡½å¼                         â”‚
â”‚   call printf("Debug\n")                                    â”‚
â”‚   call init_uart()                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### å…¶ä»–å¯¦ç”¨å‘½ä»¤

```gdb
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å‘½ä»¤                        èªªæ˜                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ help [command]              é¡¯ç¤ºèªªæ˜                         â”‚
â”‚   help break                                                â”‚
â”‚   help all                   é¡¯ç¤ºæ‰€æœ‰å‘½ä»¤                   â”‚
â”‚                                                              â”‚
â”‚ quit (q)                    é€€å‡º GDB                         â”‚
â”‚                                                              â”‚
â”‚ shell <command>             åŸ·è¡Œ Shell å‘½ä»¤                  â”‚
â”‚   shell ls                                                  â”‚
â”‚                                                              â”‚
â”‚ define <name>               å®šç¾©è‡ªè¨‚å‘½ä»¤                     â”‚
â”‚   (è¦‹å¾ŒçºŒç« ç¯€)                                              â”‚
â”‚                                                              â”‚
â”‚ source <file>               åŸ·è¡Œ GDB è…³æœ¬                    â”‚
â”‚   source test.gdb                                           â”‚
â”‚                                                              â”‚
â”‚ set pagination off          é—œé–‰åˆ†é  (è‡ªå‹•åŒ–è…³æœ¬ç”¨)         â”‚
â”‚ set confirm off             é—œé–‰ç¢ºèªè¨Šæ¯                     â”‚
â”‚                                                              â”‚
â”‚ set print pretty on         ç¾åŒ–çµæ§‹é«”é¡¯ç¤º                   â”‚
â”‚ set print array on          ç¾åŒ–é™£åˆ—é¡¯ç¤º                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 5. å¯¦éš›é™¤éŒ¯ç¯„ä¾‹ï¼šFIR æ¿¾æ³¢å™¨

### å ´æ™¯è¨­å®š

å‡è¨­ FIR æ¿¾æ³¢å™¨çš„ SNR æ¸¬è©¦å¤±æ•—ï¼Œæˆ‘å€‘éœ€è¦æ‰¾å‡ºåŸå› ã€‚

### å®Œæ•´é™¤éŒ¯æµç¨‹

#### Step 1: å•Ÿå‹•ç’°å¢ƒ

**çµ‚ç«¯ 1** (å•Ÿå‹• QEMU GDB Server):

```bash
docker run --rm -d \
    -v /home/sbplab/jiawei/qemu/CMSIS_LM3S:/work:ro \
    -p 1234:1234 \
    --name qemu_gdb_server \
    cmsis-lm3s-qemu:latest \
    bash -c "cd /work/examples/arm_fir_example/gcc && \
             exec qemu-system-arm -M lm3s6965evb -nographic \
                  -kernel arm_fir_example_f32.bin -s -S"
```

**çµ‚ç«¯ 2** (å•Ÿå‹• GDB):

```bash
docker run --rm -it \
    -v /home/sbplab/jiawei/qemu/CMSIS_LM3S:/work:ro \
    --network host \
    cmsis-lm3s-gdb:latest \
    bash -c "cd /work/examples/arm_fir_example/gcc && \
             gdb-multiarch arm_fir_example_f32.axf"
```

#### Step 2: é€£æ¥ä¸¦è¨­å®šä¸­æ–·é»

```gdb
# é€£æ¥åˆ° QEMU
(gdb) target remote localhost:1234
Remote debugging using localhost:1234
0x00000000 in ?? ()

# åœ¨é—œéµå‡½å¼è¨­å®šä¸­æ–·é»
(gdb) break main
Breakpoint 1 at 0x130: file arm_fir_example_f32.c, line 203.

(gdb) break arm_fir_init_f32
Breakpoint 2 at 0x3a0: file arm_fir_f32.c, line 58.

(gdb) break arm_fir_f32
Breakpoint 3 at 0x3dc: file arm_fir_f32.c, line 128.

# æŸ¥çœ‹ä¸­æ–·é»
(gdb) info breakpoints
Num     Type           Disp Enb Address    What
1       breakpoint     keep y   0x00000130 in main at arm_fir_example_f32.c:203
2       breakpoint     keep y   0x000003a0 in arm_fir_init_f32 at arm_fir_f32.c:58
3       breakpoint     keep y   0x000003dc in arm_fir_f32 at arm_fir_f32.c:128
```

#### Step 3: åŸ·è¡Œåˆ° main

```gdb
(gdb) continue
Continuing.

Breakpoint 1, main () at arm_fir_example_f32.c:203
203       uint32_t i;
(gdb) list
198     int32_t main(void)
199     {
200       uint32_t i;
201       arm_fir_instance_f32 S;
202       arm_status status;
203       float32_t  *inputF32, *outputF32;
204
205       /* Initialize input and output buffer pointers */
206       inputF32 = &testInput_f32_1kHz_15kHz[0];
207       outputF32 = &testOutput[0];
```

#### Step 4: æª¢æŸ¥åˆå§‹åŒ–

```gdb
# å–®æ­¥åŸ·è¡Œåˆ°åˆå§‹åŒ–
(gdb) until 214
main () at arm_fir_example_f32.c:214
214       arm_fir_init_f32(&S, NUM_TAPS, (float32_t *)&firCoeffs32[0], &firStateF32[0], blockSize);

# æŸ¥çœ‹åƒæ•¸
(gdb) print NUM_TAPS
$1 = 29

(gdb) print blockSize
$2 = 32

(gdb) print firCoeffs32[0]
$3 = -0.00182252295

(gdb) print firCoeffs32[28]
$4 = -0.00182252295    # å°ç¨±ï¼âœ“

# é€²å…¥ arm_fir_init_f32
(gdb) step

Breakpoint 2, arm_fir_init_f32 (S=0x200014f0 <S>, numTaps=29,
    pCoeffs=0x20000008 <firCoeffs32>, pState=0x200014f0 <firStateF32>,
    blockSize=32) at arm_fir_f32.c:58
58        S->numTaps = numTaps;

# æŸ¥çœ‹çµæ§‹é«”åˆå§‹åŒ–éç¨‹
(gdb) next
59        S->pState = pState;
(gdb) next
60        S->pCoeffs = pCoeffs;
(gdb) next
61      }

# æª¢æŸ¥çµæ§‹é«”æ˜¯å¦æ­£ç¢ºåˆå§‹åŒ–
(gdb) print S
$5 = (arm_fir_instance_f32 *) 0x200014f0 <S>

(gdb) print *S
$6 = {numTaps = 29, pState = 0x200014f0 <firStateF32>, pCoeffs = 0x20000008 <firCoeffs32>}

# âœ“ åˆå§‹åŒ–æ­£ç¢ºï¼
```

#### Step 5: ç›£è¦–æ¿¾æ³¢éç¨‹

```gdb
# ç¹¼çºŒåˆ° arm_fir_f32
(gdb) continue
Continuing.

Breakpoint 3, arm_fir_f32 (S=0x200014f0 <S>, pSrc=0x20000b30 <testInput_f32_1kHz_15kHz>,
    pDst=0x20001030 <testOutput>, blockSize=32) at arm_fir_f32.c:128
128       float32_t *pState = S->pState;

# æŸ¥çœ‹è¼¸å…¥è³‡æ–™
(gdb) print pSrc[0]
$7 = 0

(gdb) print pSrc[1]
$8 = 0.0500000007

(gdb) print pSrc[2]
$9 = 0.0999999866

# æŸ¥çœ‹å‰ 10 å€‹è¼¸å…¥æ¨£æœ¬
(gdb) x/10f pSrc
0x20000b30 <testInput_f32_1kHz_15kHz>:      0       0.0500000007    0.0999999866    0.150000006
0x20000b40 <testInput_f32_1kHz_15kHz+16>:   0.199999988     0.25    0.300000012     0.349999994
0x20000b50 <testInput_f32_1kHz_15kHz+32>:   0.400000006     0.449999988

# è¨­å®šç›£è¦–é»ï¼šè§€å¯Ÿç¬¬ä¸€å€‹è¼¸å‡º
(gdb) watch pDst[0]
Hardware watchpoint 4: pDst[0]

# ç¹¼çºŒåŸ·è¡Œ
(gdb) continue
Continuing.

Hardware watchpoint 4: pDst[0]

Old value = 0
New value = 0.000485612487
0x00000410 in arm_fir_f32 (S=0x200014f0 <S>, pSrc=0x20000b30 <testInput_f32_1kHz_15kHz>,
    pDst=0x20001030 <testOutput>, blockSize=32) at arm_fir_f32.c:168
168           pDst++;

# âœ“ ç¬¬ä¸€å€‹è¼¸å‡ºå€¼å·²è¨ˆç®—ï¼
```

#### Step 6: æª¢æŸ¥ SNR è¨ˆç®—

```gdb
# åˆªé™¤ç›£è¦–é» (é¿å…è§¸ç™¼å¤ªå¤šæ¬¡)
(gdb) delete 4

# è·³åˆ° SNR è¨ˆç®—
(gdb) break arm_snr_f32
Breakpoint 5 at 0x5a0: file arm_snr_f32.c, line 48.

(gdb) continue
Continuing.

Breakpoint 5, arm_snr_f32 (pRef=0x20000330 <refOutput>, pTest=0x20001030 <testOutput>,
    buffSize=320) at arm_snr_f32.c:48
48        float32_t EnergySignal = 0.0, EnergyError = 0.0;

# å–®æ­¥åŸ·è¡Œ SNR è¨ˆç®—
(gdb) next
49        uint32_t i;
(gdb) next
50        float32_t SNR;

# ... åŸ·è¡Œåˆ°è¨ˆç®—çµæœ
(gdb) until 67
67        return (SNR);

# æŸ¥çœ‹ SNR å€¼
(gdb) print SNR
$10 = 142.524826

# æŸ¥çœ‹é–€æª»å€¼
(gdb) frame 1
#1  0x00000156 in main () at arm_fir_example_f32.c:230
230       snr = arm_snr_f32(&refOutput[0], &testOutput[0], TEST_LENGTH_SAMPLES);

(gdb) print SNR_THRESHOLD_F32
$11 = 140

# âœ“ SNR (142.5) > é–€æª»å€¼ (140)ï¼Œæ¸¬è©¦æ‡‰è©²é€šéï¼
```

#### Step 7: æª¢æŸ¥æ¸¬è©¦çµæœ

```gdb
(gdb) continue
Continuing.

# ç¨‹å¼æ‡‰è©²æœƒè¼¸å‡º "GOOD" ç„¶å¾Œé€²å…¥ç„¡çª®è¿´åœˆ
# å¯ä»¥æŒ‰ Ctrl+C ä¸­æ–·

Program received signal SIGINT, Interrupt.
0x0000016a in main () at arm_fir_example_f32.c:253
253       while(1);

(gdb) backtrace
#0  0x0000016a in main () at arm_fir_example_f32.c:253

# æŸ¥çœ‹ status
(gdb) print status
$12 = ARM_MATH_SUCCESS    # âœ“ æˆåŠŸï¼

# æª¢æŸ¥ UART è¼¸å‡º (æ‡‰è©²çœ‹åˆ° "GOOD")
```

#### Step 8: æ¸…ç†

```gdb
# é€€å‡º GDB
(gdb) quit
A debugging session is active.

        Inferior 1 [Remote target] will be detached.

Quit anyway? (y or n) y
Detaching from program: /work/examples/arm_fir_example/gcc/arm_fir_example_f32.axf, Remote target
```

**çµ‚ç«¯ 1** (åœæ­¢ QEMU):

```bash
docker stop qemu_gdb_server
```

---

## 6. GDB è…³æœ¬è‡ªå‹•åŒ–

### ç‚ºä»€éº¼éœ€è¦ GDB è…³æœ¬ï¼Ÿ

**å•é¡Œ**: æ¯æ¬¡é™¤éŒ¯éƒ½è¦æ‰‹å‹•è¼¸å…¥ä¸€å¤§å †å‘½ä»¤...

```gdb
(gdb) target remote localhost:1234
(gdb) break main
(gdb) break arm_fir_f32
(gdb) continue
(gdb) info registers
(gdb) continue
(gdb) backtrace
(gdb) ...
(gdb) ...
(gdb) ... (è¼¸å…¥åˆ°æ‰‹é…¸ï¼)
```

**è§£æ±ºæ–¹æ¡ˆ**: å¯«æˆè…³æœ¬ï¼Œä¸€éµåŸ·è¡Œï¼

### åŸºæœ¬è…³æœ¬ç¯„ä¾‹

**æª”æ¡ˆ**: `test_gdb.gdb`

```gdb
# æ¸¬è©¦ GDB é€£æ¥è…³æœ¬
set pagination off        # é—œé–‰åˆ†é 
set confirm off           # é—œé–‰ç¢ºèªè¨Šæ¯

echo \n=== é€£æ¥åˆ° QEMU GDB Server ===\n
target remote localhost:1234

echo \n=== è¨­å®šä¸­æ–·é» ===\n
break main
info breakpoints

echo \n=== ç¹¼çºŒåŸ·è¡Œåˆ° main ===\n
continue

echo \n=== é¡¯ç¤ºç•¶å‰ä½ç½® ===\n
where
list

echo \n=== é¡¯ç¤ºå€åŸŸè®Šæ•¸ ===\n
info locals

echo \n=== å–®æ­¥åŸ·è¡Œ 3 æ­¥ ===\n
next
next
next

echo \n=== å†æ¬¡é¡¯ç¤ºä½ç½® ===\n
where

echo \n=== GDB æ¸¬è©¦æˆåŠŸï¼ ===\n
quit
```

**ä½¿ç”¨æ–¹å¼**:

```bash
# æ–¹å¼ 1: åœ¨ GDB å…§åŸ·è¡Œ
(gdb) source test_gdb.gdb

# æ–¹å¼ 2: å•Ÿå‹•æ™‚åŸ·è¡Œ
gdb-multiarch -x test_gdb.gdb arm_fir_example_f32.axf

# æ–¹å¼ 3: Batch mode (éäº’å‹•å¼)
gdb-multiarch -batch -x test_gdb.gdb arm_fir_example_f32.axf
```

### è©³ç´°æ¸¬è©¦è…³æœ¬

**æª”æ¡ˆ**: `test_detailed_gdb.gdb`

```gdb
# è©³ç´°æ¸¬è©¦ GDB åŠŸèƒ½
set pagination off
set confirm off

echo \n========================================\n
echo   æ¸¬è©¦ GDB é™¤éŒ¯åŠŸèƒ½\n
echo ========================================\n

# é€£æ¥
target remote localhost:1234
echo âœ“ æˆåŠŸé€£æ¥åˆ° QEMU\n

# è¨­å®šå¤šå€‹ä¸­æ–·é»
echo \n--- è¨­å®šä¸­æ–·é» ---\n
break main
break arm_fir_init_f32
break arm_fir_f32
info breakpoints

# åŸ·è¡Œåˆ° main
echo \n--- åŸ·è¡Œåˆ° main() ---\n
continue
info registers r0 r1 r2 r3

# åŸ·è¡Œåˆ° arm_fir_init_f32
echo \n--- åŸ·è¡Œåˆ° arm_fir_init_f32() ---\n
continue
info args
backtrace

# åŸ·è¡Œåˆ° arm_fir_f32
echo \n--- åŸ·è¡Œåˆ° arm_fir_f32() ---\n
continue
info args
backtrace

# æª¢æŸ¥è¨˜æ†¶é«”
echo \n--- æª¢æŸ¥è¨˜æ†¶é«” ---\n
x/4x $sp
x/4x $pc

# æª¢æŸ¥æš«å­˜å™¨
echo \n--- æš«å­˜å™¨ç‹€æ…‹ ---\n
info registers

echo \n========================================\n
echo   æ‰€æœ‰æ¸¬è©¦å®Œæˆï¼\n
echo ========================================\n

quit
```

### è‡ªè¨‚å‘½ä»¤

GDB å…è¨±å®šç¾©è‡ªè¨‚å‘½ä»¤ï¼š

```gdb
# å®šç¾©è‡ªè¨‚å‘½ä»¤: é¡¯ç¤º FIR çµæ§‹é«”è³‡è¨Š
define show_fir
    echo \n=== FIR Instance Info ===\n
    print $arg0->numTaps
    print $arg0->pState
    print $arg0->pCoeffs
    echo \n=== First 5 Coefficients ===\n
    x/5f $arg0->pCoeffs
    echo \n=== First 5 State Values ===\n
    x/5f $arg0->pState
end

document show_fir
Display FIR filter instance information
Usage: show_fir <fir_instance_pointer>
Example: show_fir &S
end

# ä½¿ç”¨:
(gdb) show_fir &S
```

### å®Œæ•´è‡ªå‹•åŒ–æ¸¬è©¦è…³æœ¬

```gdb
# full_test.gdb - å®Œæ•´ FIR æ¸¬è©¦è…³æœ¬

set pagination off
set confirm off
set print pretty on

# ===== é€£æ¥ =====
target remote localhost:1234

# ===== å®šç¾©è‡ªè¨‚å‘½ä»¤ =====
define show_fir
    printf "numTaps:  %d\n", $arg0->numTaps
    printf "pState:   %p\n", $arg0->pState
    printf "pCoeffs:  %p\n", $arg0->pCoeffs
end

# ===== ä¸»æ¸¬è©¦æµç¨‹ =====
echo \n========== FIR Filter Test ==========\n

# 1. æ¸¬è©¦åˆå§‹åŒ–
echo \n[1/4] Testing FIR Initialization...\n
break arm_fir_init_f32
continue
show_fir S
continue

echo âœ“ Initialization complete\n

# 2. æ¸¬è©¦ç¬¬ä¸€æ¬¡æ¿¾æ³¢
echo \n[2/4] Testing First Filter Iteration...\n
break arm_fir_f32
continue
info args
x/4f pSrc
continue

echo âœ“ First iteration complete\n

# 3. æ¸¬è©¦ SNR è¨ˆç®—
echo \n[3/4] Testing SNR Calculation...\n
break arm_snr_f32
continue
info args
finish
print $retval
continue

echo âœ“ SNR calculation complete\n

# 4. æª¢æŸ¥æœ€çµ‚çµæœ
echo \n[4/4] Checking Final Result...\n
print status
print snr

if status == 0
    echo âœ“âœ“âœ“ TEST PASSED âœ“âœ“âœ“\n
else
    echo âœ—âœ—âœ— TEST FAILED âœ—âœ—âœ—\n
end

echo \n========== Test Complete ==========\n

quit
```

---

## 7. é€²éšé™¤éŒ¯æŠ€å·§

### æŠ€å·§ 1: æ¢ä»¶ä¸­æ–·é» - åªåœ¨ç‰¹å®šæƒ…æ³ä¸‹ä¸­æ–·

**å ´æ™¯**: è¿´åœˆåŸ·è¡Œ 1000 æ¬¡ï¼Œåªæƒ³åœ¨ç¬¬ 999 æ¬¡æ™‚ä¸­æ–·

```c
for(int i = 0; i < 1000; i++) {
    process(i);    // åªæƒ³åœ¨ i == 999 æ™‚ä¸­æ–·
}
```

**å‚³çµ±æ–¹å¼** (è¶…ç´šæ…¢ï¼):

```gdb
(gdb) break process
(gdb) continue
... æŒ‰ 999 æ¬¡ continue ... (æ‰‹æŒ‡æ–·æ‰ï¼)
```

**GDB æ–¹å¼**:

```gdb
# æ–¹æ³• 1: è¨­å®šæ¢ä»¶ä¸­æ–·é»
(gdb) break process if i == 999
Breakpoint 1 at 0x200: file test.c, line 10.
(gdb) continue
... ç›´æ¥è·³åˆ° i == 999ï¼

# æ–¹æ³• 2: å…ˆè¨­ä¸­æ–·é»ï¼Œå†åŠ æ¢ä»¶
(gdb) break process
Breakpoint 2 at 0x200
(gdb) condition 2 i == 999    # ç‚ºä¸­æ–·é» 2 æ·»åŠ æ¢ä»¶
(gdb) continue

# æ–¹æ³• 3: è¤‡é›œæ¢ä»¶
(gdb) break process if i > 990 && i % 2 == 0
# åªåœ¨ i > 990 ä¸” i ç‚ºå¶æ•¸æ™‚ä¸­æ–·
```

### æŠ€å·§ 2: å¿½ç•¥ä¸­æ–·é» - è·³éå‰ N æ¬¡

```gdb
# è¨­å®šä¸­æ–·é»
(gdb) break process
Breakpoint 1 at 0x200

# å¿½ç•¥å‰ 998 æ¬¡ï¼Œåªåœ¨ç¬¬ 999 æ¬¡ä¸­æ–·
(gdb) ignore 1 998
Will ignore next 998 crossings of breakpoint 1.

(gdb) continue
... ç›´æ¥è·³åˆ°ç¬¬ 999 æ¬¡ï¼
```

### æŠ€å·§ 3: ç›£è¦–é» - æ‰¾å‡ºèª°æ”¹äº†è®Šæ•¸

**å ´æ™¯**: å…¨åŸŸè®Šæ•¸è¢«è«åå…¶å¦™ä¿®æ”¹ï¼Œä¸çŸ¥é“åœ¨å“ªè£¡

```c
int global_counter = 0;

void func1() { /* ... */ }
void func2() { /* ... */ }
void func3() { global_counter = 999; }    // å…‡æ‰‹ï¼
void func4() { /* ... */ }

int main() {
    func1();
    func2();
    func3();
    func4();
    // global_counter è¢«æ”¹äº†ï¼Œä½†ä¸çŸ¥é“åœ¨å“ªï¼
}
```

**GDB æ–¹å¼**:

```gdb
# è¨­å®šç›£è¦–é»
(gdb) watch global_counter
Hardware watchpoint 1: global_counter

(gdb) continue
Continuing.

Hardware watchpoint 1: global_counter

Old value = 0
New value = 999
func3 () at test.c:15    â† æŠ“åˆ°å…‡æ‰‹ï¼
15        global_counter = 999;
```

### æŠ€å·§ 4: åå‘é™¤éŒ¯ - æ™‚å…‰å€’æµ

**æ³¨æ„**: QEMU ç›®å‰å° ARM çš„ reverse debugging æ”¯æ´æœ‰é™ï¼Œé€™è£¡æ˜¯æ¦‚å¿µä»‹ç´¹ã€‚

```gdb
# å•Ÿå‹•è¨˜éŒ„æ¨¡å¼ (éœ€è¦ GDB 7.0+)
(gdb) target record-full

# æ­£å¸¸åŸ·è¡Œ
(gdb) continue
... ç¨‹å¼åŸ·è¡Œåˆ°æŸè™•

# åå‘åŸ·è¡Œï¼
(gdb) reverse-continue    # å¾€å›åŸ·è¡Œåˆ°ä¸Šä¸€å€‹ä¸­æ–·é»
(gdb) reverse-next        # å¾€å›å–®æ­¥åŸ·è¡Œ
(gdb) reverse-step        # å¾€å›é€²å…¥å‡½å¼

# ç¯„ä¾‹å ´æ™¯: è®Šæ•¸è¢«ç ´å£
(gdb) print buffer[10]
$1 = 12345     # éŒ¯èª¤çš„å€¼

# è¨­å®šç›£è¦–é»ä¸¦åå‘åŸ·è¡Œ
(gdb) watch buffer[10]
(gdb) reverse-continue
... å›åˆ°è®Šæ•¸è¢«ä¿®æ”¹çš„é‚£ä¸€åˆ»ï¼
```

### æŠ€å·§ 5: å‘¼å«å‡½å¼ - åœ¨é™¤éŒ¯æ™‚åŸ·è¡Œç¨‹å¼ç¢¼

```gdb
# å‘¼å«å‡½å¼
(gdb) call printf("Debug: counter = %d\n", counter)
Debug: counter = 42

# å‘¼å«è‡ªè¨‚å‡½å¼
(gdb) call init_uart()
(gdb) call send_debug_info()

# åˆ†é…è¨˜æ†¶é«”
(gdb) call malloc(100)
$1 = (void *) 0x20001000

# è¤‡è£½è¨˜æ†¶é«”
(gdb) call memcpy(dest, src, 100)
```

### æŠ€å·§ 6: ä¿®æ”¹ç¨‹å¼æµç¨‹ - å¼·åˆ¶è·³è½‰

```c
void test() {
    if (check_license()) {    // æˆæ¬Šæª¢æŸ¥
        run_feature();        // æƒ³è¦åŸ·è¡Œé€™å€‹
    } else {
        print_error();        // ç›®å‰æœƒè·‘åˆ°é€™è£¡
    }
}
```

**GDB æ–¹å¼** (ç¹éæˆæ¬Šæª¢æŸ¥):

```gdb
# è¨­ä¸­æ–·é»
(gdb) break test
(gdb) continue

Breakpoint 1, test () at test.c:10
10        if (check_license()) {

# æŸ¥çœ‹åçµ„è­¯
(gdb) disassemble
...
0x200 <+0>:  bl   check_license
0x204 <+4>:  cmp  r0, #0
0x208 <+8>:  beq  0x220 <test+32>     â† è·³åˆ° print_error
0x20c <+12>: bl   run_feature
...

# æ–¹æ³• 1: ä¿®æ”¹è¿”å›å€¼
(gdb) call check_license()
$1 = 0    # è¿”å› false
(gdb) set $r0 = 1    # å¼·åˆ¶è¨­ç‚º true
(gdb) next
... ç¾åœ¨æœƒåŸ·è¡Œ run_feature()ï¼

# æ–¹æ³• 2: ç›´æ¥è·³è½‰
(gdb) set $pc = 0x20c
... ç›´æ¥è·³åˆ° run_feature()ï¼
```

### æŠ€å·§ 7: Core Dump åˆ†æ

ç•¶ç¨‹å¼å´©æ½°æ™‚ï¼ŒGDB å¯ä»¥åˆ†æ Core Dumpï¼š

```bash
# ç”¢ç”Ÿ Core Dump (å¯¦é«” Linux ç³»çµ±)
ulimit -c unlimited
./program
... ç¨‹å¼å´©æ½° â†’ ç”¢ç”Ÿ core æª”æ¡ˆ

# ä½¿ç”¨ GDB åˆ†æ
gdb program core

# æŸ¥çœ‹å´©æ½°æ™‚çš„ç‹€æ…‹
(gdb) backtrace
#0  0x00000200 in bad_function () at test.c:45
#1  0x00000150 in main () at test.c:10

(gdb) frame 0
(gdb) print *ptr    # æŸ¥çœ‹å°è‡´å´©æ½°çš„æŒ‡æ¨™
```

---

## 8. å¸¸è¦‹åµŒå…¥å¼ Bug çš„ GDB é™¤éŒ¯ç­–ç•¥

### Bug é¡å‹ 1: å †ç–Šæº¢ä½ (Stack Overflow)

**ç—‡ç‹€**:
- ç¨‹å¼éš¨æ©Ÿå´©æ½°
- å€åŸŸè®Šæ•¸å€¼è«åå…¶å¦™æ”¹è®Š
- å‡½å¼è¿”å›åˆ°éŒ¯èª¤çš„ä½å€

**GDB é™¤éŒ¯ç­–ç•¥**:

```gdb
# 1. æª¢æŸ¥ SP æ˜¯å¦è¶…å‡ºç¯„åœ
(gdb) print $sp
$1 = (void *) 0x20000010    # SP å¤ªä½ï¼æ‡‰è©²åœ¨ 0x20010000 é™„è¿‘

# 2. è¨­å®šç›£è¦–é»ç›£æ§ SP
(gdb) watch $sp if $sp < 0x20000100
# ç•¶ SP ä½æ–¼å®‰å…¨å€¼æ™‚ä¸­æ–·

# 3. æª¢æŸ¥å‘¼å«å †ç–Šæ·±åº¦
(gdb) backtrace
#0  func1 ()
#1  func2 ()
#2  func3 ()
...
#98  func99 ()    # éè¿´å¤ªæ·±ï¼
#99  func100 ()

# 4. æŸ¥çœ‹å †ç–Šä½¿ç”¨é‡
(gdb) print (unsigned int)(&__stack_top__ - $sp)
$2 = 65000    # å·²ä½¿ç”¨ 65000 bytesï¼Œå¤ªå¤šäº†ï¼
```

### Bug é¡å‹ 2: é‡æŒ‡æ¨™ (Wild Pointer)

**ç—‡ç‹€**:
- ç¨‹å¼å­˜å–éæ³•è¨˜æ†¶é«”
- HardFault ç•°å¸¸

**GDB é™¤éŒ¯ç­–ç•¥**:

```gdb
# 1. æª¢æŸ¥æŒ‡æ¨™å€¼
(gdb) print ptr
$1 = (char *) 0x12345678    # æ˜é¡¯éŒ¯èª¤çš„ä½å€ï¼

# 2. è¨­å®šç›£è¦–é»
(gdb) watch ptr
# æ‰¾å‡ºæ˜¯èª°ä¿®æ”¹äº†æŒ‡æ¨™

# 3. æª¢æŸ¥è¨˜æ†¶é«”æ˜¯å¦æœ‰æ•ˆ
(gdb) x/x ptr
Cannot access memory at address 0x12345678    # ç„¡æ•ˆä½å€ï¼

# 4. æª¢æŸ¥æŒ‡æ¨™åˆå§‹åŒ–
(gdb) break func
(gdb) continue
(gdb) print ptr
$2 = (char *) 0x0    # æœªåˆå§‹åŒ–ï¼(NULL)
```

### Bug é¡å‹ 3: è¨˜æ†¶é«”è¦†å¯« (Memory Corruption)

**ç—‡ç‹€**:
- é™£åˆ—è¶Šç•Œ
- ç·©è¡å€æº¢ä½
- è®Šæ•¸è¢«è¦†å¯«

**GDB é™¤éŒ¯ç­–ç•¥**:

```gdb
# 1. è¨­å®šç›£è¦–é»
(gdb) watch -l buffer[100]    # ç›£è¦–é™£åˆ—é‚Šç•Œ
Hardware watchpoint 1: -location buffer[100]

(gdb) continue

Watchpoint 1: -location buffer[100]

Old value = 0
New value = 999
strcpy () at string.c:45    â† æ‰¾åˆ°äº†ï¼strcpy è¶Šç•Œ

# 2. æª¢æŸ¥è¨˜æ†¶é«”è¦†å¯«æ¨¡å¼
(gdb) x/100x buffer
0x20000000: 0x41414141 0x41414141 0x41414141 ...
# çœ‹åˆ°é‡è¤‡çš„ 0x41 ('A')ï¼Œå¯èƒ½æ˜¯ buffer overflow

# 3. ä½¿ç”¨ GDB çš„ memory tag (ARM v8.5+ æ”¯æ´)
(gdb) memory-tag print-allocation-tag buffer
# æª¢æŸ¥è¨˜æ†¶é«”æ¨™ç±¤æ˜¯å¦è¢«ç ´å£
```

### Bug é¡å‹ 4: ç«¶æ…‹æ¢ä»¶ (Race Condition)

**ç—‡ç‹€**:
- Bug ä¸ç©©å®šï¼Œæœ‰æ™‚å‡ºç¾æœ‰æ™‚ä¸å‡ºç¾
- åŠ å…¥ printf å¾Œ Bug æ¶ˆå¤± (Heisenbug)

**GDB é™¤éŒ¯ç­–ç•¥**:

```gdb
# 1. æª¢æŸ¥ä¸­æ–·å„ªå…ˆæ¬Š
(gdb) x/x 0xE000E400    # NVIC IPR0 (ä¸­æ–·å„ªå…ˆæ¬Š)

# 2. åœ¨è‡¨ç•Œå€è¨­ä¸­æ–·é»
(gdb) break critical_section_entry
(gdb) commands
> info threads    # é¡¯ç¤ºæ‰€æœ‰åŸ·è¡Œç·’/ä¸­æ–·ç‹€æ…‹
> continue
> end

# 3. æª¢æŸ¥å…±ç”¨è®Šæ•¸
(gdb) watch shared_variable
# è§€å¯Ÿå“ªäº›ä¸­æ–·/ä»»å‹™ä¿®æ”¹äº†è®Šæ•¸

# 4. æš«æ™‚åœç”¨ä¸­æ–·
(gdb) set {int}0xE000ED04 = 0x05FA0001    # AIRCR: SYSRESETREQ
# é‡ç½®ç³»çµ±ä¾†é‡ç¾ Bug
```

---

## 9. GDB èˆ‡ RTOS çš„æ•´åˆ

### FreeRTOS æ„ŸçŸ¥é™¤éŒ¯

GDB å¯ä»¥å®‰è£ RTOS å¤–æ›ä¾†ç†è§£ä»»å‹™ï¼š

```gdb
# è¼‰å…¥ FreeRTOS å¤–æ›
(gdb) source ~/FreeRTOS-GDB.py

# æŸ¥çœ‹æ‰€æœ‰ä»»å‹™
(gdb) info threads
  Id   Target Id         Frame
* 1    Thread 1 (idle)   vTaskDelay () at tasks.c:1234
  2    Thread 2 (sensor) read_sensor () at sensor.c:45
  3    Thread 3 (ctrl)   control_loop () at control.c:67

# åˆ‡æ›åˆ°ç‰¹å®šä»»å‹™
(gdb) thread 2
[Switching to thread 2 (Thread 2)]

# æŸ¥çœ‹ä»»å‹™å †ç–Š
(gdb) backtrace
#0  read_sensor () at sensor.c:45
#1  sensor_task () at sensor.c:100
#2  vTaskCode () at tasks.c:200

# æŸ¥çœ‹ä»»å‹™å„ªå…ˆæ¬Š
(gdb) print current_task->uxPriority
$1 = 3
```

---

## ğŸ“ å¯¦ä½œç·´ç¿’

### ç·´ç¿’ 1: åŸºæœ¬é™¤éŒ¯æµç¨‹ (ç°¡å–®)

**ç›®æ¨™**: ç†Ÿæ‚‰ GDB åŸºæœ¬æ“ä½œ

```bash
# Step 1: å•Ÿå‹• QEMU
docker run --rm -d \
    -v /home/sbplab/jiawei/qemu/CMSIS_LM3S:/work:ro \
    -p 1234:1234 \
    --name qemu_gdb_server \
    cmsis-lm3s-qemu:latest \
    bash -c "cd /work/examples/uart_hello_world/gcc && \
             exec qemu-system-arm -M lm3s6965evb -nographic \
                  -kernel uart_hello_world.bin -s -S"

# Step 2: å•Ÿå‹• GDB
docker run --rm -it \
    -v /home/sbplab/jiawei/qemu/CMSIS_LM3S:/work:ro \
    --network host \
    cmsis-lm3s-gdb:latest \
    bash -c "cd /work/examples/uart_hello_world/gcc && \
             gdb-multiarch uart_hello_world.axf"

# Step 3: åœ¨ GDB ä¸­åŸ·è¡Œ
(gdb) target remote localhost:1234
(gdb) break main
(gdb) continue
(gdb) list
(gdb) next
(gdb) print counter
(gdb) quit

# Step 4: æ¸…ç†
docker stop qemu_gdb_server
```

<details>
<summary>ğŸ’¡ é»æ“ŠæŸ¥çœ‹è©³ç´°èªªæ˜</summary>

**é æœŸè¼¸å‡º**:

```gdb
(gdb) target remote localhost:1234
Remote debugging using localhost:1234
0x00000000 in ?? ()

(gdb) break main
Breakpoint 1 at 0x...: file uart_hello_world.c, line ...

(gdb) continue
Continuing.

Breakpoint 1, main () at uart_hello_world.c:...
...    int counter = 0;

(gdb) list
...    int counter = 0;
...    char *message = "Hello, UART World!";
...    while(1) {
...        print_uart0(message);
...        counter++;
...    }

(gdb) next
...    char *message = "Hello, UART World!";

(gdb) print counter
$1 = 0
```

**å¦‚æœé€£æ¥å¤±æ•—**:

```bash
# æª¢æŸ¥ QEMU æ˜¯å¦åœ¨åŸ·è¡Œ
docker ps | grep qemu_gdb_server

# æª¢æŸ¥ port 1234
netstat -tuln | grep 1234
```

</details>

---

### ç·´ç¿’ 2: ä½¿ç”¨ç›£è¦–é»æ‰¾å‡ºè®Šæ•¸ä¿®æ”¹ä½ç½® (ä¸­ç­‰)

**ç›®æ¨™**: ä½¿ç”¨ watchpoint æ‰¾å‡ºèª°ä¿®æ”¹äº†è®Šæ•¸

**æº–å‚™å·¥ä½œ**: å‡è¨­ä½ ä¿®æ”¹äº† UART ç¯„ä¾‹ï¼ŒåŠ å…¥ä¸€å€‹æœƒè¢«æ„å¤–ä¿®æ”¹çš„è®Šæ•¸ï¼š

```c
// uart_hello_world.c
int mysterious_variable = 100;

void bug_function() {
    int buffer[10];
    for(int i = 0; i <= 10; i++) {    // Bug: æ‡‰è©²æ˜¯ i < 10
        buffer[i] = i;
    }
}

int main() {
    bug_function();    // é€™æœƒè¦†å¯« mysterious_variable
    // ... å¾ŒçºŒç™¼ç¾ mysterious_variable è¢«æ”¹äº†ï¼
}
```

**é™¤éŒ¯æ­¥é©Ÿ**:

```gdb
(gdb) target remote localhost:1234
(gdb) break main
(gdb) continue

(gdb) print &mysterious_variable    # æŸ¥çœ‹ä½å€
$1 = (int *) 0x20000104

(gdb) watch mysterious_variable
Hardware watchpoint 2: mysterious_variable

(gdb) continue
Hardware watchpoint 2: mysterious_variable

Old value = 100
New value = 10
bug_function () at uart_hello_world.c:15    â† æ‰¾åˆ°äº†ï¼
15            buffer[i] = i;

(gdb) print i
$2 = 10    # i == 10 æ™‚è¶Šç•Œäº†ï¼
```

<details>
<summary>ğŸ’¡ é»æ“ŠæŸ¥çœ‹è§£æ±ºæ–¹æ¡ˆ</summary>

**å•é¡Œ**: é™£åˆ— `buffer[10]` åªæœ‰ 10 å€‹å…ƒç´  (ç´¢å¼• 0-9)ï¼Œä½†è¿´åœˆè·‘åˆ° `i = 10`ï¼Œå¯«å…¥äº† `buffer[10]`ï¼Œé€™è¶…å‡ºäº†é™£åˆ—ç¯„åœï¼Œè¦†å¯«åˆ°äº† `mysterious_variable`ã€‚

**ä¿®å¾©**:

```c
for(int i = 0; i < 10; i++) {    // ä¿®æ­£: i < 10
    buffer[i] = i;
}
```

**å»¶ä¼¸**: æŸ¥çœ‹è¨˜æ†¶é«”ä½ˆå±€

```gdb
(gdb) print &buffer
$3 = (int (*)[10]) 0x20000100

(gdb) print &mysterious_variable
$4 = (int *) 0x20000128

# buffer[10] çš„ä½å€
(gdb) print &buffer[10]
$5 = (int *) 0x20000128    # å’Œ mysterious_variable ä¸€æ¨£ï¼

# è¦–è¦ºåŒ–è¨˜æ†¶é«”
(gdb) x/12xw &buffer
0x20000100:  0x00000000  0x00000001  0x00000002  0x00000003
0x20000110:  0x00000004  0x00000005  0x00000006  0x00000007
0x20000120:  0x00000008  0x00000009  0x0000000a  â† é€™å€‹è¦†å¯«äº† mysterious_variable!
```

</details>

---

### ç·´ç¿’ 3: ç·¨å¯« GDB è‡ªå‹•åŒ–æ¸¬è©¦è…³æœ¬ (ä¸­ç­‰)

**ç›®æ¨™**: è‡ªå‹•æ¸¬è©¦ FIR æ¿¾æ³¢å™¨ä¸¦é©—è­‰çµæœ

**å»ºç«‹è…³æœ¬**: `my_fir_test.gdb`

```gdb
# å®Œæˆä»¥ä¸‹è…³æœ¬ï¼ˆå¡«ç©ºï¼‰
set pagination off
set confirm off

echo \n========== My FIR Test Script ==========\n

# TODO: é€£æ¥åˆ° QEMU
target remote _______________

# TODO: åœ¨ main è¨­ä¸­æ–·é»
break _______________

# TODO: åœ¨ arm_fir_f32 è¨­ä¸­æ–·é»
break _______________

# TODO: åŸ·è¡Œåˆ° main
_______________

# TODO: é¡¯ç¤ºè¼¸å…¥æŒ‡æ¨™
echo \nInput pointer: \n
print _______________

# TODO: ç¹¼çºŒåˆ° arm_fir_f32
_______________

# TODO: é¡¯ç¤º FIR çµæ§‹é«”
echo \nFIR Structure:\n
print _______________

# TODO: æŸ¥çœ‹å‰ 5 å€‹ä¿‚æ•¸
echo \nFirst 5 coefficients:\n
x/5f _______________

# TODO: ç¹¼çºŒåŸ·è¡Œåˆ°ç¨‹å¼çµæŸ
_______________

# TODO: æª¢æŸ¥ SNR å€¼
echo \nSNR Value:\n
print _______________

# TODO: æª¢æŸ¥ status
echo \nTest Status:\n
print _______________

echo \n========== Test Complete ==========\n
quit
```

<details>
<summary>ğŸ’¡ é»æ“ŠæŸ¥çœ‹è§£ç­”</summary>

```gdb
set pagination off
set confirm off

echo \n========== My FIR Test Script ==========\n

# é€£æ¥åˆ° QEMU
target remote localhost:1234

# åœ¨ main è¨­ä¸­æ–·é»
break main

# åœ¨ arm_fir_f32 è¨­ä¸­æ–·é»
break arm_fir_f32

# åŸ·è¡Œåˆ° main
continue

# é¡¯ç¤ºè¼¸å…¥æŒ‡æ¨™
echo \nInput pointer: \n
print inputF32

# ç¹¼çºŒåˆ° arm_fir_f32
continue

# é¡¯ç¤º FIR çµæ§‹é«”
echo \nFIR Structure:\n
print S

# æŸ¥çœ‹å‰ 5 å€‹ä¿‚æ•¸
echo \nFirst 5 coefficients:\n
x/5f S.pCoeffs

# ç¹¼çºŒåŸ·è¡Œåˆ°ç¨‹å¼çµæŸ
continue

# æª¢æŸ¥ SNR å€¼
echo \nSNR Value:\n
print snr

# æª¢æŸ¥ status
echo \nTest Status:\n
print status

echo \n========== Test Complete ==========\n
quit
```

**ä½¿ç”¨æ–¹å¼**:

```bash
# å•Ÿå‹• QEMU
docker run --rm -d \
    -v /home/sbplab/jiawei/qemu/CMSIS_LM3S:/work:ro \
    -p 1234:1234 \
    --name qemu_gdb_server \
    cmsis-lm3s-qemu:latest \
    bash -c "cd /work/examples/arm_fir_example/gcc && \
             exec qemu-system-arm -M lm3s6965evb -nographic \
                  -kernel arm_fir_example_f32.bin -s -S"

# åŸ·è¡Œè…³æœ¬
docker run --rm -it \
    -v /home/sbplab/jiawei/qemu/CMSIS_LM3S:/work:ro \
    --network host \
    cmsis-lm3s-gdb:latest \
    bash -c "cd /work && \
             gdb-multiarch -batch -x my_fir_test.gdb \
                  examples/arm_fir_example/gcc/arm_fir_example_f32.axf"

# æ¸…ç†
docker stop qemu_gdb_server
```

</details>

---

### ç·´ç¿’ 4: å‘¼å«å †ç–Šåˆ†æ (é€²éš)

**ç›®æ¨™**: åˆ†æå‡½å¼å‘¼å«é—œä¿‚ï¼Œæ‰¾å‡ºå‘¼å«è·¯å¾‘

**å ´æ™¯**: ä½ çš„ç¨‹å¼ä¸­æœ‰å‡½å¼ `dangerous_function()` è¢«å‘¼å«äº†ï¼Œä½†ä½ ä¸çŸ¥é“æ˜¯å¾å“ªè£¡å‘¼å«çš„ã€‚

```gdb
# è¨­ä¸­æ–·é»
(gdb) break dangerous_function
(gdb) continue

Breakpoint 1, dangerous_function () at test.c:100

# æŸ¥çœ‹å®Œæ•´å‘¼å«å †ç–Š
(gdb) backtrace full
#0  dangerous_function () at test.c:100
      local_var = 42
#1  0x00000250 in middle_function (x=10) at test.c:80
      y = 20
      result = 0
#2  0x00000180 in top_function () at test.c:50
      counter = 5
#3  0x00000120 in main () at test.c:10
      status = 0

# åˆ†æ: main â†’ top_function â†’ middle_function â†’ dangerous_function
```

**æŒ‘æˆ°**: æ‰¾å‡º `dangerous_function` è¢«å‘¼å«æ™‚ï¼Œ`main` å‡½å¼ä¸­çš„ `status` è®Šæ•¸å€¼

<details>
<summary>ğŸ’¡ é»æ“ŠæŸ¥çœ‹è§£ç­”</summary>

```gdb
# åˆ‡æ›åˆ° frame 3 (main)
(gdb) frame 3
#3  0x00000120 in main () at test.c:10
10        status = 0;

# æŸ¥çœ‹ status çš„å€¼
(gdb) print status
$1 = 0

# æˆ–è€…ç›´æ¥åœ¨ frame 0 æ™‚æŸ¥çœ‹
(gdb) frame 0
(gdb) print *(int*)($fp + offset_to_status)
# éœ€è¦çŸ¥é“ status ç›¸å°æ–¼ frame pointer çš„åç§»

# æ›´ç°¡å–®çš„æ–¹å¼: ä½¿ç”¨ up/down å°èˆª
(gdb) frame 0    # dangerous_function
(gdb) up
#1  middle_function (x=10) at test.c:80
(gdb) up
#2  top_function () at test.c:50
(gdb) up
#3  main () at test.c:10
(gdb) print status
$1 = 0
```

**é€²éš**: è‡ªå‹•åŒ–é€™å€‹éç¨‹

```gdb
# å®šç¾©è‡ªè¨‚å‘½ä»¤
define find_caller_var
    set $frame = 0
    while $frame < 10
        frame $frame
        if $arg0
            printf "Found in frame %d: ", $frame
            print $arg1
            loop_break
        end
        set $frame = $frame + 1
    end
end

# ä½¿ç”¨
(gdb) find_caller_var ($_streq("main", $_frame_function($frame))) status
```

</details>

---

### ç·´ç¿’ 5: è¨˜æ†¶é«”é™¤éŒ¯æŒ‘æˆ° (é€²éš)

**ç›®æ¨™**: æ‰¾å‡ºè¨˜æ†¶é«”æ´©æ¼æˆ–éæ³•å­˜å–

**å ´æ™¯**: ç¨‹å¼å‹•æ…‹åˆ†é…è¨˜æ†¶é«”ä½†å¿˜è¨˜é‡‹æ”¾

```c
void leak_memory() {
    char *buffer = (char*)malloc(100);
    // å¿˜è¨˜ free(buffer)!
}

int main() {
    for(int i = 0; i < 1000; i++) {
        leak_memory();
    }
}
```

**é™¤éŒ¯ç­–ç•¥**:

```gdb
# åœ¨ malloc è¨­ä¸­æ–·é»
(gdb) break malloc
(gdb) commands
> backtrace 1
> continue
> end

# åœ¨ free è¨­ä¸­æ–·é»
(gdb) break free
(gdb) commands
> backtrace 1
> continue
> end

# åŸ·è¡Œ
(gdb) continue

# è§€å¯Ÿ: malloc å‘¼å« 1000 æ¬¡ï¼Œä½† free å‘¼å« 0 æ¬¡ï¼
# â†’ ç¢ºèªè¨˜æ†¶é«”æ´©æ¼

# æ‰¾å‡ºæ´©æ¼ä½ç½®
(gdb) break malloc
(gdb) continue
Breakpoint 1, malloc (size=100) at malloc.c:100

(gdb) backtrace
#0  malloc (size=100) at malloc.c:100
#1  leak_memory () at test.c:5    â† é€™è£¡åˆ†é…è¨˜æ†¶é«”
#2  main () at test.c:12

# æ‰¾åˆ°äº†ï¼leak_memory() æ²’æœ‰é‡‹æ”¾è¨˜æ†¶é«”
```

---

## ğŸ”§ å¸¸è¦‹å•é¡Œèˆ‡è§£æ±º

### å•é¡Œ 1: Connection refused

**ç¾è±¡**:

```gdb
(gdb) target remote localhost:1234
localhost:1234: Connection refused.
```

**å¯èƒ½åŸå› èˆ‡è§£æ±º**:

```bash
# åŸå›  1: QEMU GDB Server æ²’å•Ÿå‹•
docker ps | grep qemu_gdb_server
# å¦‚æœæ²’çœ‹åˆ° â†’ å•Ÿå‹• QEMU

# åŸå›  2: Port 1234 è¢«å…¶ä»–ç¨‹å¼å ç”¨
netstat -tuln | grep 1234
# å¦‚æœçœ‹åˆ°å…¶ä»–ç¨‹å¼ â†’ åœæ­¢è©²ç¨‹å¼æˆ–æ›´æ› port

# åŸå›  3: é˜²ç«ç‰†é˜»æ“‹
sudo iptables -L | grep 1234
# å¦‚æœè¢«é˜»æ“‹ â†’ é–‹å•Ÿé˜²ç«ç‰†è¦å‰‡

# åŸå›  4: Docker ç¶²è·¯å•é¡Œ
docker run ... --network host ...
# ä½¿ç”¨ host ç¶²è·¯æ¨¡å¼
```

---

### å•é¡Œ 2: No symbol table is loaded

**ç¾è±¡**:

```gdb
(gdb) break main
No symbol table is loaded.  Use the "file" command.
```

**åŸå› **: æ²’æœ‰è¼‰å…¥ç¬¦è™Ÿæª” (.axf)

**è§£æ±º**:

```gdb
# è¼‰å…¥ç¬¦è™Ÿæª”
(gdb) file uart_hello_world.axf
Reading symbols from uart_hello_world.axf...

# æˆ–é‡æ–°å•Ÿå‹• GDB æ™‚æŒ‡å®š
$ gdb-multiarch uart_hello_world.axf
```

---

### å•é¡Œ 3: Cannot access memory

**ç¾è±¡**:

```gdb
(gdb) x/x 0x00000000
Cannot access memory at address 0x0
```

**å¯èƒ½åŸå› **:

1. **ç¨‹å¼å°šæœªé–‹å§‹åŸ·è¡Œ**
   ```gdb
   (gdb) continue    # å…ˆåŸ·è¡Œç¨‹å¼
   ```

2. **ä½å€ç„¡æ•ˆ**
   ```gdb
   # æª¢æŸ¥ memory map
   (gdb) info files
   # ç¢ºèªä½å€æ˜¯å¦åœ¨æœ‰æ•ˆç¯„åœå…§
   ```

3. **æ¬Šé™å•é¡Œ**
   ```gdb
   # æŸäº›è¨˜æ†¶é«”å€åŸŸå¯èƒ½éœ€è¦ç‰¹å®šæ¬Šé™æ‰èƒ½å­˜å–
   ```

---

### å•é¡Œ 4: Breakpoint not hit

**ç¾è±¡**: è¨­å®šäº†ä¸­æ–·é»ä½†ç¨‹å¼æ²’æœ‰åœä¸‹ä¾†

**æª¢æŸ¥é …ç›®**:

```gdb
# 1. ç¢ºèªä¸­æ–·é»æ˜¯å¦è¨­å®šæˆåŠŸ
(gdb) info breakpoints
Num     Type           Disp Enb Address    What
1       breakpoint     keep y   0x00000130 in main at main.c:45

# 2. ç¢ºèªç¨‹å¼æ˜¯å¦åŸ·è¡Œåˆ°è©²ä½ç½®
(gdb) continue
# è§€å¯Ÿæ˜¯å¦åœåœ¨ä¸­æ–·é»

# 3. ç¢ºèªå‡½å¼æ˜¯å¦è¢«å‘¼å«
(gdb) break main
(gdb) commands
> echo \n!!! Main called !!!\n
> continue
> end

# 4. æª¢æŸ¥å„ªåŒ–æ˜¯å¦ç§»é™¤äº†ç¨‹å¼ç¢¼
# ç·¨è­¯æ™‚ä½¿ç”¨ -O0 (ç„¡å„ªåŒ–)
```

---

### å•é¡Œ 5: Program received signal SIGSEGV

**ç¾è±¡**: ç¨‹å¼æ”¶åˆ° segmentation fault è¨Šè™Ÿ

**é™¤éŒ¯ç­–ç•¥**:

```gdb
# 1. æŸ¥çœ‹å´©æ½°ä½ç½®
(gdb) backtrace
#0  0x00000200 in crash_function () at test.c:45
#1  0x00000150 in main () at test.c:10

# 2. æª¢æŸ¥å´©æ½°çš„æŒ‡ä»¤
(gdb) frame 0
(gdb) disassemble
...
0x200 <+0>:  ldr r0, [r1]    â† å¾ r1 è®€å–
...

# 3. æª¢æŸ¥æš«å­˜å™¨
(gdb) info registers r1
r1    0x12345678    â† ç„¡æ•ˆä½å€ï¼

# 4. æ‰¾å‡º r1 çš„ä¾†æº
(gdb) backtrace full
#0  crash_function () at test.c:45
      ptr = 0x12345678    â† é€™æ˜¯å•é¡Œï¼

# 5. æª¢æŸ¥ ptr ç‚ºä½•æ˜¯ç„¡æ•ˆå€¼
(gdb) print &ptr
(gdb) watch ptr
# æ‰¾å‡ºèª°ä¿®æ”¹äº† ptr
```

---

## ğŸ¯ å­¸ç¿’æª¢æŸ¥é»

å®Œæˆæœ¬æ¨¡çµ„å¾Œï¼Œä½ æ‡‰è©²èƒ½å¤ ï¼š

**åŸºç¤æ“ä½œ**:
- [ ] å•Ÿå‹• QEMU GDB Server ä¸¦é€£æ¥ GDB Client
- [ ] è¨­å®šåŸºæœ¬ä¸­æ–·é» (å‡½å¼ã€è¡Œè™Ÿã€ä½å€)
- [ ] ä½¿ç”¨ continueã€nextã€step æ§åˆ¶ç¨‹å¼åŸ·è¡Œ
- [ ] ä½¿ç”¨ print æŸ¥çœ‹è®Šæ•¸å€¼
- [ ] ä½¿ç”¨ x å‘½ä»¤æª¢æŸ¥è¨˜æ†¶é«”å…§å®¹
- [ ] æŸ¥çœ‹æš«å­˜å™¨ç‹€æ…‹

**ä¸­éšæŠ€èƒ½**:
- [ ] è¨­å®šæ¢ä»¶ä¸­æ–·é»
- [ ] ä½¿ç”¨ watchpoint ç›£è¦–è®Šæ•¸è®ŠåŒ–
- [ ] åˆ†æå‘¼å«å †ç–Š (backtrace)
- [ ] åˆ‡æ› stack frame æŸ¥çœ‹ä¸åŒå±¤ç´šçš„è®Šæ•¸
- [ ] ä¿®æ”¹è®Šæ•¸å€¼å’Œæš«å­˜å™¨
- [ ] ä½¿ç”¨ GDB è…³æœ¬è‡ªå‹•åŒ–é™¤éŒ¯æµç¨‹

**é€²éšæŠ€èƒ½**:
- [ ] è¨ºæ–·å †ç–Šæº¢ä½å•é¡Œ
- [ ] è¿½è¹¤è¨˜æ†¶é«”è¦†å¯« (é‡æŒ‡æ¨™ã€buffer overflow)
- [ ] ä½¿ç”¨åçµ„è­¯åˆ†æä½éšå•é¡Œ
- [ ] æ•´åˆ RTOS æ„ŸçŸ¥é™¤éŒ¯
- [ ] æ’°å¯«è¤‡é›œçš„ GDB è‡ªè¨‚å‘½ä»¤
- [ ] åˆ†æ Core Dump

**å•é¡Œè§£æ±ºèƒ½åŠ›**:
- [ ] è¨ºæ–· GDB é€£æ¥å•é¡Œ
- [ ] è§£æ±ºç¬¦è™Ÿè¡¨è¼‰å…¥å•é¡Œ
- [ ] è™•ç†ä¸­æ–·é»æœªè§¸ç™¼çš„æƒ…æ³
- [ ] åˆ†æç¨‹å¼å´©æ½°åŸå› 

---

## ğŸ“š å»¶ä¼¸å­¸ç¿’è³‡æº

### å®˜æ–¹æ–‡ä»¶

- [GDB Official Documentation](https://www.gnu.org/software/gdb/documentation/)
- [GDB User Manual](https://sourceware.org/gdb/current/onlinedocs/gdb/)
- [GDB Remote Serial Protocol](https://sourceware.org/gdb/current/onlinedocs/gdb/Remote-Protocol.html)

### é€²éšä¸»é¡Œ

1. **GDB Python API**:
   - æ’°å¯« Python è…³æœ¬æ“´å±• GDB åŠŸèƒ½
   - è‡ªå‹•åŒ–è¤‡é›œçš„é™¤éŒ¯ä»»å‹™
   - RTOS æ„ŸçŸ¥é™¤éŒ¯å¤–æ›é–‹ç™¼

2. **DWARF é™¤éŒ¯è³‡è¨Šæ ¼å¼**:
   - ç†è§£é™¤éŒ¯ç¬¦è™Ÿçš„å„²å­˜æ–¹å¼
   - å„ªåŒ–é™¤éŒ¯è³‡è¨Šå¤§å°

3. **ç¡¬é«”è¼”åŠ©é™¤éŒ¯**:
   - ETM (Embedded Trace Macrocell)
   - ITM (Instrumentation Trace Macrocell)
   - SWO (Serial Wire Output)

### å¯¦ç”¨å·¥å…·

- **GDB Dashboard**: æ”¹å–„ GDB UI çš„å¤–æ›
- **CGDB**: å…·æœ‰åŸå§‹ç¢¼è¦–çª—çš„ GDB å‰ç«¯
- **DDD**: åœ–å½¢åŒ– GDB å‰ç«¯
- **Eclipse**: æ•´åˆ GDB çš„ IDE

---

## ğŸ”— èˆ‡å…¶ä»–æ¨¡çµ„çš„é—œè¯

```
[æ¨¡çµ„ 10: QEMU]
     â”‚
     â”‚ æä¾› GDB Server
     â†“
[æ¨¡çµ„ 11: GDB é™¤éŒ¯å™¨] â† ä½ åœ¨é€™è£¡
     â”‚
     â”‚ ç”¨æ–¼é™¤éŒ¯
     â†“
[æ¨¡çµ„ 07-08: FIR/IIR æ¿¾æ³¢å™¨]
[æ¨¡çµ„ 12: CMSIS-DSP å‡½å¼åº«]
```

**å­¸ç¿’è·¯å¾‘å»ºè­°**:

1. **å·²å®Œæˆ**: æ¨¡çµ„ 01-10 (ç·¨è­¯ã€QEMU)
2. **ç•¶å‰**: æ¨¡çµ„ 11 (GDB é™¤éŒ¯å™¨)
3. **æ¥ä¸‹ä¾†**: æ¨¡çµ„ 12 (CMSIS-DSP å‡½å¼åº«) - ä½¿ç”¨ GDB åˆ†æ DSP æ¼”ç®—æ³•

---

## ğŸ”— ä¸‹ä¸€æ­¥

æ­å–œå®Œæˆ GDB é™¤éŒ¯å™¨æ¨¡çµ„ï¼

ä½ ç¾åœ¨å·²ç¶“æŒæ¡äº†ï¼š
- âœ… GDB é ç«¯é™¤éŒ¯çš„å®Œæ•´æµç¨‹
- âœ… å„ç¨®ä¸­æ–·é»èˆ‡ç›£è¦–é»çš„ä½¿ç”¨
- âœ… è¨˜æ†¶é«”èˆ‡æš«å­˜å™¨çš„æª¢æŸ¥èˆ‡ä¿®æ”¹
- âœ… å‘¼å«å †ç–Šåˆ†æèˆ‡å‡½å¼è¿½è¹¤
- âœ… GDB è…³æœ¬è‡ªå‹•åŒ–
- âœ… å¸¸è¦‹åµŒå…¥å¼ Bug çš„é™¤éŒ¯ç­–ç•¥

**ä¸‹ä¸€å€‹æ¨¡çµ„**: [æ¨¡çµ„ 12ï¼šCMSIS-DSP å‡½å¼åº«](12-CMSIS-DSPå‡½å¼åº«.md)

åœ¨ä¸‹ä¸€å€‹æ¨¡çµ„ä¸­ï¼Œä½ å°‡å­¸ç¿’ï¼š
- CMSIS-DSP å‡½å¼åº«çš„æ¶æ§‹
- å„ç¨® DSP æ¼”ç®—æ³•çš„å¯¦ä½œ
- æ•ˆèƒ½å„ªåŒ–æŠ€å·§
- ä½¿ç”¨ GDB åˆ†æ DSP ç¨‹å¼çš„åŸ·è¡Œ

**ç¹¼çºŒåŠ æ²¹ï¼ä½ å·²ç¶“æ˜¯é™¤éŒ¯é«˜æ‰‹äº†ï¼**

---

**ç‰ˆæœ¬**: 2.0 | **æ—¥æœŸ**: 2025-11-16
**ä½œè€…**: Claude (Anthropic) | **æˆæ¬Š**: MIT
**æ›´æ–°æ—¥èªŒ**:
- v2.0 (2025-11-16): å®Œæ•´æ”¹ç‰ˆï¼Œæ–°å¢å¤§é‡ç™½è©±æ–‡è§£é‡‹ã€ç”Ÿæ´»é¡æ¯”èˆ‡å¯¦æˆ°ç¯„ä¾‹
- v1.0 (2025-11-16): åˆç‰ˆå»ºç«‹
