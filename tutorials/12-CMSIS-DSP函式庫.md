# æ¨¡çµ„ 12ï¼šCMSIS-DSP å‡½å¼åº«

> æ¢ç´¢ 271 å€‹æ•¸ä½è¨Šè™Ÿè™•ç†å‡½æ•¸ - å¾é›¶é–‹å§‹æŒæ¡ ARM å®˜æ–¹æœ€ä½³åŒ–å‡½å¼åº«

**å°æ‡‰å°ˆæ¡ˆæª”æ¡ˆ**: [`CMSIS/Include/arm_math.h`](/home/sbplab/jiawei/qemu/CMSIS_LM3S/CMSIS/Include/arm_math.h), [`CMSIS/DSP_Lib/Source/`](/home/sbplab/jiawei/qemu/CMSIS_LM3S/CMSIS/DSP_Lib/Source/)

---

## ğŸ¬ é–‹å ´æƒ…å¢ƒï¼šå·¥ç¨‹å¸«çš„æƒ¡å¤¢èˆ‡æ•‘è´–

### æƒ…å¢ƒä¸€ï¼šæ²’æœ‰ CMSIS-DSP çš„ç—›è‹¦æ—¥å­

**å ´æ™¯**ï¼šæŸé†«ç™‚å™¨æå…¬å¸ï¼Œæ™ºæ…§è¡€å£“è¨ˆå°ˆæ¡ˆ
- **å·¥ç¨‹å¸«å°é™³**ï¼šè² è²¬é–‹ç™¼è¨Šè™Ÿè™•ç†æ¼”ç®—æ³•
- **ä½¿ç”¨æ™¶ç‰‡**ï¼šSTMicroelectronics çš„ STM32F103ï¼ˆARM Cortex-M3ï¼‰

**å•é¡Œå‡ºç¾**ï¼š

```
ç¬¬ä¸€é€±ï¼šå°é™³å¯«äº† FFT å‡½æ•¸
â””â”€ åŸ·è¡Œæ™‚é–“ï¼š150 msï¼ˆè¦æ±‚ < 50 msï¼‰
â””â”€ å®¢æˆ¶æŠ±æ€¨ï¼šã€Œæ¸¬é‡å¤ªæ…¢äº†ï¼ã€

ç¬¬äºŒé€±ï¼šå°é™³å„ªåŒ– FFTï¼ŒåŠ å…¥çµ„åˆèªè¨€
â””â”€ åŸ·è¡Œæ™‚é–“ï¼š80 msï¼ˆé‚„æ˜¯å¤ªæ…¢ï¼‰
â””â”€ ç¨‹å¼ç¢¼ï¼š1200 è¡Œï¼Œbug ä¸€å †

ç¬¬ä¸‰é€±ï¼šå…¬å¸æ±ºå®šæ›æ™¶ç‰‡åˆ° TI çš„ LM3S6965ï¼ˆä¹Ÿæ˜¯ Cortex-M3ï¼‰
â””â”€ å°é™³å´©æ½°ï¼šã€Œçµ„åˆèªè¨€å…¨éƒ¨è¦é‡å¯«ï¼ã€
â””â”€ é ä¼°å·¥æ™‚ï¼š3 å€‹æœˆ

çµæœï¼šå°ˆæ¡ˆå»¶é²åŠå¹´ï¼Œå°é™³çˆ†è‚ä½é™¢
```

### æƒ…å¢ƒäºŒï¼šä½¿ç”¨ CMSIS-DSP çš„å¿«æ¨‚çµå±€

**å ´æ™¯**ï¼šåŒæ¨£çš„è¡€å£“è¨ˆå°ˆæ¡ˆï¼Œä½¿ç”¨ CMSIS-DSP

```c
// å°é™³åªéœ€è¦å¯« 10 è¡Œç¨‹å¼ç¢¼
#include "arm_math.h"

arm_cfft_instance_f32 S;
arm_cfft_init_f32(&S, 256);  // 256 é» FFT

// FFT è¨ˆç®—
arm_cfft_f32(&S, inputData, 0, 1);

// è¨ˆç®—é »è­œå¤§å°
arm_cmplx_mag_f32(inputData, outputData, 256);
```

**çµæœ**ï¼š
- âœ… åŸ·è¡Œæ™‚é–“ï¼š**35 ms**ï¼ˆæ¯”æ‰‹å¯«å¿« 4 å€ï¼ï¼‰
- âœ… ç¨‹å¼ç¢¼ï¼š**10 è¡Œ**ï¼ˆæ¯”æ‰‹å¯«å°‘ 100 å€ï¼ï¼‰
- âœ… ç§»æ¤æ€§ï¼šæ›æ™¶ç‰‡åªéœ€é‡æ–°ç·¨è­¯ï¼Œ**ä¸ç”¨æ”¹ä»»ä½•ç¨‹å¼ç¢¼**
- âœ… å°é™³æº–æ™‚ä¸‹ç­ï¼Œé€±æœ«å»çˆ¬å±±

**æ•ˆç›Šåˆ†æ**ï¼š

| é …ç›® | æ‰‹å¯«æ¼”ç®—æ³• | CMSIS-DSP | æ”¹å–„å¹…åº¦ |
|------|-----------|-----------|---------|
| é–‹ç™¼æ™‚é–“ | 3 å€‹æœˆ | 2 å¤© | **45 å€** |
| ç¨‹å¼ç¢¼è¡Œæ•¸ | 1200 è¡Œ | 10 è¡Œ | **120 å€** |
| åŸ·è¡Œé€Ÿåº¦ | 150 ms | 35 ms | **4.3 å€** |
| Bug æ•¸é‡ | 23 å€‹ | 0 å€‹ | **âˆ å€** |
| ç§»æ¤æˆæœ¬ | 3 å€‹æœˆ | 0 å¤© | **âˆ å€** |
| å·¥ç¨‹å¸«å¥åº· | ä½é™¢ | å¥åº· | **ç„¡åƒ¹** |

é€™å°±æ˜¯ CMSIS-DSP å‡½å¼åº«çš„å¨åŠ›ï¼æ¥ä¸‹ä¾†ï¼Œæˆ‘å€‘è¦æ·±å…¥ç†è§£é€™å€‹ã€Œæ­¦åŠŸç§˜ç¬ˆã€çš„æ¯ä¸€æ‹›æ¯ä¸€å¼ã€‚

---

## ğŸ“Œ å­¸ç¿’ç›®æ¨™
- âœ… èªè­˜ CMSIS æ¨™æº–çš„èª•ç”ŸèƒŒæ™¯èˆ‡é‡è¦æ€§
- âœ… ç†è§£ CMSIS-DSP æ¶æ§‹èˆ‡ 10 å¤§å‡½æ•¸åˆ†é¡
- âœ… å­¸æœƒä½¿ç”¨ DSP å‡½æ•¸ä¸¦çœ‹æ‡‚åƒæ•¸æ„ç¾©
- âœ… äº†è§£å®šé»èˆ‡æµ®é»é‹ç®—çš„å·®ç•°èˆ‡é¸æ“‡æ™‚æ©Ÿ
- âœ… æŒæ¡æ•ˆèƒ½æœ€ä½³åŒ–æŠ€å·§

---

## 1. CMSIS ç°¡ä»‹ï¼šARM åµŒå…¥å¼ä¸–ç•Œçš„ã€Œå…±é€šèªè¨€ã€

### 1.1 ä»€éº¼æ˜¯ CMSISï¼Ÿ

**CMSIS** = **C**ortex **M**icrocontroller **S**oftware **I**nterface **S**tandard
ï¼ˆCortex å¾®æ§åˆ¶å™¨è»Ÿé«”ä»‹é¢æ¨™æº–ï¼‰

### ğŸ“– ç”Ÿæ´»é¡æ¯”ï¼šå…¨çƒé›»å™¨æ’åº§çš„çµ±ä¸€æ¨™æº–

æƒ³åƒä¸€å€‹å•é¡Œï¼š

```
ä½ è²·äº†ä¸€å°æ—¥æœ¬è£½é€ çš„é›»é¢¨æ‰‡
â”‚
â”œâ”€ æ’åº§æ˜¯æ—¥æœ¬ Type Aï¼ˆå…©æ‰è…³ï¼‰
â”‚
å¸¶å›å°ç£
â”‚
â”œâ”€ å°ç£æ’åº§æ˜¯ Type Bï¼ˆä¸‰æ‰è…³ï¼‰
â”‚
çµæœï¼šæ’ä¸é€²å»ï¼éœ€è¦è½‰æ¥é ­
```

åœ¨ 2009 å¹´ä¹‹å‰ï¼ŒARM åµŒå…¥å¼é–‹ç™¼å°±åƒé€™æ¨£æ··äº‚ï¼š

```
ST å…¬å¸çš„ STM32 æ™¶ç‰‡
â”œâ”€ åˆå§‹åŒ–å‡½æ•¸ï¼šSTM32_Init()
â”œâ”€ GPIO æ§åˆ¶ï¼šGPIO_SetBits()
â”œâ”€ ä¸­æ–·è¨­å®šï¼šNVIC_EnableIRQ()

TI å…¬å¸çš„ LM3S æ™¶ç‰‡ï¼ˆåŒæ¨£æ˜¯ Cortex-M3ï¼ï¼‰
â”œâ”€ åˆå§‹åŒ–å‡½æ•¸ï¼šStellaris_SystemInit()
â”œâ”€ GPIO æ§åˆ¶ï¼šGPIOPinWrite()
â”œâ”€ ä¸­æ–·è¨­å®šï¼šIntEnable()

æ¯æ›ä¸€å®¶æ™¶ç‰‡å» å•†ï¼Œç¨‹å¼ç¢¼å°±è¦å…¨éƒ¨é‡å¯«ï¼
```

**CMSIS çš„èª•ç”Ÿ** = ARM èªªï¼šã€Œå¤§å®¶çµ±ä¸€ç”¨æˆ‘çš„æ¨™æº–ï¼ã€

å°±åƒæ­ç›Ÿæ¨å‹•çµ±ä¸€çš„ Type C/F æ’åº§æ¨™æº–ï¼Œç¾åœ¨æ‰€æœ‰ä½¿ç”¨ ARM Cortex-M æ ¸å¿ƒçš„æ™¶ç‰‡éƒ½éµå¾ª CMSIS æ¨™æº–ï¼Œç¨‹å¼ç¢¼å¯ä»¥è¼•é¬†ç§»æ¤ã€‚

### 1.2 CMSIS äº”å¤§çµ„ä»¶

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    CMSIS äº”å¤§çµ„ä»¶                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ CMSIS-Core   â”‚ æ ¸å¿ƒæš«å­˜å™¨èˆ‡å‡½æ•¸                          â”‚
â”‚              â”‚ â€¢ ç³»çµ±æ™‚é˜è¨­å®š (SystemCoreClock)          â”‚
â”‚              â”‚ â€¢ ä¸­æ–·æ§åˆ¶å™¨ (NVIC)                       â”‚
â”‚              â”‚ â€¢ ç³»çµ±æ»´ç­”å®šæ™‚å™¨ (SysTick)                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ CMSIS-DSP    â”‚ æ•¸ä½è¨Šè™Ÿè™•ç†å‡½å¼åº« â† æœ¬èª²ç¨‹é‡é»ï¼         â”‚
â”‚              â”‚ â€¢ 271 å€‹é«˜æ•ˆèƒ½ DSP å‡½æ•¸                   â”‚
â”‚              â”‚ â€¢ FIRã€IIRã€FFTã€çŸ©é™£é‹ç®—                 â”‚
â”‚              â”‚ â€¢ é‡å° Cortex-M æœ€ä½³åŒ–                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ CMSIS-RTOS   â”‚ å³æ™‚ä½œæ¥­ç³»çµ±ä»‹é¢                          â”‚
â”‚              â”‚ â€¢ çµ±ä¸€çš„ RTOS API                         â”‚
â”‚              â”‚ â€¢ æ”¯æ´ FreeRTOSã€RTX ç­‰                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ CMSIS-Driver â”‚ å‘¨é‚Šé©…å‹•ç¨‹å¼ä»‹é¢                          â”‚
â”‚              â”‚ â€¢ UARTã€SPIã€I2C çµ±ä¸€ä»‹é¢                 â”‚
â”‚              â”‚ â€¢ ä¸åŒæ™¶ç‰‡ç”¨åŒæ¨£çš„ API                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ CMSIS-NN     â”‚ ç¥ç¶“ç¶²è·¯å‡½å¼åº«ï¼ˆ2017 å¹´æ–°å¢ï¼‰             â”‚
â”‚              â”‚ â€¢ TinyML æ©Ÿå™¨å­¸ç¿’                         â”‚
â”‚              â”‚ â€¢ å·ç©ã€æ± åŒ–ã€å•Ÿå‹•å‡½æ•¸                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ğŸ“– ç”Ÿæ´»é¡æ¯”ï¼šäº”å¤§çµ„ä»¶å°±åƒã€Œæ™ºæ…§å‹æ‰‹æ©Ÿçš„ä½œæ¥­ç³»çµ±ã€

```
CMSIS-Core    = Android æ ¸å¿ƒï¼ˆç®¡ç† CPUã€è¨˜æ†¶é«”ï¼‰
CMSIS-DSP     = ç›¸æ©Ÿ App çš„æ¿¾é¡æ¼”ç®—æ³•ï¼ˆç¾è‚Œã€é»‘ç™½ã€å¾©å¤ï¼‰
CMSIS-RTOS    = å¤šå·¥è™•ç†ï¼ˆåŒæ™‚è½éŸ³æ¨‚ã€å°èˆªã€æ¥é›»è©±ï¼‰
CMSIS-Driver  = é©…å‹•ç¨‹å¼ï¼ˆç›¸æ©Ÿã€è¢å¹•ã€è—ç‰™ã€Wi-Fiï¼‰
CMSIS-NN      = Google Lensï¼ˆAI è¾¨è­˜åŠŸèƒ½ï¼‰
```

ä¸åŒå“ç‰Œçš„æ‰‹æ©Ÿï¼ˆSamsungã€HTCã€å°ç±³ï¼‰éƒ½ä½¿ç”¨ Androidï¼Œç¨‹å¼å¯ä»¥é€šç”¨ï¼›
ä¸åŒå» å•†çš„ ARM æ™¶ç‰‡ï¼ˆSTã€TIã€NXPï¼‰éƒ½ä½¿ç”¨ CMSISï¼Œç¨‹å¼ä¹Ÿèƒ½é€šç”¨ï¼

### 1.3 CMSIS çš„å¥½è™•

**å¥½è™•ä¸€ï¼šè·¨æ™¶ç‰‡å» å•†ä¸€è‡´æ€§** ğŸ“±â¡ï¸ğŸ“±

```c
// é€™æ®µç¨‹å¼ç¢¼å¯ä»¥åœ¨ã€Œä»»ä½•ã€Cortex-M3 æ™¶ç‰‡ä¸ŠåŸ·è¡Œï¼
#include "arm_math.h"

float32_t input[128];
float32_t output[128];

// ST çš„ STM32 â†’ å¯ä»¥åŸ·è¡Œ
// TI çš„ LM3S â†’ å¯ä»¥åŸ·è¡Œ
// NXP çš„ LPC â†’ å¯ä»¥åŸ·è¡Œ
// Infineon çš„ XMC â†’ å¯ä»¥åŸ·è¡Œ

arm_fir_f32(&firInstance, input, output, 128);
```

**å¥½è™•äºŒï¼šARM å®˜æ–¹æœ€ä½³åŒ–å¯¦ä½œ** âš¡

ARM å·¥ç¨‹å¸«èŠ±äº†æ•¸åƒå°æ™‚å„ªåŒ–æ¯ä¸€å€‹å‡½æ•¸ï¼Œå……åˆ†åˆ©ç”¨ Cortex-M çš„ç¡¬é«”ç‰¹æ€§ï¼š

```
ä¸€èˆ¬æ‰‹å¯« FFTï¼š
â”œâ”€ ä½¿ç”¨æ¨™æº– C èªè¨€
â”œâ”€ åŸ·è¡Œæ™‚é–“ï¼š150 ms
â””â”€ ç¨‹å¼ç¢¼å¤§å°ï¼š5 KB

CMSIS-DSP çš„ FFTï¼š
â”œâ”€ ä½¿ç”¨ SIMD æŒ‡ä»¤ï¼ˆå–®æŒ‡ä»¤å¤šè³‡æ–™ï¼‰
â”œâ”€ ä½¿ç”¨æŸ¥è©¢è¡¨ï¼ˆæ¸›å°‘ä¸‰è§’å‡½æ•¸è¨ˆç®—ï¼‰
â”œâ”€ ä½¿ç”¨ä½å…ƒåè½‰æœ€ä½³åŒ–
â”œâ”€ åŸ·è¡Œæ™‚é–“ï¼š35 msï¼ˆå¿« 4.3 å€ï¼‰
â””â”€ ç¨‹å¼ç¢¼å¤§å°ï¼š2 KBï¼ˆçœä¸€åŠç©ºé–“ï¼‰
```

**å¥½è™•ä¸‰ï¼šå…è²»é–‹æº** ğŸ†“

```
æˆæ¬Šæ–¹å¼ï¼šApache 2.0ï¼ˆå•†æ¥­ä½¿ç”¨å…è²»ï¼‰
åŸå§‹ç¢¼ï¼šhttps://github.com/ARM-software/CMSIS_5
æ–‡ä»¶ï¼šå®Œæ•´çš„ PDF æ‰‹å†Šï¼ˆ1000+ é ï¼‰
ç¯„ä¾‹ï¼šæ•¸ç™¾å€‹å¯¦ç”¨ç¯„ä¾‹
æ”¯æ´ï¼šARM å®˜æ–¹ç¶­è­·æ›´æ–°
```

**å¥½è™•å››ï¼šç¶“éå¤§è¦æ¨¡é©—è­‰** âœ…

```
ä½¿ç”¨è€…æ•¸é‡ï¼šæ•¸ç™¾è¬åµŒå…¥å¼å·¥ç¨‹å¸«
é©—è­‰æ™‚é–“ï¼š2009 å¹´è‡³ä»Šï¼ˆ15+ å¹´ï¼‰
æ‡‰ç”¨é ˜åŸŸï¼š
â”œâ”€ é†«ç™‚å™¨æï¼ˆå¿ƒé›»åœ–ã€è¡€æ°§æ©Ÿï¼‰
â”œâ”€ å·¥æ¥­æ§åˆ¶ï¼ˆé¦¬é”æ§åˆ¶ã€PLCï¼‰
â”œâ”€ æ¶ˆè²»é›»å­ï¼ˆè€³æ©Ÿã€æ‰‹ç’°ï¼‰
â””â”€ æ±½è»Šé›»å­ï¼ˆADASã€å„€è¡¨æ¿ï¼‰
```

### ğŸ“– ç”Ÿæ´»é¡æ¯”ï¼šCMSIS å°±åƒã€Œæ¨‚é«˜ç©æœ¨çš„æ¨™æº–æ¥å£ã€

```
æ¨‚é«˜ç©æœ¨çš„å¨åŠ›ï¼š
â”œâ”€ æ‰€æœ‰ç©æœ¨éƒ½èƒ½äº’ç›¸çµ„åˆï¼ˆæ¨™æº–æ¥å£ï¼‰
â”œâ”€ ä¸ç”¨è‡ªå·±ç™¼æ˜æ–°ç©æœ¨ï¼ˆARM æä¾› 271 å€‹å‡½æ•¸ï¼‰
â”œâ”€ çµ„è£èªªæ˜æ›¸å¾ˆè©³ç´°ï¼ˆå®Œæ•´æ–‡ä»¶ï¼‰
â””â”€ å…¨çƒé€šç”¨ï¼ˆè·¨å» å•†ï¼‰

CMSIS-DSP çš„å¨åŠ›ï¼š
â”œâ”€ æ‰€æœ‰å‡½æ•¸éƒ½èƒ½äº’ç›¸æ­é…ï¼ˆçµ±ä¸€ä»‹é¢ï¼‰
â”œâ”€ ä¸ç”¨è‡ªå·±å¯«æ¼”ç®—æ³•ï¼ˆARM æä¾›æœ€ä½³åŒ–å¯¦ä½œï¼‰
â”œâ”€ ä½¿ç”¨æ‰‹å†Šå¾ˆè©³ç´°ï¼ˆ1000+ é æ–‡ä»¶ï¼‰
â””â”€ å…¨çƒé€šç”¨ï¼ˆè·¨æ™¶ç‰‡ï¼‰
```

ä½ ä¸æœƒè‡ªå·±ç£¨å¡‘è† å¡Šä¾†åšç©æœ¨ï¼ŒåŒæ¨£åœ°ï¼Œä½ ä¹Ÿä¸è©²è‡ªå·±æ‰‹å¯« FFT å‡½æ•¸ï¼

---

## 2. CMSIS-DSP æ¶æ§‹ï¼š271 å€‹å‡½æ•¸çš„ã€Œæ­¦åŠŸæ‹›å¼åˆ†é¡ã€

### 2.1 åå¤§åˆ†é¡ç¸½è¦½

CMSIS-DSP å°±åƒä¸€æœ¬æ­¦åŠŸç§˜ç¬ˆï¼Œè£¡é¢æœ‰ **271 æ‹›**ï¼Œåˆ†æˆ **10 å€‹é–€æ´¾**ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               CMSIS-DSP åå¤§å‡½æ•¸åˆ†é¡                     â”‚
â”‚                   (å…± 271 å€‹å‡½æ•¸)                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1ï¸âƒ£   â”‚ BasicMathFunctions (åŸºæœ¬æ•¸å­¸) - 35 å€‹           â”‚
â”‚      â”‚ å‘é‡åŠ æ¸›ä¹˜é™¤ã€é»ç©ã€ç¸®æ”¾ã€åç§»ã€çµ•å°å€¼            â”‚
â”‚      â”‚ ç”Ÿæ´»é¡æ¯”ï¼šè¨ˆç®—æ©Ÿçš„ +ã€-ã€Ã—ã€Ã· æŒ‰éˆ•              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 2ï¸âƒ£   â”‚ ComplexMathFunctions (è¤‡æ•¸é‹ç®—) - 18 å€‹         â”‚
â”‚      â”‚ è¤‡æ•¸åŠ æ¸›ä¹˜é™¤ã€å…±è»›ã€æ¨¡ã€ç›¸ä½                      â”‚
â”‚      â”‚ ç”Ÿæ´»é¡æ¯”ï¼šå¹³é¢ä¸Šçš„å‘é‡é‹ç®—                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 3ï¸âƒ£   â”‚ ControllerFunctions (æ§åˆ¶å™¨) - 8 å€‹             â”‚
â”‚      â”‚ PID æ§åˆ¶å™¨ã€Clarke/Park è½‰æ›ã€ä¸‰è§’å‡½æ•¸            â”‚
â”‚      â”‚ ç”Ÿæ´»é¡æ¯”ï¼šæ†æº«å™¨ã€è‡ªå‹•é§•é§›çš„æ–¹å‘ç›¤æ§åˆ¶            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 4ï¸âƒ£   â”‚ FastMathFunctions (å¿«é€Ÿæ•¸å­¸) - 8 å€‹             â”‚
â”‚      â”‚ å¿«é€Ÿå¹³æ–¹æ ¹ã€æ­£å¼¦ã€é¤˜å¼¦ï¼ˆæŸ¥è©¢è¡¨æ–¹å¼ï¼‰              â”‚
â”‚      â”‚ ç”Ÿæ´»é¡æ¯”ï¼šèƒŒä¹ä¹ä¹˜æ³•è¡¨ï¼Œè€Œä¸æ˜¯æ¯æ¬¡éƒ½ç®—            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 5ï¸âƒ£   â”‚ FilteringFunctions (æ¿¾æ³¢å™¨) - 99 å€‹ â† æœ€å¤šï¼    â”‚
â”‚      â”‚ FIRã€IIRã€LMSã€å·ç©ã€ç›¸é—œã€Biquad                â”‚
â”‚      â”‚ ç”Ÿæ´»é¡æ¯”ï¼šè€³æ©Ÿçš„é™å™ªåŠŸèƒ½ã€Instagram æ¿¾é¡         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 6ï¸âƒ£   â”‚ MatrixFunctions (çŸ©é™£é‹ç®—) - 25 å€‹              â”‚
â”‚      â”‚ çŸ©é™£åŠ æ¸›ä¹˜ã€è½‰ç½®ã€åçŸ©é™£ã€Cholesky åˆ†è§£           â”‚
â”‚      â”‚ ç”Ÿæ´»é¡æ¯”ï¼šExcel è©¦ç®—è¡¨çš„çŸ©é™£é‹ç®—                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 7ï¸âƒ£   â”‚ StatisticsFunctions (çµ±è¨ˆ) - 25 å€‹              â”‚
â”‚      â”‚ å¹³å‡ã€è®Šç•°æ•¸ã€æ¨™æº–å·®ã€æœ€å¤§æœ€å°ã€RMS               â”‚
â”‚      â”‚ ç”Ÿæ´»é¡æ¯”ï¼šè¨ˆç®—å…¨ç­æˆç¸¾çš„å¹³å‡åˆ†æ•¸                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 8ï¸âƒ£   â”‚ SupportFunctions (æ”¯æ´å‡½æ•¸) - 20 å€‹             â”‚
â”‚      â”‚ è³‡æ–™è½‰æ›(floatâ†”q31â†”q15)ã€è¤‡è£½ã€å¡«å……             â”‚
â”‚      â”‚ ç”Ÿæ´»é¡æ¯”ï¼šæª”æ¡ˆæ ¼å¼è½‰æ›å™¨ï¼ˆWord â†’ PDFï¼‰           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 9ï¸âƒ£   â”‚ TransformFunctions (è½‰æ›) - 31 å€‹               â”‚
â”‚      â”‚ FFTã€IFFTã€DCTã€RFFTï¼ˆå¯¦æ•¸ FFTï¼‰                 â”‚
â”‚      â”‚ ç”Ÿæ´»é¡æ¯”ï¼šShazam éŸ³æ¨‚è¾¨è­˜ï¼ˆæ™‚åŸŸâ†’é »åŸŸï¼‰           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ”Ÿ   â”‚ CommonTables (æŸ¥è©¢è¡¨) - 2 å€‹                     â”‚
â”‚      â”‚ é å…ˆè¨ˆç®—çš„ä¸‰è§’å‡½æ•¸è¡¨ã€ä½å…ƒåè½‰è¡¨                  â”‚
â”‚      â”‚ ç”Ÿæ´»é¡æ¯”ï¼šå­—å…¸ï¼ˆæŸ¥è©¢æ¯”ç¾å ´è¨ˆç®—å¿«ï¼‰                â”‚
â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 ç‚ºä»€éº¼ FilteringFunctions æœ€å¤šï¼Ÿï¼ˆ99 å€‹å‡½æ•¸ï¼‰

å› ç‚ºæ¿¾æ³¢å™¨æœ‰éå¸¸å¤šç¨®è®ŠåŒ–ï¼š

```
æ¿¾æ³¢å™¨çš„ç¶­åº¦çµ„åˆï¼š
â”‚
â”œâ”€ è³‡æ–™å‹åˆ¥ï¼šf32, q31, q15, q7 â†’ 4 ç¨®
â”œâ”€ æ¿¾æ³¢å™¨é¡å‹ï¼šFIR, IIR, LMS, å·ç©, ç›¸é—œ â†’ 5 ç¨®
â”œâ”€ è™•ç†æ–¹å¼ï¼šä¸€èˆ¬, å¿«é€Ÿ, æ’å€¼, é™å–æ¨£ â†’ 4 ç¨®
â”‚
4 Ã— 5 Ã— 4 = 80 ç¨®æ’åˆ—çµ„åˆ
å†åŠ ä¸Šç‰¹æ®Šè®Šé«” â†’ 99 å€‹å‡½æ•¸
```

### ğŸ“– ç”Ÿæ´»é¡æ¯”ï¼šå’–å•¡åº—çš„èœå–®

```
æ˜Ÿå·´å…‹èœå–®ä¹Ÿæ˜¯é€™æ¨£çš„çµ„åˆï¼š
â”‚
â”œâ”€ å’–å•¡ç¨®é¡ï¼šç¾å¼ã€æ‹¿éµã€æ‘©å¡ã€å¡å¸ƒ â†’ 4 ç¨®
â”œâ”€ æº«åº¦ï¼šç†±ã€å†° â†’ 2 ç¨®
â”œâ”€ å¤§å°ï¼šå°ã€ä¸­ã€å¤§ã€ç‰¹å¤§ â†’ 4 ç¨®
â”‚
4 Ã— 2 Ã— 4 = 32 ç¨®çµ„åˆ

CMSIS-DSP çš„æ¿¾æ³¢å™¨å‡½æ•¸ä¹Ÿæ˜¯é¡ä¼¼æ¦‚å¿µï¼
arm_fir_f32()  = FIR + æµ®é»æ•¸
arm_fir_q15()  = FIR + å®šé»æ•¸ Q15
arm_biquad_cascade_df1_f32() = IIR Biquad + æµ®é»æ•¸
```

### 2.3 å„åˆ†é¡è©³ç´°èªªæ˜

#### 1ï¸âƒ£ BasicMathFunctionsï¼ˆåŸºæœ¬æ•¸å­¸ï¼‰- 35 å€‹å‡½æ•¸

é€™æ˜¯æœ€åŸºç¤çš„å‘é‡é‹ç®—ï¼Œå°±åƒåœ‹å°æ•¸å­¸çš„åŠ æ¸›ä¹˜é™¤ã€‚

**å¸¸ç”¨å‡½æ•¸**ï¼š

```c
// å‘é‡åŠ æ³•ï¼šC[i] = A[i] + B[i]
void arm_add_f32(
    float32_t *pSrcA,     // è¼¸å…¥å‘é‡ A
    float32_t *pSrcB,     // è¼¸å…¥å‘é‡ B
    float32_t *pDst,      // è¼¸å‡ºå‘é‡ C
    uint32_t blockSize    // å‘é‡é•·åº¦
);

// å‘é‡ä¹˜æ³•ï¼šC[i] = A[i] Ã— B[i]
void arm_mult_f32(...);

// é»ç©ï¼šresult = A[0]Ã—B[0] + A[1]Ã—B[1] + ... + A[n]Ã—B[n]
void arm_dot_prod_f32(
    float32_t *pSrcA,
    float32_t *pSrcB,
    uint32_t blockSize,
    float32_t *result     // å–®ä¸€çµæœ
);

// ç¸®æ”¾ï¼šB[i] = A[i] Ã— scale
void arm_scale_f32(
    float32_t *pSrc,
    float32_t scale,      // ç¸®æ”¾ä¿‚æ•¸
    float32_t *pDst,
    uint32_t blockSize
);

// åç§»ï¼šB[i] = A[i] + offset
void arm_offset_f32(...);

// çµ•å°å€¼ï¼šB[i] = |A[i]|
void arm_abs_f32(...);
```

**å¯¦éš›æ‡‰ç”¨**ï¼š

```
æ„Ÿæ¸¬å™¨è³‡æ–™è™•ç†ï¼š
â”œâ”€ åŠ é€Ÿåº¦è¨ˆä¸‰è»¸åˆæˆï¼šsqrt(xÂ² + yÂ² + zÂ²)
â”œâ”€ æº«åº¦æ ¡æ­£ï¼štemp_real = temp_raw Ã— 0.1 + offset
â””â”€ è¨Šè™Ÿæ­£è¦åŒ–ï¼šdata[i] = data[i] / max_value
```

#### 5ï¸âƒ£ FilteringFunctionsï¼ˆæ¿¾æ³¢å™¨ï¼‰- 99 å€‹å‡½æ•¸

é€™æ˜¯æˆ‘å€‘åœ¨æ¨¡çµ„ 7 å’Œ 8 è©³ç´°å­¸éçš„å…§å®¹ï¼

```c
// FIR æ¿¾æ³¢å™¨ï¼ˆæ¨¡çµ„ 7ï¼‰
arm_fir_instance_f32 S;
arm_fir_init_f32(&S, numTaps, pCoeffs, pState, blockSize);
arm_fir_f32(&S, pSrc, pDst, blockSize);

// IIR Biquad æ¿¾æ³¢å™¨ï¼ˆæ¨¡çµ„ 8ï¼‰
arm_biquad_casd_df1_inst_f32 S;
arm_biquad_cascade_df1_init_f32(&S, numStages, pCoeffs, pState);
arm_biquad_cascade_df1_f32(&S, pSrc, pDst, blockSize);

// å·ç©ï¼ˆConvolutionï¼‰
void arm_conv_f32(
    float32_t *pSrcA,     // è¨Šè™Ÿ
    uint32_t srcALen,
    float32_t *pSrcB,     // æ¿¾æ³¢å™¨ä¿‚æ•¸
    uint32_t srcBLen,
    float32_t *pDst       // è¼¸å‡º
);

// ç›¸é—œï¼ˆCorrelationï¼‰
void arm_correlate_f32(...);
```

**FIR vs IIR å¿«é€Ÿè¤‡ç¿’**ï¼š

```
              FIR                    IIR
è¨˜æ†¶é«”    å¤§ï¼ˆéœ€è¦ N å€‹ç‹€æ…‹ï¼‰    å°ï¼ˆåªéœ€ 2-4 å€‹ç‹€æ…‹ï¼‰
ç©©å®šæ€§    çµ•å°ç©©å®š              å¯èƒ½ä¸ç©©å®š
ç›¸ä½      ç·šæ€§ç›¸ä½              éç·šæ€§ç›¸ä½
è¨­è¨ˆ      ç°¡å–®                  è¤‡é›œ
æ‡‰ç”¨      éŸ³è¨Šè™•ç†              çœé›»è¨­å‚™
```

#### 7ï¸âƒ£ StatisticsFunctionsï¼ˆçµ±è¨ˆï¼‰- 25 å€‹å‡½æ•¸

è™•ç†è³‡æ–™çš„çµ±è¨ˆç‰¹æ€§ï¼Œå°±åƒ Excel çš„çµ±è¨ˆå‡½æ•¸ã€‚

```c
// å¹³å‡å€¼ï¼šmean = (x[0] + x[1] + ... + x[n-1]) / n
void arm_mean_f32(
    float32_t *pSrc,
    uint32_t blockSize,
    float32_t *pResult
);

// è®Šç•°æ•¸ï¼švar = Î£(x[i] - mean)Â² / n
void arm_var_f32(...);

// æ¨™æº–å·®ï¼šstd = sqrt(var)
void arm_std_f32(...);

// RMSï¼ˆå‡æ–¹æ ¹ï¼‰ï¼šrms = sqrt((x[0]Â² + x[1]Â² + ... + x[n-1]Â²) / n)
void arm_rms_f32(...);

// æœ€å¤§å€¼èˆ‡ä½ç½®
void arm_max_f32(
    float32_t *pSrc,
    uint32_t blockSize,
    float32_t *pResult,   // æœ€å¤§å€¼
    uint32_t *pIndex      // æœ€å¤§å€¼çš„ç´¢å¼•ä½ç½®
);

// æœ€å°å€¼èˆ‡ä½ç½®
void arm_min_f32(...);

// èƒ½é‡ï¼šsum = x[0]Â² + x[1]Â² + ... + x[n-1]Â²
void arm_power_f32(...);
```

**å¯¦éš›æ‡‰ç”¨**ï¼š

```
å¥åº·ç›£æ¸¬æ‰‹ç’°ï¼š
â”œâ”€ å¿ƒç‡å¹³å‡å€¼ï¼šarm_mean_f32(heartRate, 100, &avgHR)
â”œâ”€ å¿ƒç‡è®Šç•°æ€§ï¼šarm_std_f32(heartRate, 100, &hrv)
â”œâ”€ æ­¥æ•¸åµæ¸¬ï¼šarm_max_f32(accel, 1000, &peak, &peakIdx)
â””â”€ è¨Šè™Ÿå¼·åº¦ï¼šarm_rms_f32(signal, 256, &strength)
```

#### 9ï¸âƒ£ TransformFunctionsï¼ˆè½‰æ›ï¼‰- 31 å€‹å‡½æ•¸

æœ€é‡è¦çš„æ˜¯ **FFT**ï¼ˆå¿«é€Ÿå‚…ç«‹è‘‰è½‰æ›ï¼‰ï¼Œå¯ä»¥æŠŠè¨Šè™Ÿå¾ã€Œæ™‚åŸŸã€è½‰æ›åˆ°ã€Œé »åŸŸã€ã€‚

```c
// è¤‡æ•¸ FFTï¼ˆComplex FFTï¼‰
arm_cfft_instance_f32 S;
arm_cfft_init_f32(&S, fftLen);  // fftLen = 16, 32, 64, ..., 4096

arm_cfft_f32(
    &S,
    pSrc,        // è¼¸å…¥/è¼¸å‡ºï¼ˆå°±åœ°é‹ç®—ï¼‰
    ifftFlag,    // 0 = FFT, 1 = IFFT
    bitReverseFlag
);

// å¯¦æ•¸ FFTï¼ˆReal FFTï¼Œæ›´å¿«ï¼ï¼‰
arm_rfft_fast_instance_f32 S;
arm_rfft_fast_init_f32(&S, fftLen);

arm_rfft_fast_f32(&S, pSrc, pDst, 0);  // æ­£å‘ FFT
arm_rfft_fast_f32(&S, pSrc, pDst, 1);  // åå‘ IFFT

// è¨ˆç®—é »è­œå¤§å°ï¼ˆMagnitudeï¼‰
void arm_cmplx_mag_f32(
    float32_t *pSrc,      // è¤‡æ•¸è¼¸å…¥ [å¯¦, è™›, å¯¦, è™›, ...]
    float32_t *pDst,      // è¼¸å‡º [mag0, mag1, mag2, ...]
    uint32_t numSamples   // è¤‡æ•¸å€‹æ•¸
);
```

### ğŸ“– ç”Ÿæ´»é¡æ¯”ï¼šFFT å°±åƒã€ŒéŸ³æ¨‚çš„æ¨‚è­œåˆ†æã€

```
è½ä¸€é¦–æ­Œçš„å…©ç¨®æ–¹å¼ï¼š

æ–¹å¼ä¸€ï¼šæ™‚åŸŸï¼ˆTime Domainï¼‰
â”œâ”€ è½åˆ°çš„æ˜¯ï¼šéš¨æ™‚é–“è®ŠåŒ–çš„è²æ³¢
â”œâ”€ æè¿°æ–¹å¼ï¼šã€Œç¬¬ 1 ç§’å¾ˆå¤§è²ï¼Œç¬¬ 2 ç§’è®Šå°è²ã€
â””â”€ å°æ‡‰ï¼šåŸå§‹éŸ³è¨Šæ³¢å½¢

æ–¹å¼äºŒï¼šé »åŸŸï¼ˆFrequency Domainï¼‰
â”œâ”€ åˆ†æå‡ºçš„æ˜¯ï¼šå„å€‹éŸ³é«˜çš„å¼·åº¦
â”œâ”€ æè¿°æ–¹å¼ï¼šã€Œæœ‰ 440 Hzï¼ˆLa éŸ³ï¼‰ã€880 Hzï¼ˆé«˜éŸ³ Laï¼‰ã€
â””â”€ å°æ‡‰ï¼šFFT çµæœ

FFT çš„åŠŸèƒ½ = æŠŠã€Œè²æ³¢ã€åˆ†è§£æˆã€Œå„å€‹éŸ³é«˜çš„çµ„åˆã€
```

**å¯¦éš›æ‡‰ç”¨**ï¼š

```
Shazam éŸ³æ¨‚è¾¨è­˜ï¼š
1. éŒ„ä¸‹ 5 ç§’éŸ³è¨Š
2. ç”¨ FFT åˆ†æé »è­œç‰¹å¾µ
3. æ¯”å°è³‡æ–™åº«ä¸­çš„æ­Œæ›²
4. æ‰¾å‡ºåŒ¹é…çš„æ­Œå

æ™ºæ…§å–‡å­ï¼ˆAmazon Echoï¼‰ï¼š
1. éº¥å…‹é¢¨æ”¶éŸ³
2. FFT åˆ†æé »ç‡
3. åµæ¸¬ ã€ŒAlexaã€å–šé†’è©
4. é–‹å§‹èªéŸ³è¾¨è­˜
```

#### 6ï¸âƒ£ MatrixFunctionsï¼ˆçŸ©é™£é‹ç®—ï¼‰- 25 å€‹å‡½æ•¸

çŸ©é™£é‹ç®—åœ¨æ©Ÿå™¨å­¸ç¿’ã€å½±åƒè™•ç†ã€æ§åˆ¶ç†è«–ä¸­éå¸¸é‡è¦ã€‚

```c
// çŸ©é™£çµæ§‹å®šç¾©
typedef struct {
    uint16_t numRows;      // åˆ—æ•¸ï¼ˆrowï¼‰
    uint16_t numCols;      // è¡Œæ•¸ï¼ˆcolumnï¼‰
    float32_t *pData;      // è³‡æ–™æŒ‡æ¨™
} arm_matrix_instance_f32;

// çŸ©é™£ä¹˜æ³•ï¼šC = A Ã— B
arm_status arm_mat_mult_f32(
    const arm_matrix_instance_f32 *pSrcA,  // A çŸ©é™£
    const arm_matrix_instance_f32 *pSrcB,  // B çŸ©é™£
    arm_matrix_instance_f32 *pDst          // C çŸ©é™£
);

// çŸ©é™£è½‰ç½®ï¼šB = Aáµ€
arm_status arm_mat_trans_f32(...);

// çŸ©é™£åçŸ©é™£ï¼šB = Aâ»Â¹
arm_status arm_mat_inverse_f32(...);

// çŸ©é™£åŠ æ³•ï¼šC = A + B
arm_status arm_mat_add_f32(...);

// çŸ©é™£æ¸›æ³•ï¼šC = A - B
arm_status arm_mat_sub_f32(...);
```

**ä½¿ç”¨ç¯„ä¾‹**ï¼š

```c
// å®šç¾©å…©å€‹ 3Ã—3 çŸ©é™£
float32_t dataA[9] = {1, 2, 3, 4, 5, 6, 7, 8, 9};
float32_t dataB[9] = {9, 8, 7, 6, 5, 4, 3, 2, 1};
float32_t dataC[9];

arm_matrix_instance_f32 A, B, C;

// åˆå§‹åŒ–çŸ©é™£
arm_mat_init_f32(&A, 3, 3, dataA);
arm_mat_init_f32(&B, 3, 3, dataB);
arm_mat_init_f32(&C, 3, 3, dataC);

// çŸ©é™£ä¹˜æ³•
arm_status status = arm_mat_mult_f32(&A, &B, &C);

if (status == ARM_MATH_SUCCESS) {
    // æˆåŠŸï¼dataC ç¾åœ¨åŒ…å« A Ã— B çš„çµæœ
}
```

**å¯¦éš›æ‡‰ç”¨**ï¼š

```
æ©Ÿå™¨å­¸ç¿’ï¼ˆé¡ç¥ç¶“ç¶²è·¯ï¼‰ï¼š
â”œâ”€ å‰å‘å‚³æ’­ï¼šY = W Ã— X + bï¼ˆçŸ©é™£ä¹˜æ³•ï¼‰
â”œâ”€ åå‘å‚³æ’­ï¼šâˆ‚L/âˆ‚W = âˆ‚L/âˆ‚Y Ã— Xáµ€ï¼ˆçŸ©é™£è½‰ç½®ï¼‰
â””â”€ æ¬Šé‡æ›´æ–°ï¼šW_new = W - Î± Ã— âˆ‚L/âˆ‚W

å¡çˆ¾æ›¼æ¿¾æ³¢å™¨ï¼ˆKalman Filterï¼‰ï¼š
â”œâ”€ é æ¸¬ï¼šxÌ‚ = A Ã— x + B Ã— u
â”œâ”€ æ›´æ–°ï¼šK = P Ã— Háµ€ Ã— (H Ã— P Ã— Háµ€ + R)â»Â¹ï¼ˆåçŸ©é™£ï¼‰
â””â”€ æ‡‰ç”¨ï¼šGPS å®šä½ã€ç„¡äººæ©Ÿå§¿æ…‹ä¼°è¨ˆ
```

---

## 3. è³‡æ–™å‹åˆ¥ï¼šæµ®é»æ•¸ vs å®šé»æ•¸çš„å¤§æŠ‰æ“‡

### 3.1 å››ç¨®è³‡æ–™å‹åˆ¥

CMSIS-DSP æ”¯æ´å››ç¨®è³‡æ–™å‹åˆ¥ï¼š

```c
// 1. æµ®é»æ•¸ï¼ˆ32-bit IEEE 754ï¼‰
typedef float float32_t;

// 2. å®šé»æ•¸ Q31ï¼ˆ32-bit æ•´æ•¸ï¼‰
typedef int32_t q31_t;    // Q31 æ ¼å¼ï¼š1 ç¬¦è™Ÿä½ + 31 å°æ•¸ä½

// 3. å®šé»æ•¸ Q15ï¼ˆ16-bit æ•´æ•¸ï¼‰
typedef int16_t q15_t;    // Q15 æ ¼å¼ï¼š1 ç¬¦è™Ÿä½ + 15 å°æ•¸ä½

// 4. å®šé»æ•¸ Q7ï¼ˆ8-bit æ•´æ•¸ï¼‰
typedef int8_t q7_t;      // Q7 æ ¼å¼ï¼š1 ç¬¦è™Ÿä½ + 7 å°æ•¸ä½
```

### ğŸ“– ç”Ÿæ´»é¡æ¯”ï¼šä¸åŒç²¾åº¦çš„ã€Œé‡å°ºã€

```
æ¸¬é‡ä¸€å¼µæ¡Œå­çš„é•·åº¦ï¼š

float32_tï¼ˆæµ®é»æ•¸ï¼‰= å°ˆæ¥­é›·å°„æ¸¬è·å„€
â”œâ”€ ç²¾åº¦ï¼š0.001 mm
â”œâ”€ çµæœï¼š1524.387 mm
â”œâ”€ å„ªé»ï¼šè¶…ç´šç²¾æº–
â””â”€ ç¼ºé»ï¼šè²´ã€è€—é›»

q31_tï¼ˆ32-bit å®šé»æ•¸ï¼‰= é«˜å“è³ªæ²å°º
â”œâ”€ ç²¾åº¦ï¼š0.01 mm
â”œâ”€ çµæœï¼š1524.39 mm
â”œâ”€ å„ªé»ï¼šä¾¿å®œã€çœé›»ã€å¤ ç²¾æº–
â””â”€ ç¼ºé»ï¼šç¯„åœå›ºå®š -1.0 ~ 0.999999999

q15_tï¼ˆ16-bit å®šé»æ•¸ï¼‰= ä¸€èˆ¬æ²å°º
â”œâ”€ ç²¾åº¦ï¼š0.1 mm
â”œâ”€ çµæœï¼š1524.4 mm
â”œâ”€ å„ªé»ï¼šéå¸¸çœç©ºé–“
â””â”€ ç¼ºé»ï¼šç²¾åº¦è¼ƒä½

q7_tï¼ˆ8-bit å®šé»æ•¸ï¼‰= ç›®æ¸¬ä¼°è¨ˆ
â”œâ”€ ç²¾åº¦ï¼š1 mm
â”œâ”€ çµæœï¼š1524 mm
â”œâ”€ å„ªé»ï¼šè¶…çœç©ºé–“ï¼ˆ1 byteï¼‰
â””â”€ ç¼ºé»ï¼šç²¾åº¦å¾ˆä½
```

### 3.2 ä»€éº¼æ˜¯å®šé»æ•¸ï¼ˆFixed-Pointï¼‰ï¼Ÿ

å®šé»æ•¸ç”¨ã€Œæ•´æ•¸ã€ä¾†è¡¨ç¤ºã€Œå°æ•¸ã€ï¼Œé€éäº‹å…ˆç´„å®šã€Œå°æ•¸é»çš„ä½ç½®ã€ã€‚

#### Q15 æ ¼å¼è©³è§£

**Q15** è¡¨ç¤ºï¼š**1 å€‹ç¬¦è™Ÿä½ + 15 å€‹å°æ•¸ä½**

```
Q15 æ ¼å¼çš„ä½å…ƒåˆ†é…ï¼š
â”Œâ”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”
â”‚ Sâ”‚ 2â»Â¹â”‚2â»Â²â”‚2â»Â³â”‚2â»â´â”‚2â»âµâ”‚2â»â¶â”‚2â»â·â”‚2â»â¸â”‚2â»â¹â”‚2â»Â¹â°â”‚...â”‚2â»Â¹âµâ”‚
â””â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”˜
 ç¬¦è™Ÿ  å°æ•¸é»åœ¨é€™è£¡ï¼ˆéš±å«çš„ï¼‰
 ä½

å¯¦éš›æ•¸å€¼ = æ•´æ•¸å€¼ / 2Â¹âµ = æ•´æ•¸å€¼ / 32768
```

**Q15 æ•¸å€¼ç¯„ä¾‹**ï¼š

```
åå…­é€²ä½    åé€²ä½     å¯¦éš›æ•¸å€¼              èªªæ˜
0x7FFF  =  32767  Ã· 32768  = 0.999969   æœ€å¤§æ­£æ•¸ï¼ˆâ‰ˆ1.0ï¼‰
0x4000  =  16384  Ã· 32768  = 0.5        æ­£å¥½ä¸€åŠ
0x2000  =   8192  Ã· 32768  = 0.25       å››åˆ†ä¹‹ä¸€
0x1000  =   4096  Ã· 32768  = 0.125      å…«åˆ†ä¹‹ä¸€
0x0001  =      1  Ã· 32768  = 0.0000305  æœ€å°æ­£æ•¸
0x0000  =      0  Ã· 32768  = 0.0        é›¶
0xFFFF  =     -1  Ã· 32768  = -0.0000305 æœ€å°è² æ•¸
0xC000  = -16384  Ã· 32768  = -0.5       è² ä¸€åŠ
0x8000  = -32768  Ã· 32768  = -1.0       æœ€å°æ•¸ï¼ˆ-1.0ï¼‰
```

**Q15 è¡¨ç¤ºç¯„åœ**ï¼š`-1.0 â‰¤ Q15 < 1.0`

### ğŸ“– ç”Ÿæ´»é¡æ¯”ï¼šå®šé»æ•¸å°±åƒã€Œç™¾åˆ†æ¯”ã€

```
è€ƒè©¦åˆ†æ•¸çš„å…©ç¨®è¡¨ç¤ºæ–¹å¼ï¼š

æ–¹å¼ä¸€ï¼šæµ®é»æ•¸
â”œâ”€ å°æ˜è€ƒ 85.37 åˆ†ï¼ˆæ»¿åˆ† 100ï¼‰
â”œâ”€ å„²å­˜æ–¹å¼ï¼šfloat score = 85.37;
â””â”€ éœ€è¦ï¼š4 bytes

æ–¹å¼äºŒï¼šå®šé»æ•¸ï¼ˆQ15 æ ¼å¼ï¼‰
â”œâ”€ å…ˆæ­£è¦åŒ–åˆ° -1.0 ~ 1.0ï¼š85.37 / 100 = 0.8537
â”œâ”€ è½‰æˆæ•´æ•¸ï¼š0.8537 Ã— 32768 = 27975
â”œâ”€ å„²å­˜æ–¹å¼ï¼šq15_t score = 27975;
â””â”€ éœ€è¦ï¼š2 bytesï¼ˆçœä¸€åŠï¼ï¼‰

åå‘è½‰æ›ï¼š
27975 Ã· 32768 = 0.8537 â†’ 0.8537 Ã— 100 = 85.37 åˆ†
```

### 3.3 æµ®é»æ•¸ vs å®šé»æ•¸çš„å®Œæ•´æ¯”è¼ƒ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç‰¹æ€§    â”‚  float32_t â”‚   q31_t    â”‚   q15_t    â”‚   q7_t     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ å¤§å°     â”‚  4 bytes   â”‚  4 bytes   â”‚  2 bytes   â”‚  1 byte    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ç¯„åœ     â”‚ Â±3.4Ã—10Â³â¸  â”‚ -1 ~ 1     â”‚ -1 ~ 1     â”‚ -1 ~ 1     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ç²¾åº¦     â”‚ 7 ä½æœ‰æ•ˆæ•¸å­—â”‚ 9 ä½å°æ•¸   â”‚ 4 ä½å°æ•¸   â”‚ 2 ä½å°æ•¸   â”‚
â”‚          â”‚ (~0.0001%) â”‚ (~0.0001%) â”‚ (~0.003%)  â”‚ (~0.8%)    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ é‹ç®—é€Ÿåº¦ â”‚ æ…¢         â”‚ å¿« 1.5x    â”‚ å¿« 2x      â”‚ å¿« 3x      â”‚
â”‚ (ç›¸å°)   â”‚ (åŸºæº–)     â”‚            â”‚            â”‚            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ è€—é›»é‡   â”‚ é«˜         â”‚ ä¸­         â”‚ ä½         â”‚ è¶…ä½       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ é©ç”¨å ´æ™¯ â”‚ é«˜ç²¾åº¦éœ€æ±‚  â”‚ å¹³è¡¡é¸æ“‡   â”‚ çœé›»è¨­å‚™   â”‚ æ©Ÿå™¨å­¸ç¿’   â”‚
â”‚          â”‚ ç§‘å­¸è¨ˆç®—   â”‚ éŸ³è¨Šè™•ç†   â”‚ ç©¿æˆ´è£ç½®   â”‚ é‡åŒ–ç¶²è·¯   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.4 å¦‚ä½•é¸æ“‡è³‡æ–™å‹åˆ¥ï¼Ÿ

#### æ±ºç­–æ¨¹

```
é–‹å§‹
â”‚
â”œâ”€ éœ€è¦è¡¨ç¤º > 1 çš„æ•¸å€¼ï¼Ÿ
â”‚  â”œâ”€ æ˜¯ â†’ ä½¿ç”¨ float32_tï¼ˆæµ®é»æ•¸ï¼‰
â”‚  â””â”€ å¦ â†’ ç¹¼çºŒ
â”‚
â”œâ”€ éœ€è¦ç²¾åº¦ > 0.01%ï¼Ÿ
â”‚  â”œâ”€ æ˜¯ â†’ ä½¿ç”¨ float32_t æˆ– q31_t
â”‚  â””â”€ å¦ â†’ ç¹¼çºŒ
â”‚
â”œâ”€ è¨˜æ†¶é«”éå¸¸æœ‰é™ï¼ˆ< 2KB RAMï¼‰ï¼Ÿ
â”‚  â”œâ”€ æ˜¯ â†’ ä½¿ç”¨ q15_t æˆ– q7_t
â”‚  â””â”€ å¦ â†’ ä½¿ç”¨ q31_t
â”‚
â”œâ”€ é›»æ± ä¾›é›»ä¸”è¦çœé›»ï¼Ÿ
â”‚  â”œâ”€ æ˜¯ â†’ ä½¿ç”¨ q15_t
â”‚  â””â”€ å¦ â†’ ä½¿ç”¨ float32_tï¼ˆæœ€ç°¡å–®ï¼‰
```

#### å¯¦éš›æ¡ˆä¾‹

```c
// æ¡ˆä¾‹ 1ï¼šæ™ºæ…§æ‰‹ç’°çš„å¿ƒç‡åµæ¸¬
// éœ€æ±‚ï¼šçœé›»ã€è¨˜æ†¶é«”å°
// é¸æ“‡ï¼šq15_t
q15_t heartRateData[128];
arm_fir_q15(&firInstance, heartRateData, output, 128);

// æ¡ˆä¾‹ 2ï¼šé«˜éšéŸ³éŸ¿çš„æ•¸ä½ç­‰åŒ–å™¨
// éœ€æ±‚ï¼šé«˜éŸ³è³ªã€ç²¾åº¦è¦æ±‚é«˜
// é¸æ“‡ï¼šfloat32_t
float32_t audioBuffer[1024];
arm_biquad_cascade_df1_f32(&eqInstance, audioBuffer, output, 1024);

// æ¡ˆä¾‹ 3ï¼šå·¥æ¥­æ§åˆ¶çš„ PID æ§åˆ¶å™¨
// éœ€æ±‚ï¼šå¹³è¡¡ç²¾åº¦èˆ‡é€Ÿåº¦
// é¸æ“‡ï¼šq31_t
q31_t pidInput, pidOutput;
arm_pid_q31(&pidInstance, pidInput);

// æ¡ˆä¾‹ 4ï¼šTinyML ç¥ç¶“ç¶²è·¯ï¼ˆå¾®å‹æ©Ÿå™¨å­¸ç¿’ï¼‰
// éœ€æ±‚ï¼šæ¥µåº¦çœç©ºé–“
// é¸æ“‡ï¼šq7_t
q7_t weights[1000];
q7_t activations[100];
```

### 3.5 è³‡æ–™å‹åˆ¥è½‰æ›

CMSIS-DSP æä¾›è½‰æ›å‡½æ•¸ï¼ˆSupportFunctions åˆ†é¡ï¼‰ï¼š

```c
// float â†’ q31
void arm_float_to_q31(
    float32_t *pSrc,
    q31_t *pDst,
    uint32_t blockSize
);

// q31 â†’ float
void arm_q31_to_float(
    q31_t *pSrc,
    float32_t *pDst,
    uint32_t blockSize
);

// float â†’ q15
void arm_float_to_q15(...);

// q15 â†’ q31ï¼ˆå‘ä¸Šè½‰æ›ï¼‰
void arm_q15_to_q31(...);

// q31 â†’ q15ï¼ˆå‘ä¸‹è½‰æ›ï¼Œæœƒæå¤±ç²¾åº¦ï¼‰
void arm_q31_to_q15(...);
```

**ä½¿ç”¨ç¯„ä¾‹**ï¼š

```c
// æ„Ÿæ¸¬å™¨è®€å–çš„æµ®é»æ•¸è³‡æ–™
float32_t sensorData[100] = {0.523, 0.781, -0.234, ...};

// è½‰æ›æˆ Q15 é€²è¡Œé«˜æ•ˆè™•ç†
q15_t processData[100];
arm_float_to_q15(sensorData, processData, 100);

// ä½¿ç”¨ Q15 ç‰ˆæœ¬çš„ FIR æ¿¾æ³¢ï¼ˆçœé›»ï¼‰
q15_t filtered[100];
arm_fir_q15(&firInstance, processData, filtered, 100);

// è½‰å›æµ®é»æ•¸è¼¸å‡º
float32_t result[100];
arm_q15_to_float(filtered, result, 100);
```

---

## 4. å‡½æ•¸å‘½åè¦å‰‡ï¼šä¸€çœ¼çœ‹æ‡‚ 271 å€‹å‡½æ•¸

### 4.1 å‘½åæ ¼å¼

æ‰€æœ‰ CMSIS-DSP å‡½æ•¸éµå¾ªçµ±ä¸€çš„å‘½åè¦å‰‡ï¼š

```
arm_<function_name>_<data_type>

â”œâ”€ arm_            å‰ç¶´ï¼ˆè¡¨ç¤º ARM å®˜æ–¹ï¼‰
â”œâ”€ <function_name> å‡½æ•¸åŠŸèƒ½
â””â”€ <data_type>     è³‡æ–™å‹åˆ¥ï¼ˆf32/q31/q15/q7ï¼‰
```

### 4.2 ç¯„ä¾‹è§£è®€

```c
arm_fir_f32
â”‚   â”‚   â””â”€ f32ï¼šä½¿ç”¨ float32_tï¼ˆæµ®é»æ•¸ï¼‰
â”‚   â””â”€ firï¼šFIR æ¿¾æ³¢å™¨
â””â”€ armï¼šARM å®˜æ–¹

arm_fir_q15
â”‚   â”‚   â””â”€ q15ï¼šä½¿ç”¨ q15_tï¼ˆ16-bit å®šé»æ•¸ï¼‰
â”‚   â””â”€ firï¼šFIR æ¿¾æ³¢å™¨
â””â”€ armï¼šARM å®˜æ–¹

arm_dot_prod_q31
â”‚   â”‚   â”‚    â””â”€ q31ï¼šä½¿ç”¨ q31_tï¼ˆ32-bit å®šé»æ•¸ï¼‰
â”‚   â”‚   â””â”€ prodï¼šproductï¼ˆä¹˜ç©ï¼‰
â”‚   â””â”€ dotï¼šé»ç©ï¼ˆdot productï¼‰
â””â”€ armï¼šARM å®˜æ–¹

arm_cfft_f32
â”‚   â”‚    â””â”€ f32ï¼šæµ®é»æ•¸
â”‚   â””â”€ cfftï¼šComplex FFTï¼ˆè¤‡æ•¸ FFTï¼‰
â””â”€ armï¼šARM å®˜æ–¹

arm_mat_mult_f32
â”‚   â”‚   â”‚    â””â”€ f32ï¼šæµ®é»æ•¸
â”‚   â”‚   â””â”€ multï¼šä¹˜æ³•ï¼ˆmultiplyï¼‰
â”‚   â””â”€ matï¼šçŸ©é™£ï¼ˆmatrixï¼‰
â””â”€ armï¼šARM å®˜æ–¹
```

### 4.3 å¸¸è¦‹ç¸®å¯«å°ç…§è¡¨

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç¸®å¯«      â”‚  å®Œæ•´åç¨±èˆ‡æ„ç¾©                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ fir        â”‚ Finite Impulse Responseï¼ˆFIR æ¿¾æ³¢å™¨ï¼‰â”‚
â”‚ iir        â”‚ Infinite Impulse Responseï¼ˆIIRï¼‰  â”‚
â”‚ biquad     â”‚ Biquadraticï¼ˆé›™äºŒéšæ¿¾æ³¢å™¨ï¼‰        â”‚
â”‚ lms        â”‚ Least Mean Squareï¼ˆæœ€å°å‡æ–¹ï¼‰      â”‚
â”‚ fft        â”‚ Fast Fourier Transformï¼ˆå¿«é€Ÿå‚…ç«‹è‘‰ï¼‰â”‚
â”‚ cfft       â”‚ Complex FFTï¼ˆè¤‡æ•¸ FFTï¼‰           â”‚
â”‚ rfft       â”‚ Real FFTï¼ˆå¯¦æ•¸ FFTï¼‰              â”‚
â”‚ dct        â”‚ Discrete Cosine Transformï¼ˆDCTï¼‰  â”‚
â”‚ dot        â”‚ Dot Productï¼ˆé»ç©ï¼‰               â”‚
â”‚ mult       â”‚ Multiplyï¼ˆä¹˜æ³•ï¼‰                  â”‚
â”‚ add        â”‚ Addï¼ˆåŠ æ³•ï¼‰                       â”‚
â”‚ sub        â”‚ Subtractï¼ˆæ¸›æ³•ï¼‰                  â”‚
â”‚ scale      â”‚ Scaleï¼ˆç¸®æ”¾ï¼‰                     â”‚
â”‚ offset     â”‚ Offsetï¼ˆåç§»ï¼‰                    â”‚
â”‚ abs        â”‚ Absoluteï¼ˆçµ•å°å€¼ï¼‰                â”‚
â”‚ sqrt       â”‚ Square Rootï¼ˆå¹³æ–¹æ ¹ï¼‰             â”‚
â”‚ sin        â”‚ Sineï¼ˆæ­£å¼¦ï¼‰                      â”‚
â”‚ cos        â”‚ Cosineï¼ˆé¤˜å¼¦ï¼‰                    â”‚
â”‚ mat        â”‚ Matrixï¼ˆçŸ©é™£ï¼‰                    â”‚
â”‚ trans      â”‚ Transposeï¼ˆè½‰ç½®ï¼‰                 â”‚
â”‚ inv        â”‚ Inverseï¼ˆåçŸ©é™£ï¼‰                 â”‚
â”‚ mean       â”‚ Meanï¼ˆå¹³å‡å€¼ï¼‰                    â”‚
â”‚ var        â”‚ Varianceï¼ˆè®Šç•°æ•¸ï¼‰                â”‚
â”‚ std        â”‚ Standard Deviationï¼ˆæ¨™æº–å·®ï¼‰       â”‚
â”‚ rms        â”‚ Root Mean Squareï¼ˆå‡æ–¹æ ¹ï¼‰         â”‚
â”‚ max        â”‚ Maximumï¼ˆæœ€å¤§å€¼ï¼‰                 â”‚
â”‚ min        â”‚ Minimumï¼ˆæœ€å°å€¼ï¼‰                 â”‚
â”‚ cmplx      â”‚ Complexï¼ˆè¤‡æ•¸ï¼‰                   â”‚
â”‚ mag        â”‚ Magnitudeï¼ˆæ¨¡ã€å¤§å°ï¼‰             â”‚
â”‚ conv       â”‚ Convolutionï¼ˆå·ç©ï¼‰               â”‚
â”‚ corr       â”‚ Correlationï¼ˆç›¸é—œï¼‰               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ğŸ“– ç”Ÿæ´»é¡æ¯”ï¼šå‡½æ•¸å‘½åå°±åƒã€Œå•†å“æ¢ç¢¼ã€

```
è¶…å•†å•†å“æ¢ç¢¼ï¼š
4710088889527
â”‚â”‚â”‚â””â”€ ç”¢å“ä»£è™Ÿ
â”‚â”‚â””â”€ å» å•†ä»£è™Ÿ
â”‚â””â”€ åœ‹å®¶ä»£è™Ÿ
â””â”€ æª¢æŸ¥ç¢¼

CMSIS-DSP å‡½æ•¸åç¨±ï¼š
arm_fir_f32
â”‚   â”‚   â””â”€ è³‡æ–™å‹åˆ¥ï¼ˆfloat32ï¼‰
â”‚   â””â”€ åŠŸèƒ½ï¼ˆFIR æ¿¾æ³¢å™¨ï¼‰
â””â”€ å» å•†ï¼ˆARMï¼‰

ä¸€çœ‹åç¨±å°±çŸ¥é“åŠŸèƒ½ï¼
```

---

## 5. æ•ˆèƒ½æœ€ä½³åŒ–æŠ€å·§

### 5.1 å•Ÿç”¨ Cortex-M3 ç‰¹å®šæœ€ä½³åŒ–

åœ¨ `Makefile` çš„ `CFLAGS` ä¸­åŠ å…¥ï¼š

```makefile
CFLAGS += -D ARM_MATH_CM3
```

é€™æœƒå•Ÿç”¨ Cortex-M3 çš„ç‰¹æ®ŠæŒ‡ä»¤ï¼Œè®“ CMSIS-DSP è·‘å¾—æ›´å¿«ï¼

**åŸç†**ï¼š

```
æ²’æœ‰ -D ARM_MATH_CM3ï¼š
â”œâ”€ ä½¿ç”¨é€šç”¨ C èªè¨€ç¨‹å¼ç¢¼
â”œâ”€ åŸ·è¡Œæ™‚é–“ï¼š100%ï¼ˆåŸºæº–ï¼‰
â””â”€ ç›¸å®¹æ€§ï¼šæ‰€æœ‰ ARM è™•ç†å™¨

åŠ å…¥ -D ARM_MATH_CM3ï¼š
â”œâ”€ ä½¿ç”¨ Cortex-M3 çš„ DSP æŒ‡ä»¤
â”‚  â””â”€ SMLALï¼ˆä¹˜æ³•ç´¯åŠ ï¼‰
â”‚  â””â”€ QADDï¼ˆé£½å’ŒåŠ æ³•ï¼‰
â”‚  â””â”€ SMULLï¼ˆ64-bit ä¹˜æ³•ï¼‰
â”œâ”€ åŸ·è¡Œæ™‚é–“ï¼š60%ï¼ˆå¿« 1.67 å€ï¼‰
â””â”€ ç›¸å®¹æ€§ï¼šåƒ… Cortex-M3/M4/M7
```

### 5.2 é¸æ“‡é©ç•¶çš„è³‡æ–™å‹åˆ¥ï¼ˆé‡è¦ï¼ï¼‰

**æ•ˆèƒ½èˆ‡ç²¾åº¦çš„æ¬Šè¡¡**ï¼š

```
åŸ·è¡Œé€Ÿåº¦ï¼ˆCortex-M3 å¯¦æ¸¬ï¼‰ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ è³‡æ–™å‹åˆ¥   â”‚ åŸ·è¡Œæ™‚é–“ â”‚ è¨˜æ†¶é«”   â”‚ ç›¸å°é€Ÿåº¦ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ float32_t  â”‚  100%    â”‚  100%    â”‚  1.0x    â”‚
â”‚ q31_t      â”‚   65%    â”‚  100%    â”‚  1.5x    â”‚
â”‚ q15_t      â”‚   50%    â”‚   50%    â”‚  2.0x    â”‚
â”‚ q7_t       â”‚   33%    â”‚   25%    â”‚  3.0x    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å¯¦éš›æ¸¬è©¦**ï¼ˆ256 é» FIR æ¿¾æ³¢å™¨ï¼‰ï¼š

```c
// æ¸¬è©¦ç’°å¢ƒï¼šLM3S6965, 50 MHz
// è™•ç† 1000 å€‹æ¨£æœ¬

// float32_t ç‰ˆæœ¬
arm_fir_f32(&S, input, output, 1000);
// åŸ·è¡Œæ™‚é–“ï¼š2.4 ms

// q31_t ç‰ˆæœ¬
arm_fir_q31(&S, input, output, 1000);
// åŸ·è¡Œæ™‚é–“ï¼š1.6 msï¼ˆå¿« 50%ï¼‰

// q15_t ç‰ˆæœ¬
arm_fir_q15(&S, input, output, 1000);
// åŸ·è¡Œæ™‚é–“ï¼š1.2 msï¼ˆå¿« 100%ï¼‰
```

### 5.3 ä½¿ç”¨å¿«é€Ÿæ•¸å­¸å‡½æ•¸ï¼ˆFastMathFunctionsï¼‰

å°æ–¼ `sin()`, `cos()`, `sqrt()` ç­‰ï¼ŒCMSIS-DSP æä¾›æŸ¥è©¢è¡¨ç‰ˆæœ¬ï¼š

```c
// æ¨™æº– C å‡½æ•¸ï¼ˆæ…¢ï¼‰
float result = sqrt(x);        // ~50 å€‹æ™‚é˜é€±æœŸ
float result = sin(x);         // ~100 å€‹æ™‚é˜é€±æœŸ

// CMSIS-DSP å¿«é€Ÿç‰ˆæœ¬ï¼ˆå¿«ï¼‰
arm_sqrt_f32(x, &result);      // ~10 å€‹æ™‚é˜é€±æœŸï¼ˆå¿« 5 å€ï¼‰
result = arm_sin_f32(x);       // ~5 å€‹æ™‚é˜é€±æœŸï¼ˆå¿« 20 å€ï¼‰
```

**åŸç†**ï¼šé å…ˆè¨ˆç®—ä¸¦å„²å­˜åœ¨æŸ¥è©¢è¡¨ä¸­

```
arm_sin_f32(x) çš„å¯¦ä½œæ¦‚å¿µï¼š
â”‚
â”œâ”€ æ­¥é©Ÿ 1ï¼šå°‡ x æ­£è¦åŒ–åˆ° 0 ~ 2Ï€
â”œâ”€ æ­¥é©Ÿ 2ï¼šæŸ¥è©¢é å…ˆè¨ˆç®—çš„ 512 å€‹é»
â”œâ”€ æ­¥é©Ÿ 3ï¼šç·šæ€§å…§æ’å¾—åˆ°çµæœ
â”‚
ç¸½æ™‚é˜é€±æœŸï¼š~5ï¼ˆvs æ¨™æº– sin() çš„ 100ï¼‰
ç²¾åº¦èª¤å·®ï¼š< 0.001
```

### 5.4 ä½¿ç”¨å¯¦æ•¸ FFT è€Œéè¤‡æ•¸ FFT

å¦‚æœè¼¸å…¥è¨Šè™Ÿæ˜¯ã€Œå¯¦æ•¸ã€ï¼ˆä¸æ˜¯è¤‡æ•¸ï¼‰ï¼Œä½¿ç”¨ `arm_rfft_fast_f32()` æ¯” `arm_cfft_f32()` å¿« **2 å€**ï¼

```c
// æ–¹æ³•ä¸€ï¼šè¤‡æ•¸ FFTï¼ˆæ…¢ï¼‰
arm_cfft_instance_f32 S_cfft;
arm_cfft_init_f32(&S_cfft, 256);
arm_cfft_f32(&S_cfft, inputData, 0, 1);
// åŸ·è¡Œæ™‚é–“ï¼š1.2 ms

// æ–¹æ³•äºŒï¼šå¯¦æ•¸ FFTï¼ˆå¿«ï¼‰
arm_rfft_fast_instance_f32 S_rfft;
arm_rfft_fast_init_f32(&S_rfft, 256);
arm_rfft_fast_f32(&S_rfft, inputData, outputData, 0);
// åŸ·è¡Œæ™‚é–“ï¼š0.6 msï¼ˆå¿« 2 å€ï¼ï¼‰
```

**ç‚ºä»€éº¼å¿« 2 å€ï¼Ÿ**

```
å¯¦æ•¸è¨Šè™Ÿçš„ FFT ç‰¹æ€§ï¼š
â”‚
â”œâ”€ è¼¸å…¥ï¼šN å€‹å¯¦æ•¸
â”œâ”€ è¼¸å‡ºï¼šN/2 å€‹ç¨ç«‹é »ç‡ï¼ˆå› ç‚ºå°ç¨±æ€§ï¼‰
â”‚  â””â”€ FFT[k] = conj(FFT[N-k])ï¼ˆå…±è»›å°ç¨±ï¼‰
â”‚
â””â”€ è¨ˆç®—é‡ï¼šåªéœ€è™•ç†ä¸€åŠçš„è³‡æ–™ï¼
```

### 5.5 è¨˜æ†¶é«”å°é½Šï¼ˆMemory Alignmentï¼‰

ç¢ºä¿è³‡æ–™é™£åˆ—å°é½Šåˆ° 4 bytes é‚Šç•Œï¼Œå¯ä»¥åŠ é€Ÿè¨˜æ†¶é«”å­˜å–ï¼š

```c
// ä¸å¥½çš„åšæ³•ï¼ˆå¯èƒ½æœªå°é½Šï¼‰
float32_t data[128];

// å¥½çš„åšæ³•ï¼ˆå¼·åˆ¶ 4-byte å°é½Šï¼‰
float32_t data[128] __attribute__((aligned(4)));

// æ›´å¥½çš„åšæ³•ï¼ˆ8-byte å°é½Šï¼Œfor Cortex-M4ï¼‰
float32_t data[128] __attribute__((aligned(8)));
```

**æ•ˆç›Š**ï¼š

```
æœªå°é½Šï¼š
â”œâ”€ è®€å– float32_t éœ€è¦ 2 æ¬¡è¨˜æ†¶é«”å­˜å–
â”œâ”€ åŸ·è¡Œæ™‚é–“ï¼š100%

4-byte å°é½Šï¼š
â”œâ”€ è®€å– float32_t åªéœ€ 1 æ¬¡è¨˜æ†¶é«”å­˜å–
â”œâ”€ åŸ·è¡Œæ™‚é–“ï¼š90%ï¼ˆå¿« 10%ï¼‰
```

### 5.6 æ•ˆèƒ½æœ€ä½³åŒ–ç¸½çµ

```
æœ€ä½³åŒ–æŠ€å·§å„ªå…ˆé †åºï¼š
â”‚
1. â­â­â­ é¸æ“‡é©ç•¶çš„è³‡æ–™å‹åˆ¥ï¼ˆq15 vs float32ï¼‰
   â””â”€ å½±éŸ¿ï¼š2-3 å€é€Ÿåº¦å·®ç•°
â”‚
2. â­â­â­ å•Ÿç”¨ -D ARM_MATH_CM3
   â””â”€ å½±éŸ¿ï¼š1.5-2 å€é€Ÿåº¦æå‡
â”‚
3. â­â­ ä½¿ç”¨ RFFT è€Œé CFFTï¼ˆç•¶è¼¸å…¥æ˜¯å¯¦æ•¸æ™‚ï¼‰
   â””â”€ å½±éŸ¿ï¼š2 å€é€Ÿåº¦æå‡
â”‚
4. â­â­ ä½¿ç”¨å¿«é€Ÿæ•¸å­¸å‡½æ•¸ï¼ˆarm_sin_f32ï¼‰
   â””â”€ å½±éŸ¿ï¼š5-20 å€é€Ÿåº¦æå‡
â”‚
5. â­ è¨˜æ†¶é«”å°é½Š
   â””â”€ å½±éŸ¿ï¼š5-10% é€Ÿåº¦æå‡
```

---

## 6. å®Œæ•´å¯¦ä½œç¯„ä¾‹

### ç¯„ä¾‹ 1ï¼šå‘é‡é‹ç®—ï¼ˆBasicMathFunctionsï¼‰

```c
#include "arm_math.h"
#include <stdio.h>

#define SIZE 10

int main(void)
{
    // å®šç¾©å…©å€‹è¼¸å…¥å‘é‡
    float32_t srcA[SIZE] = {1.0, 2.0, 3.0, 4.0, 5.0,
                            6.0, 7.0, 8.0, 9.0, 10.0};
    float32_t srcB[SIZE] = {0.5, 1.5, 2.5, 3.5, 4.5,
                            5.5, 6.5, 7.5, 8.5, 9.5};

    float32_t sum[SIZE];      // åŠ æ³•çµæœ
    float32_t product[SIZE];  // ä¹˜æ³•çµæœ
    float32_t dotResult;      // é»ç©çµæœ
    float32_t meanResult;     // å¹³å‡å€¼çµæœ

    // 1. å‘é‡åŠ æ³•ï¼šsum[i] = srcA[i] + srcB[i]
    arm_add_f32(srcA, srcB, sum, SIZE);

    // 2. å‘é‡ä¹˜æ³•ï¼šproduct[i] = srcA[i] Ã— srcB[i]
    arm_mult_f32(srcA, srcB, product, SIZE);

    // 3. é»ç©ï¼šdotResult = Î£(srcA[i] Ã— srcB[i])
    arm_dot_prod_f32(srcA, srcB, SIZE, &dotResult);

    // 4. å¹³å‡å€¼ï¼šmeanResult = Î£(srcA[i]) / SIZE
    arm_mean_f32(srcA, SIZE, &meanResult);

    // é¡¯ç¤ºçµæœ
    printf("å‘é‡åŠ æ³•çµæœ: ");
    for (int i = 0; i < SIZE; i++) {
        printf("%.1f ", sum[i]);
    }
    printf("\n");

    printf("é»ç©çµæœ: %.2f\n", dotResult);
    printf("å¹³å‡å€¼çµæœ: %.2f\n", meanResult);

    return 0;
}
```

**åŸ·è¡Œçµæœ**ï¼š

```
å‘é‡åŠ æ³•çµæœ: 1.5 3.5 5.5 7.5 9.5 11.5 13.5 15.5 17.5 19.5
é»ç©çµæœ: 352.50
å¹³å‡å€¼çµæœ: 5.50
```

### ç¯„ä¾‹ 2ï¼šçµ±è¨ˆåˆ†æï¼ˆStatisticsFunctionsï¼‰

```c
#include "arm_math.h"
#include <stdio.h>

#define SAMPLES 20

int main(void)
{
    // æ¨¡æ“¬å¿ƒç‡è³‡æ–™ï¼ˆå–®ä½ï¼šbpmï¼‰
    float32_t heartRate[SAMPLES] = {
        72.3, 74.1, 73.5, 75.2, 76.0,
        74.8, 73.9, 75.5, 74.2, 73.8,
        76.3, 75.1, 74.5, 73.2, 74.9,
        75.8, 74.6, 73.7, 75.3, 74.4
    };

    float32_t mean, variance, std, rms;
    float32_t maxValue, minValue;
    uint32_t maxIndex, minIndex;

    // è¨ˆç®—å¹³å‡å€¼
    arm_mean_f32(heartRate, SAMPLES, &mean);

    // è¨ˆç®—è®Šç•°æ•¸
    arm_var_f32(heartRate, SAMPLES, &variance);

    // è¨ˆç®—æ¨™æº–å·®
    arm_std_f32(heartRate, SAMPLES, &std);

    // è¨ˆç®— RMSï¼ˆå‡æ–¹æ ¹ï¼‰
    arm_rms_f32(heartRate, SAMPLES, &rms);

    // æ‰¾å‡ºæœ€å¤§å€¼èˆ‡ä½ç½®
    arm_max_f32(heartRate, SAMPLES, &maxValue, &maxIndex);

    // æ‰¾å‡ºæœ€å°å€¼èˆ‡ä½ç½®
    arm_min_f32(heartRate, SAMPLES, &minValue, &minIndex);

    // é¡¯ç¤ºçµ±è¨ˆçµæœ
    printf("=== å¿ƒç‡çµ±è¨ˆåˆ†æ ===\n");
    printf("å¹³å‡å¿ƒç‡: %.2f bpm\n", mean);
    printf("æ¨™æº–å·®: %.2f bpm\n", std);
    printf("è®Šç•°æ•¸: %.2f\n", variance);
    printf("RMS: %.2f bpm\n", rms);
    printf("æœ€é«˜å¿ƒç‡: %.2f bpm (ç¬¬ %lu ç­†)\n", maxValue, maxIndex + 1);
    printf("æœ€ä½å¿ƒç‡: %.2f bpm (ç¬¬ %lu ç­†)\n", minValue, minIndex + 1);
    printf("å¿ƒç‡è®Šç•°æ€§ (HRV): %.2f%%\n", (std / mean) * 100);

    // å¥åº·è©•ä¼°
    if (mean < 60) {
        printf("ç‹€æ…‹: å¿ƒè·³éæ…¢ï¼ˆå»ºè­°å°±é†«ï¼‰\n");
    } else if (mean > 100) {
        printf("ç‹€æ…‹: å¿ƒè·³éå¿«ï¼ˆå¯èƒ½é‹å‹•æˆ–ç·Šå¼µï¼‰\n");
    } else {
        printf("ç‹€æ…‹: å¿ƒç‡æ­£å¸¸\n");
    }

    return 0;
}
```

**åŸ·è¡Œçµæœ**ï¼š

```
=== å¿ƒç‡çµ±è¨ˆåˆ†æ ===
å¹³å‡å¿ƒç‡: 74.61 bpm
æ¨™æº–å·®: 0.96 bpm
è®Šç•°æ•¸: 0.93
RMS: 74.62 bpm
æœ€é«˜å¿ƒç‡: 76.30 bpm (ç¬¬ 11 ç­†)
æœ€ä½å¿ƒç‡: 72.30 bpm (ç¬¬ 1 ç­†)
å¿ƒç‡è®Šç•°æ€§ (HRV): 1.29%
ç‹€æ…‹: å¿ƒç‡æ­£å¸¸
```

### ç¯„ä¾‹ 3ï¼šFFT é »è­œåˆ†æï¼ˆTransformFunctionsï¼‰

```c
#include "arm_math.h"
#include <stdio.h>
#include <math.h>

#define FFT_SIZE 256
#define SAMPLE_RATE 1000  // 1 kHz å–æ¨£ç‡

int main(void)
{
    arm_rfft_fast_instance_f32 S;
    arm_status status;

    float32_t inputSignal[FFT_SIZE];
    float32_t fftOutput[FFT_SIZE * 2];  // FFT è¼¸å‡ºï¼ˆè¤‡æ•¸ï¼Œéœ€è¦ 2 å€ç©ºé–“ï¼‰
    float32_t magnitude[FFT_SIZE];      // é »è­œå¤§å°

    float32_t maxValue;
    uint32_t maxIndex;

    // ç”Ÿæˆæ¸¬è©¦è¨Šè™Ÿï¼š100 Hz + 250 Hz çš„æ­£å¼¦æ³¢
    for (int i = 0; i < FFT_SIZE; i++) {
        float t = (float)i / SAMPLE_RATE;  // æ™‚é–“
        inputSignal[i] = sin(2 * PI * 100 * t) +      // 100 Hz æˆåˆ†
                        0.5 * sin(2 * PI * 250 * t);  // 250 Hz æˆåˆ†
    }

    // åˆå§‹åŒ– RFFT
    status = arm_rfft_fast_init_f32(&S, FFT_SIZE);
    if (status != ARM_MATH_SUCCESS) {
        printf("FFT åˆå§‹åŒ–å¤±æ•—ï¼\n");
        return -1;
    }

    // åŸ·è¡Œ FFT
    arm_rfft_fast_f32(&S, inputSignal, fftOutput, 0);

    // è¨ˆç®—é »è­œå¤§å°
    arm_cmplx_mag_f32(fftOutput, magnitude, FFT_SIZE / 2);

    // æ‰¾å‡ºæœ€å¼·çš„é »ç‡æˆåˆ†
    arm_max_f32(magnitude, FFT_SIZE / 2, &maxValue, &maxIndex);

    float dominantFrequency = (float)maxIndex * SAMPLE_RATE / FFT_SIZE;

    // é¡¯ç¤ºçµæœ
    printf("=== FFT é »è­œåˆ†æ ===\n");
    printf("FFT å¤§å°: %d\n", FFT_SIZE);
    printf("å–æ¨£ç‡: %d Hz\n", SAMPLE_RATE);
    printf("é »ç‡è§£æåº¦: %.2f Hz\n", (float)SAMPLE_RATE / FFT_SIZE);
    printf("\nä¸»è¦é »ç‡æˆåˆ†:\n");

    // é¡¯ç¤ºå‰ 10 å€‹æœ€å¼·çš„é »ç‡
    for (int i = 0; i < 10; i++) {
        float freq = (float)i * SAMPLE_RATE / FFT_SIZE;
        printf("  %.2f Hz: %.2f\n", freq, magnitude[i]);
    }

    printf("\næœ€å¼·é »ç‡: %.2f Hz (å¼·åº¦: %.2f)\n", dominantFrequency, maxValue);

    return 0;
}
```

**åŸ·è¡Œçµæœ**ï¼š

```
=== FFT é »è­œåˆ†æ ===
FFT å¤§å°: 256
å–æ¨£ç‡: 1000 Hz
é »ç‡è§£æåº¦: 3.91 Hz

ä¸»è¦é »ç‡æˆåˆ†:
  0.00 Hz: 0.05
  3.91 Hz: 0.12
  7.81 Hz: 0.08
  11.72 Hz: 0.15
  ...
  99.61 Hz: 127.34  â† 100 Hz æˆåˆ†ï¼ˆæœ€å¼·ï¼‰
  ...
  250.00 Hz: 63.67  â† 250 Hz æˆåˆ†

æœ€å¼·é »ç‡: 99.61 Hz (å¼·åº¦: 127.34)
```

### ç¯„ä¾‹ 4ï¼šçŸ©é™£é‹ç®—ï¼ˆMatrixFunctionsï¼‰

```c
#include "arm_math.h"
#include <stdio.h>

int main(void)
{
    // å®šç¾©çŸ©é™£ A (2Ã—3)
    float32_t dataA[6] = {
        1, 2, 3,
        4, 5, 6
    };

    // å®šç¾©çŸ©é™£ B (3Ã—2)
    float32_t dataB[6] = {
        7, 8,
        9, 10,
        11, 12
    };

    // çµæœçŸ©é™£ C (2Ã—2)
    float32_t dataC[4];

    arm_matrix_instance_f32 A, B, C;
    arm_status status;

    // åˆå§‹åŒ–çŸ©é™£
    arm_mat_init_f32(&A, 2, 3, dataA);  // 2 åˆ— Ã— 3 è¡Œ
    arm_mat_init_f32(&B, 3, 2, dataB);  // 3 åˆ— Ã— 2 è¡Œ
    arm_mat_init_f32(&C, 2, 2, dataC);  // 2 åˆ— Ã— 2 è¡Œ

    // çŸ©é™£ä¹˜æ³•ï¼šC = A Ã— B
    status = arm_mat_mult_f32(&A, &B, &C);

    if (status == ARM_MATH_SUCCESS) {
        printf("çŸ©é™£ A (2Ã—3):\n");
        for (int i = 0; i < 2; i++) {
            for (int j = 0; j < 3; j++) {
                printf("%.0f ", dataA[i * 3 + j]);
            }
            printf("\n");
        }

        printf("\nçŸ©é™£ B (3Ã—2):\n");
        for (int i = 0; i < 3; i++) {
            for (int j = 0; j < 2; j++) {
                printf("%.0f ", dataB[i * 2 + j]);
            }
            printf("\n");
        }

        printf("\nçŸ©é™£ C = A Ã— B (2Ã—2):\n");
        for (int i = 0; i < 2; i++) {
            for (int j = 0; j < 2; j++) {
                printf("%.0f ", dataC[i * 2 + j]);
            }
            printf("\n");
        }
    } else {
        printf("çŸ©é™£ä¹˜æ³•å¤±æ•—ï¼ç¶­åº¦ä¸ç¬¦åˆã€‚\n");
    }

    return 0;
}
```

**åŸ·è¡Œçµæœ**ï¼š

```
çŸ©é™£ A (2Ã—3):
1 2 3
4 5 6

çŸ©é™£ B (3Ã—2):
7 8
9 10
11 12

çŸ©é™£ C = A Ã— B (2Ã—2):
58 64
139 154
```

**è¨ˆç®—éç¨‹**ï¼š

```
C[0][0] = 1Ã—7 + 2Ã—9 + 3Ã—11 = 7 + 18 + 33 = 58
C[0][1] = 1Ã—8 + 2Ã—10 + 3Ã—12 = 8 + 20 + 36 = 64
C[1][0] = 4Ã—7 + 5Ã—9 + 6Ã—11 = 28 + 45 + 66 = 139
C[1][1] = 4Ã—8 + 5Ã—10 + 6Ã—12 = 32 + 50 + 72 = 154
```

---

## ğŸ“ å¯¦ä½œç·´ç¿’

### ç·´ç¿’ 1ï¼šæ¢ç´¢å‡½å¼åº«çµæ§‹ â­

**ç›®æ¨™**ï¼šç†Ÿæ‚‰ CMSIS-DSP çš„è³‡æ–™å¤¾çµæ§‹

```bash
cd /home/sbplab/jiawei/qemu/CMSIS_LM3S/CMSIS/DSP_Lib/Source

# åˆ—å‡ºæ‰€æœ‰å‡½æ•¸åˆ†é¡
ls -la

# æ‡‰è©²çœ‹åˆ°ï¼š
# BasicMathFunctions/
# ComplexMathFunctions/
# ControllerFunctions/
# FastMathFunctions/
# FilteringFunctions/
# MatrixFunctions/
# StatisticsFunctions/
# SupportFunctions/
# TransformFunctions/
# CommonTables/

# æŸ¥çœ‹ BasicMathFunctions è£¡æœ‰å“ªäº›æª”æ¡ˆ
ls BasicMathFunctions/

# çµ±è¨ˆç¸½å…±æœ‰å¤šå°‘å€‹ .c æª”æ¡ˆï¼ˆæ‡‰è©²æ˜¯ 271 å€‹ï¼‰
find . -name "*.c" | wc -l
```

**é æœŸè¼¸å‡º**ï¼š

```
271
```

### ç·´ç¿’ 2ï¼šæŸ¥çœ‹æ¨™é ­æª” â­â­

**ç›®æ¨™**ï¼šç†è§£ CMSIS-DSP çš„è³‡æ–™çµæ§‹å®šç¾©

```bash
cd /home/sbplab/jiawei/qemu/CMSIS_LM3S

# æŸ¥çœ‹ FIR æ¿¾æ³¢å™¨çš„çµæ§‹å®šç¾©
grep -n "arm_fir_instance_f32" CMSIS/Include/arm_math.h

# æŸ¥çœ‹æ‰€æœ‰æ”¯æ´çš„è³‡æ–™å‹åˆ¥
grep -n "typedef.*float32_t\|typedef.*q31_t\|typedef.*q15_t\|typedef.*q7_t" CMSIS/Include/arm_math.h

# æŸ¥çœ‹ FFT åˆå§‹åŒ–å‡½æ•¸
grep -n "arm_cfft_init" CMSIS/Include/arm_math.h
```

**å•é¡Œ**ï¼š
1. `arm_fir_instance_f32` çµæ§‹è£¡æœ‰å“ªäº›æˆå“¡è®Šæ•¸ï¼Ÿ
2. `q15_t` çš„å®šç¾©æ˜¯ä»€éº¼ï¼Ÿ
3. FFT æ”¯æ´å“ªäº›é»æ•¸å¤§å°ï¼Ÿ

<details>
<summary>ğŸ’¡ ç­”æ¡ˆ</summary>

```c
// 1. FIR çµæ§‹æˆå“¡
typedef struct {
    uint16_t numTaps;         // æ¿¾æ³¢å™¨éšæ•¸
    float32_t *pState;        // ç‹€æ…‹ç·©è¡å€
    float32_t *pCoeffs;       // ä¿‚æ•¸é™£åˆ—
} arm_fir_instance_f32;

// 2. Q15 å®šç¾©
typedef int16_t q15_t;

// 3. FFT æ”¯æ´é»æ•¸
// 16, 32, 64, 128, 256, 512, 1024, 2048, 4096
```
</details>

### ç·´ç¿’ 3ï¼šæ•ˆèƒ½æ¸¬è©¦ â­â­â­

**ç›®æ¨™**ï¼šæ¯”è¼ƒä¸åŒè³‡æ–™å‹åˆ¥çš„åŸ·è¡Œé€Ÿåº¦

å»ºç«‹æª”æ¡ˆ `benchmark_test.c`ï¼š

```c
#include "arm_math.h"
#include "lm3s6965.h"
#include <stdio.h>

#define SIZE 1000
#define ITERATIONS 100

// å•Ÿç”¨ SysTick è¨ˆæ™‚å™¨
void SysTick_Init(void) {
    SysTick->LOAD = 0xFFFFFF;  // æœ€å¤§å€¼
    SysTick->VAL = 0;
    SysTick->CTRL = 0x5;       // å•Ÿç”¨ï¼Œä½¿ç”¨è™•ç†å™¨æ™‚é˜
}

uint32_t GetTicks(void) {
    return SysTick->VAL;
}

int main(void)
{
    float32_t srcA_f32[SIZE];
    float32_t srcB_f32[SIZE];
    float32_t dst_f32[SIZE];

    q15_t srcA_q15[SIZE];
    q15_t srcB_q15[SIZE];
    q15_t dst_q15[SIZE];

    uint32_t start, end;
    uint32_t time_f32, time_q15;

    // åˆå§‹åŒ–è³‡æ–™
    for (int i = 0; i < SIZE; i++) {
        srcA_f32[i] = 0.5f;
        srcB_f32[i] = 0.3f;
        srcA_q15[i] = 0x4000;  // 0.5 in Q15
        srcB_q15[i] = 0x2666;  // 0.3 in Q15
    }

    SysTick_Init();

    // æ¸¬è©¦ float32_t ç‰ˆæœ¬
    start = GetTicks();
    for (int i = 0; i < ITERATIONS; i++) {
        arm_add_f32(srcA_f32, srcB_f32, dst_f32, SIZE);
    }
    end = GetTicks();
    time_f32 = start - end;

    // æ¸¬è©¦ q15_t ç‰ˆæœ¬
    start = GetTicks();
    for (int i = 0; i < ITERATIONS; i++) {
        arm_add_q15(srcA_q15, srcB_q15, dst_q15, SIZE);
    }
    end = GetTicks();
    time_q15 = start - end;

    printf("=== æ•ˆèƒ½æ¸¬è©¦çµæœ ===\n");
    printf("é™£åˆ—å¤§å°: %d\n", SIZE);
    printf("è¿­ä»£æ¬¡æ•¸: %d\n", ITERATIONS);
    printf("\n");
    printf("float32_t: %lu æ™‚é˜é€±æœŸ\n", time_f32);
    printf("q15_t:     %lu æ™‚é˜é€±æœŸ\n", time_q15);
    printf("åŠ é€Ÿæ¯”:    %.2fx\n", (float)time_f32 / time_q15);

    return 0;
}
```

**ç·¨è­¯èˆ‡åŸ·è¡Œ**ï¼š

```bash
make clean
make benchmark_test
./run-qemu.sh benchmark_test
```

**å•é¡Œ**ï¼š
1. `q15_t` ç‰ˆæœ¬æ¯” `float32_t` å¿«å¤šå°‘ï¼Ÿ
2. ç‚ºä»€éº¼ `q15_t` æ¯”è¼ƒå¿«ï¼Ÿ

### ç·´ç¿’ 4ï¼šå®šé»æ•¸è½‰æ›ç·´ç¿’ â­â­

**ç›®æ¨™**ï¼šç†è§£å®šé»æ•¸çš„é‹ä½œåŸç†

**å•é¡Œ 1**ï¼šå°‡ä»¥ä¸‹æµ®é»æ•¸è½‰æ›æˆ Q15 æ ¼å¼

```
a) 0.5
b) -0.25
c) 0.75
d) -1.0
```

<details>
<summary>ğŸ’¡ ç­”æ¡ˆ</summary>

```
Q15 æ ¼å¼ï¼šæ•´æ•¸å€¼ = æµ®é»æ•¸ Ã— 32768

a) 0.5 Ã— 32768 = 16384 = 0x4000
b) -0.25 Ã— 32768 = -8192 = 0xE000
c) 0.75 Ã— 32768 = 24576 = 0x6000
d) -1.0 Ã— 32768 = -32768 = 0x8000
```
</details>

**å•é¡Œ 2**ï¼šå°‡ä»¥ä¸‹ Q15 å€¼è½‰æ›å›æµ®é»æ•¸

```
a) 0x2000
b) 0xC000
c) 0x1000
d) 0x7FFF
```

<details>
<summary>ğŸ’¡ ç­”æ¡ˆ</summary>

```
æµ®é»æ•¸ = æ•´æ•¸å€¼ / 32768

a) 0x2000 = 8192 â†’ 8192 / 32768 = 0.25
b) 0xC000 = -16384 â†’ -16384 / 32768 = -0.5
c) 0x1000 = 4096 â†’ 4096 / 32768 = 0.125
d) 0x7FFF = 32767 â†’ 32767 / 32768 = 0.999969
```
</details>

### ç·´ç¿’ 5ï¼šFFT éŸ³æ¨‚é »è­œåˆ†æå™¨ â­â­â­â­

**ç›®æ¨™**ï¼šå¯¦ä½œä¸€å€‹ç°¡å–®çš„éŸ³æ¨‚é »è­œåˆ†æå™¨

**ä»»å‹™**ï¼š
1. ç”Ÿæˆä¸€å€‹åŒ…å«å¤šå€‹é »ç‡çš„æ¸¬è©¦è¨Šè™Ÿ
2. ä½¿ç”¨ RFFT é€²è¡Œé »è­œåˆ†æ
3. æ‰¾å‡ºæ‰€æœ‰ä¸»è¦é »ç‡æˆåˆ†
4. é¡¯ç¤ºé »è­œåˆ†å¸ƒåœ–ï¼ˆASCII åœ–ï¼‰

**ç¨‹å¼æ¶æ§‹æç¤º**ï¼š

```c
#include "arm_math.h"
#include <stdio.h>
#include <math.h>

#define FFT_SIZE 512
#define SAMPLE_RATE 8000

int main(void)
{
    // 1. ç”Ÿæˆæ¸¬è©¦è¨Šè™Ÿï¼ˆ440 Hz La éŸ³ + 880 Hz é«˜éŸ³ La + 1320 Hzï¼‰
    float32_t signal[FFT_SIZE];
    // TODO: ç”Ÿæˆè¨Šè™Ÿ

    // 2. åŸ·è¡Œ FFT
    arm_rfft_fast_instance_f32 fft_instance;
    // TODO: åˆå§‹åŒ–èˆ‡åŸ·è¡Œ

    // 3. è¨ˆç®—é »è­œå¤§å°
    float32_t magnitude[FFT_SIZE/2];
    // TODO: è¨ˆç®—

    // 4. æ‰¾å‡ºå³°å€¼é »ç‡
    // TODO: å¯¦ä½œ

    // 5. é¡¯ç¤º ASCII é »è­œåœ–
    // TODO: å¯¦ä½œ

    return 0;
}
```

**é æœŸè¼¸å‡º**ï¼ˆç¤ºæ„ï¼‰ï¼š

```
=== éŸ³æ¨‚é »è­œåˆ†æ ===
ä¸»è¦é »ç‡æˆåˆ†:
  440 Hz (La): â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 100%
  880 Hz (é«˜éŸ³La): â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 60%
  1320 Hz (é«˜éŸ³Mi): â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 40%

ASCII é »è­œåœ–:
0 Hz    |
100 Hz  |
200 Hz  |
300 Hz  |
400 Hz  |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
500 Hz  |
...
```

### ç·´ç¿’ 6ï¼šæ•´åˆå°ˆæ¡ˆ - å¿ƒç‡ç›£æ¸¬ç³»çµ± â­â­â­â­â­

**ç›®æ¨™**ï¼šæ•´åˆå¤šå€‹ CMSIS-DSP å‡½æ•¸å¯¦ä½œå®Œæ•´æ‡‰ç”¨

**éœ€æ±‚**ï¼š
1. è®€å–æ¨¡æ“¬çš„å¿ƒé›»åœ–ï¼ˆECGï¼‰è¨Šè™Ÿ
2. ä½¿ç”¨ FIR æ¿¾æ³¢å™¨å»é™¤é›œè¨Šï¼ˆ50 Hz é›»æºé›œè¨Šï¼‰
3. åµæ¸¬ R æ³¢å³°å€¼ï¼ˆå¿ƒè·³ï¼‰
4. è¨ˆç®—å¿ƒç‡ï¼ˆBPMï¼‰
5. è¨ˆç®—å¿ƒç‡è®Šç•°æ€§ï¼ˆHRVï¼‰

**ç¨‹å¼æ¶æ§‹**ï¼š

```c
#include "arm_math.h"
#include <stdio.h>

#define SAMPLE_RATE 250      // 250 Hz å–æ¨£ç‡
#define BUFFER_SIZE 1000     // 4 ç§’è³‡æ–™
#define FIR_TAPS 64

// FIR ä½é€šæ¿¾æ³¢å™¨ä¿‚æ•¸ï¼ˆæˆªæ­¢é »ç‡ 40 Hzï¼‰
const float32_t firCoeffs[FIR_TAPS] = { /* TODO: è¨­è¨ˆæ¿¾æ³¢å™¨ */ };

int main(void)
{
    // 1. è¼‰å…¥æˆ–ç”Ÿæˆ ECG è¨Šè™Ÿ
    float32_t ecg_raw[BUFFER_SIZE];
    // TODO: è¼‰å…¥è³‡æ–™

    // 2. FIR æ¿¾æ³¢
    float32_t ecg_filtered[BUFFER_SIZE];
    arm_fir_instance_f32 fir;
    // TODO: åˆå§‹åŒ–èˆ‡æ¿¾æ³¢

    // 3. åµæ¸¬å³°å€¼ï¼ˆR æ³¢ï¼‰
    // TODO: ä½¿ç”¨ arm_max_f32 æˆ–è‡ªå®šç¾©æ¼”ç®—æ³•

    // 4. è¨ˆç®—å¿ƒç‡
    // TODO: å¾ R-R é–“éš”è¨ˆç®— BPM

    // 5. è¨ˆç®— HRV
    // TODO: ä½¿ç”¨ arm_std_f32 è¨ˆç®— R-R é–“éš”çš„æ¨™æº–å·®

    // 6. é¡¯ç¤ºçµæœ
    printf("å¿ƒç‡: %d BPM\n", heartRate);
    printf("HRV: %.2f ms\n", hrv);

    return 0;
}
```

---

## ğŸ› å¸¸è¦‹å•é¡Œèˆ‡æ’éŒ¯

### å•é¡Œ 1ï¼šé€£çµéŒ¯èª¤ - undefined reference to `arm_xxx_f32`

**éŒ¯èª¤è¨Šæ¯**ï¼š

```
undefined reference to `arm_fir_f32'
undefined reference to `arm_cfft_init_f32'
```

**åŸå› **ï¼šæ²’æœ‰é€£çµ CMSIS-DSP å‡½å¼åº«

**è§£æ±ºæ–¹æ³•**ï¼š

åœ¨ `Makefile` çš„ `LDFLAGS` åŠ å…¥ï¼š

```makefile
LDFLAGS += -L$(CMSIS_DIR)/DSP_Lib/Source
LDFLAGS += -larm_cortexM3l_math
```

ç¢ºä¿å‡½å¼åº«æœ‰ç·¨è­¯ï¼š

```bash
cd CMSIS/DSP_Lib/Source
make
```

### å•é¡Œ 2ï¼šåŸ·è¡Œçµæœä¸æ­£ç¢º

**ç¾è±¡**ï¼šFFT çµæœå…¨æ˜¯ 0 æˆ–äº‚æ•¸

**å¯èƒ½åŸå›  1**ï¼šå¿˜è¨˜åˆå§‹åŒ–

```c
// âŒ éŒ¯èª¤
arm_cfft_instance_f32 S;
arm_cfft_f32(&S, data, 0, 1);  // S æ²’æœ‰åˆå§‹åŒ–ï¼

// âœ… æ­£ç¢º
arm_cfft_instance_f32 S;
arm_cfft_init_f32(&S, 256);  // å¿…é ˆåˆå§‹åŒ–
arm_cfft_f32(&S, data, 0, 1);
```

**å¯èƒ½åŸå›  2**ï¼šè³‡æ–™æ ¼å¼éŒ¯èª¤

```c
// âŒ éŒ¯èª¤ï¼šè¤‡æ•¸ FFT éœ€è¦ [å¯¦, è™›, å¯¦, è™›, ...] æ ¼å¼
float32_t data[256];  // ä¸å¤ ï¼éœ€è¦ 512 å€‹

// âœ… æ­£ç¢º
float32_t data[512];  // 256 å€‹è¤‡æ•¸ = 512 å€‹ float
// data[0] = real0, data[1] = imag0
// data[2] = real1, data[3] = imag1
// ...
```

### å•é¡Œ 3ï¼šå®šé»æ•¸æº¢ä½

**ç¾è±¡**ï¼šè¨ˆç®—çµæœç•°å¸¸å¤§æˆ–å°

**åŸå› **ï¼šQ15/Q31 ç¯„åœé™åˆ¶åœ¨ -1.0 ~ 1.0

```c
// âŒ éŒ¯èª¤ï¼šè¶…å‡ºç¯„åœ
float32_t temp = 25.5;  // æº«åº¦ 25.5Â°C
q15_t temp_q15;
arm_float_to_q15(&temp, &temp_q15, 1);
// çµæœæœƒæº¢ä½ï¼å› ç‚º 25.5 > 1.0

// âœ… æ­£ç¢ºï¼šå…ˆæ­£è¦åŒ–
float32_t temp_normalized = 25.5 / 100.0;  // 0.255
q15_t temp_q15;
arm_float_to_q15(&temp_normalized, &temp_q15, 1);
// ä½¿ç”¨æ™‚å†è½‰å›ï¼štemp_q15 * 100.0
```

### å•é¡Œ 4ï¼šè¨˜æ†¶é«”ä¸è¶³

**éŒ¯èª¤è¨Šæ¯**ï¼š

```
region `SRAM' overflowed by 2048 bytes
```

**åŸå› **ï¼šFFT æˆ– FIR çš„ç·©è¡å€å¤ªå¤§

**è§£æ±ºæ–¹æ³•**ï¼š

```c
// âŒ éŒ¯èª¤ï¼šLM3S6965 åªæœ‰ 64KB SRAM
float32_t fftBuffer[4096];  // 16 KB
float32_t firState[1024];   // 4 KB
float32_t temp[10000];      // 40 KB
// ç¸½è¨ˆ 60 KB â†’ åŠ ä¸Šå…¶ä»–è®Šæ•¸æœƒè¶…é

// âœ… æ­£ç¢ºï¼šç¸®å°ç·©è¡å€æˆ–ä½¿ç”¨å®šé»æ•¸
float32_t fftBuffer[512];   // 2 KB
q15_t firState[1024];       // 2 KBï¼ˆçœä¸€åŠï¼‰
```

### å•é¡Œ 5ï¼šARM_MATH_SIZE_MISMATCH éŒ¯èª¤

**éŒ¯èª¤**ï¼šçŸ©é™£ä¹˜æ³•å›å‚³ `ARM_MATH_SIZE_MISMATCH`

**åŸå› **ï¼šçŸ©é™£ç¶­åº¦ä¸ç¬¦åˆ

```c
// âŒ éŒ¯èª¤ï¼šA(2Ã—3) Ã— B(2Ã—2) â†’ ç„¡æ³•ç›¸ä¹˜ï¼
arm_matrix_instance_f32 A, B, C;
arm_mat_init_f32(&A, 2, 3, dataA);
arm_mat_init_f32(&B, 2, 2, dataB);  // B çš„åˆ—æ•¸æ‡‰è©²æ˜¯ 3
arm_mat_mult_f32(&A, &B, &C);
// å›å‚³ ARM_MATH_SIZE_MISMATCH

// âœ… æ­£ç¢ºï¼šA(2Ã—3) Ã— B(3Ã—2) = C(2Ã—2)
arm_mat_init_f32(&B, 3, 2, dataB);
```

**çŸ©é™£ä¹˜æ³•è¦å‰‡**ï¼š

```
A(m Ã— n) Ã— B(n Ã— p) = C(m Ã— p)
      â†‘     â†‘
      å¿…é ˆç›¸ç­‰ï¼
```

### å•é¡Œ 6ï¼šQEMU åŸ·è¡Œæ™‚ Hard Fault

**ç¾è±¡**ï¼šç¨‹å¼åŸ·è¡Œåˆ° CMSIS-DSP å‡½æ•¸æ™‚ç•¶æ©Ÿ

**å¯èƒ½åŸå› **ï¼šè¨˜æ†¶é«”æœªå°é½Š

```c
// âŒ éŒ¯èª¤ï¼šå¯èƒ½æœªå°é½Š
float32_t data[128];

// âœ… æ­£ç¢ºï¼šå¼·åˆ¶ 4-byte å°é½Š
float32_t data[128] __attribute__((aligned(4)));
```

---

## ğŸ¯ å­¸ç¿’æª¢æŸ¥é»

å®Œæˆä»¥ä¸‹æª¢æŸ¥é»ï¼Œç¢ºä¿ä½ å·²æŒæ¡ CMSIS-DSPï¼š

- [ ] **ç†è§£ CMSIS æ¨™æº–çš„ç›®çš„**
  - [ ] èƒ½è§£é‡‹ç‚ºä»€éº¼éœ€è¦ CMSIS
  - [ ] çŸ¥é“ CMSIS äº”å¤§çµ„ä»¶çš„åŠŸèƒ½
  - [ ] ç†è§£è·¨å¹³å°ç§»æ¤çš„å„ªå‹¢

- [ ] **æŒæ¡ CMSIS-DSP çš„ 10 å¤§åˆ†é¡**
  - [ ] èƒ½åˆ—å‡º 10 å¤§åˆ†é¡çš„åç¨±
  - [ ] çŸ¥é“æ¯å€‹åˆ†é¡çš„ç”¨é€”
  - [ ] ç†è§£ç‚ºä»€éº¼ FilteringFunctions æœ€å¤š

- [ ] **äº†è§£å››ç¨®è³‡æ–™å‹åˆ¥çš„å·®ç•°**
  - [ ] èƒ½èªªæ˜ float32, q31, q15, q7 çš„å·®ç•°
  - [ ] æœƒè¨ˆç®— Q15 æ ¼å¼çš„æ•¸å€¼è½‰æ›
  - [ ] çŸ¥é“å¦‚ä½•é¸æ“‡é©ç•¶çš„è³‡æ–™å‹åˆ¥

- [ ] **æœƒä½¿ç”¨åŸºæœ¬æ•¸å­¸å‡½æ•¸**
  - [ ] èƒ½ä½¿ç”¨ `arm_add_f32()`, `arm_mult_f32()`
  - [ ] èƒ½ä½¿ç”¨ `arm_dot_prod_f32()`
  - [ ] èƒ½ä½¿ç”¨ `arm_mean_f32()`, `arm_max_f32()`

- [ ] **ç†è§£å‡½æ•¸å‘½åè¦å‰‡**
  - [ ] èƒ½å¾å‡½æ•¸åç¨±åˆ¤æ–·åŠŸèƒ½
  - [ ] çŸ¥é“å¸¸è¦‹ç¸®å¯«çš„æ„ç¾©
  - [ ] èƒ½æ‰¾åˆ°å°æ‡‰çš„å‡½æ•¸æ–‡ä»¶

- [ ] **æŒæ¡æ•ˆèƒ½æœ€ä½³åŒ–æŠ€å·§**
  - [ ] çŸ¥é“å¦‚ä½•å•Ÿç”¨ `-D ARM_MATH_CM3`
  - [ ] ç†è§£é¸æ“‡ RFFT vs CFFT çš„æ™‚æ©Ÿ
  - [ ] æœƒä½¿ç”¨å¿«é€Ÿæ•¸å­¸å‡½æ•¸

---

## ğŸ“š å»¶ä¼¸å­¸ç¿’è³‡æº

### å®˜æ–¹æ–‡ä»¶

1. **CMSIS-DSP ä½¿ç”¨æ‰‹å†Š**
   - è·¯å¾‘ï¼š`CMSIS/Documentation/DSP/html/index.html`
   - å…§å®¹ï¼šå®Œæ•´çš„ API åƒè€ƒæ–‡ä»¶

2. **CMSIS-DSP GitHub**
   - ç¶²å€ï¼šhttps://github.com/ARM-software/CMSIS_5
   - å…§å®¹ï¼šæœ€æ–°åŸå§‹ç¢¼èˆ‡ç¯„ä¾‹

### å¯¦ç”¨å·¥å…·

1. **MATLAB Filter Design Toolbox**
   - ç”¨é€”ï¼šè¨­è¨ˆ FIR/IIR ä¿‚æ•¸
   - æ•™å­¸ï¼šè¦‹æ¨¡çµ„ 7ã€8

2. **Python SciPy**
   ```python
   from scipy import signal
   import numpy as np

   # è¨­è¨ˆ FIR ä½é€šæ¿¾æ³¢å™¨
   b = signal.firwin(64, 0.3)

   # è½‰æ›æˆ C é™£åˆ—æ ¼å¼
   print("const float32_t coeffs[64] = {")
   for i, coef in enumerate(b):
       print(f"    {coef}f,")
   print("};")
   ```

### é€²éšä¸»é¡Œ

1. **CMSIS-NN**ï¼ˆç¥ç¶“ç¶²è·¯ï¼‰
   - ç”¨é€”ï¼šåœ¨ Cortex-M ä¸ŠåŸ·è¡Œ TinyML
   - å‡½æ•¸ï¼šå·ç©ã€æ± åŒ–ã€å…¨é€£æ¥å±¤

2. **CMSIS-RTOS**ï¼ˆå³æ™‚ä½œæ¥­ç³»çµ±ï¼‰
   - ç”¨é€”ï¼šå¤šå·¥è™•ç†
   - æ•´åˆï¼šFreeRTOS + CMSIS-DSP

3. **æ··åˆç²¾åº¦é‹ç®—**
   - æ¦‚å¿µï¼šé—œéµéƒ¨åˆ†ç”¨ float32ï¼Œå…¶ä»–ç”¨ q15
   - æ•ˆç›Šï¼šå…¼é¡§ç²¾åº¦èˆ‡æ•ˆèƒ½

---

## ğŸ”— ä¸‹ä¸€æ­¥

æ­å–œä½ å®Œæˆ CMSIS-DSP å‡½å¼åº«çš„å­¸ç¿’ï¼ç¾åœ¨ä½ å·²ç¶“æŒæ¡äº† 271 å€‹å¼·å¤§çš„ DSP å‡½æ•¸ã€‚

æ¥ä¸‹ä¾†ï¼Œè®“æˆ‘å€‘é€²å…¥æœ€å¾Œä¸€å€‹æ¨¡çµ„ï¼š

â¡ï¸ [æ¨¡çµ„ 13ï¼šå°ˆæ¡ˆå¯¦æˆ°æ¼”ç·´](13-å°ˆæ¡ˆå¯¦æˆ°æ¼”ç·´.md)

åœ¨æ¨¡çµ„ 13 ä¸­ï¼Œæˆ‘å€‘å°‡æ•´åˆå‰é¢æ‰€æœ‰å­¸åˆ°çš„çŸ¥è­˜ï¼ˆDockerã€QEMUã€GDBã€FIRã€IIRã€CMSIS-DSPï¼‰ï¼Œå®Œæˆä¸€å€‹å®Œæ•´çš„åµŒå…¥å¼ DSP å°ˆæ¡ˆï¼

---

**ç‰ˆæœ¬**: 2.0 | **æ—¥æœŸ**: 2025-11-16 | **ä½œè€…**: CMSIS-LM3S æ•™å­¸åœ˜éšŠ
